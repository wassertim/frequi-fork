{"version":3,"file":"MessageBox.vue_vue_type_script_setup_true_lang-44794f57.js","sources":["../../src/components/ftbot/PairSummary.vue","../../src/components/general/MessageBox.vue"],"sourcesContent":["<template>\n  <div>\n    <b-form-group v-if=\"backtestMode\" label-for=\"trade-filter\" class=\"mb-2 me-5\">\n      <b-form-input id=\"trade-filter\" v-model=\"filterText\" type=\"text\" placeholder=\"Filter\" />\n    </b-form-group>\n    <b-list-group>\n      <b-list-group-item\n        v-for=\"comb in combinedPairList\"\n        :key=\"comb.pair\"\n        button\n        class=\"d-flex justify-content-between align-items-center py-1\"\n        :active=\"comb.pair === botStore.activeBot.selectedPair\"\n        :title=\"`${comb.pair} - ${comb.tradeCount} trades`\"\n        @click=\"botStore.activeBot.selectedPair = comb.pair\"\n      >\n        <div>\n          {{ comb.pair }}\n          <span v-if=\"comb.locks\" :title=\"comb.lockReason\"> <i-mdi-lock /> </span>\n        </div>\n\n        <TradeProfit v-if=\"comb.trade && !backtestMode\" :trade=\"comb.trade\" />\n        <ProfitPill\n          v-if=\"backtestMode && comb.tradeCount > 0\"\n          :profit-ratio=\"comb.profit\"\n          :stake-currency=\"botStore.activeBot.stakeCurrency\"\n        />\n      </b-list-group-item>\n    </b-list-group>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { formatPercent, timestampms } from '@/shared/formatters';\nimport { Lock, Trade } from '@/types';\nimport { computed, ref } from 'vue';\nimport { useBotStore } from '@/stores/ftbotwrapper';\n\ninterface CombinedPairList {\n  pair: string;\n  lockReason: string;\n  profitString: string;\n  trade?: Trade;\n  locks?: Lock;\n  profit: number;\n  profitAbs: number;\n  tradeCount: number;\n}\nconst filterText = ref('');\n\nconst props = defineProps({\n  // TOOD: Should be string list\n  pairlist: { required: true, type: Array as () => string[] },\n  currentLocks: { required: false, type: Array as () => Lock[], default: () => [] },\n  trades: { required: true, type: Array as () => Trade[] },\n  sortMethod: { default: 'normal', type: String },\n  backtestMode: { required: false, default: false, type: Boolean },\n});\nconst botStore = useBotStore();\nconst combinedPairList = computed(() => {\n  const comb: CombinedPairList[] = [];\n\n  props.pairlist.forEach((pair) => {\n    const trades: Trade[] = props.trades.filter((el) => el.pair === pair);\n    const allLocks = props.currentLocks.filter((el) => el.pair === pair);\n    let lockReason = '';\n    let locks;\n\n    // Sort to have longer timeframe in front\n    allLocks.sort((a, b) => (a.lock_end_timestamp > b.lock_end_timestamp ? -1 : 1));\n    if (allLocks.length > 0) {\n      [locks] = allLocks;\n      lockReason = `${timestampms(locks.lock_end_timestamp)} - ${locks.reason}`;\n    }\n    let profitString = '';\n    let profit = 0;\n    let profitAbs = 0;\n    trades.forEach((trade) => {\n      profit += trade.profit_ratio;\n      profitAbs += trade.profit_abs ?? 0;\n    });\n    const tradeCount = trades.length;\n    const trade = tradeCount ? trades[0] : undefined;\n    if (trades.length > 0) {\n      profitString = `Current profit: ${formatPercent(profit)}`;\n    }\n    if (trade) {\n      profitString += `\\nOpen since: ${timestampms(trade.open_timestamp)}`;\n    }\n    if (\n      filterText.value === '' ||\n      pair.toLocaleLowerCase().includes(filterText.value.toLocaleLowerCase())\n    ) {\n      comb.push({ pair, trade, locks, lockReason, profitString, profit, profitAbs, tradeCount });\n    }\n  });\n\n  if (props.sortMethod === 'profit') {\n    comb.sort((a, b) => {\n      if (a.profit > b.profit) {\n        return -1;\n      }\n      return 1;\n    });\n  } else {\n    // sort Pairs: \"with open trade\" -> available -> locked\n    comb.sort((a, b) => {\n      if (a.trade && !b.trade) {\n        return -1;\n      }\n      if (a.trade && b.trade) {\n        // 2 open trade pairs\n        return a.trade.trade_id > b.trade.trade_id ? 1 : -1;\n      }\n      if (!a.locks && b.locks) {\n        return -1;\n      }\n      if (a.locks && b.locks) {\n        // Both have locks\n        return a.locks.lock_end_timestamp > b.locks.lock_end_timestamp ? 1 : -1;\n      }\n      return 1;\n    });\n  }\n  return comb;\n});\n</script>\n\n<style scoped>\n.list-group {\n  text-align: left;\n}\n</style>\n","<template>\n  <b-modal\n    ref=\"removeTradeModal\"\n    v-model=\"showRef\"\n    :title=\"title\"\n    @ok=\"msgBoxOK\"\n    @cancel=\"showRef = false\"\n    @keyup.esc=\"showRef = false\"\n    @keyup.enter=\"msgBoxOK\"\n  >\n    {{ message }}\n  </b-modal>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref } from 'vue';\n\nexport interface MsgBoxObject {\n  title: string;\n  message: string;\n  accept: () => void;\n}\nconst showRef = ref<boolean>(false);\nconst title = ref<string>('');\nconst message = ref<string>('');\nconst accept = ref<() => void>(() => {\n  console.warn('Accepted not set.');\n});\n\nconst msgBoxOK = () => {\n  accept.value();\n  showRef.value = false;\n};\n\nconst show = (msg: MsgBoxObject) => {\n  title.value = msg.title;\n  message.value = msg.message;\n  showRef.value = true;\n  accept.value = msg.accept;\n};\n\ndefineExpose({ show });\n</script>\n\n<style scoped></style>\n"],"names":["filterText","ref","props","__props","botStore","useBotStore","combinedPairList","computed","comb","pair","trades","el","allLocks","lockReason","locks","a","timestampms","profitString","profit","profitAbs","trade2","tradeCount","trade","formatPercent","b","showRef","title","message","accept","msgBoxOK","__expose","msg"],"mappings":"87BA+CA,MAAAA,EAAAC,EAAA,EAAA,EAEAC,EAAAC,EAQAC,EAAAC,IACAC,EAAAC,EAAA,IAAA,CACE,MAAAC,EAAA,CAAA,EAEA,OAAAN,EAAA,SAAA,QAAAO,GAAA,CACE,MAAAC,EAAAR,EAAA,OAAA,OAAAS,GAAAA,EAAA,OAAAF,CAAA,EACAG,EAAAV,EAAA,aAAA,OAAAS,GAAAA,EAAA,OAAAF,CAAA,EACA,IAAAI,EAAA,GACAC,EAGAF,EAAA,KAAA,CAAAG,EAAA,IAAAA,EAAA,mBAAA,EAAA,mBAAA,GAAA,CAAA,EACAH,EAAA,OAAA,IACE,CAAAE,CAAA,EAAAF,EACAC,EAAA,GAAAG,EAAAF,EAAA,kBAAA,CAAA,MAAAA,EAAA,MAAA,IAEF,IAAAG,EAAA,GACAC,EAAA,EACAC,EAAA,EACAT,EAAA,QAAAU,GAAA,CACEF,GAAAE,EAAA,aACAD,GAAAC,EAAA,YAAA,CAAiC,CAAA,EAEnC,MAAAC,EAAAX,EAAA,OACAY,EAAAD,EAAAX,EAAA,CAAA,EAAA,OACAA,EAAA,OAAA,IACEO,EAAA,mBAAAM,EAAAL,CAAA,CAAA,IAEFI,IACEL,GAAA;AAAA,cAAgBD,EAAAM,EAAA,cAAA,CAAA,KAElBtB,EAAA,QAAA,IAAAS,EAAA,oBAAA,SAAAT,EAAA,MAAA,kBAAA,CAAA,IAIEQ,EAAA,KAAA,CAAA,KAAAC,EAAA,MAAAa,EAAA,MAAAR,EAAA,WAAAD,EAAA,aAAAI,EAAA,OAAAC,EAAA,UAAAC,EAAA,WAAAE,CAAA,CAAA,CACF,CAAA,EAGFnB,EAAA,aAAA,SACEM,EAAA,KAAA,CAAAO,EAAAS,IACET,EAAA,OAAAS,EAAA,OACE,GAEF,CAAO,EAIThB,EAAA,KAAA,CAAAO,EAAAS,IACET,EAAA,OAAA,CAAAS,EAAA,MACE,GAEFT,EAAA,OAAAS,EAAA,MAEET,EAAA,MAAA,SAAAS,EAAA,MAAA,SAAA,EAAA,GAEF,CAAAT,EAAA,OAAAS,EAAA,MACE,GAEFT,EAAA,OAAAS,EAAA,MAEET,EAAA,MAAA,mBAAAS,EAAA,MAAA,mBAAA,EAAA,GAEF,CAAO,EAGXhB,CAAO,CAAA,6nCCrGT,MAAAiB,EAAAxB,EAAA,EAAA,EACAyB,EAAAzB,EAAA,EAAA,EACA0B,EAAA1B,EAAA,EAAA,EACA2B,EAAA3B,EAAA,IAAA,CACE,QAAA,KAAA,mBAAA,CAAgC,CAAA,EAGlC4B,EAAA,IAAA,CACED,EAAA,MAAA,EACAH,EAAA,MAAA,EAAgB,EAUlB,OAAAK,EAAA,CAAA,KAPAC,GAAA,CACEL,EAAA,MAAAK,EAAA,MACAJ,EAAA,MAAAI,EAAA,QACAN,EAAA,MAAA,GACAG,EAAA,MAAAG,EAAA,MAAmB,CAGrB,CAAA"}