import{a as ce,_ as we}from"./EditValue.vue_vue_type_script_setup_true_lang-RD-Ym4_0.js";import{g as O,bc as $e,o as d,c as w,h as t,x as b,z as k,a as _,v as L,_ as Q,a4 as Se,u as X,r as x,bd as se,be as ie,l as E,U as Y,bf as M,a0 as Be,s as re,bg as de,bh as Z,w as p,H as ee,a5 as me,a3 as H,V as Pe,b as c,S as F,C as A,Q as D,bi as Ee,aH as _e,bj as pe,X as fe,$ as ge,y as K,e as j,B as J,aK as Ue,aL as ze,aS as Ie,q as ve,i as Ne,bk as ue,bl as Me,W as Te,Y as Le,bm as Oe,aj as Fe,F as Re,p as je,d as Ae}from"./index-3gcX5e0n.js";import{_ as be}from"./chevron-down-X00lk4d2.js";import"./plus-box-outline-3BjfLaH1.js";var T=(u=>(u.string="string",u.number="number",u.boolean="boolean",u.option="option",u))(T||{});const De={class:"copy-container position-relative"},He={class:"text-start border p-1 mb-0"},Je=O({__name:"CopyableTextfield",props:{content:{type:[String,Array],required:!0},isValid:{type:Boolean,default:!0}},setup(u){const{copy:n,isSupported:e}=$e();return(a,g)=>{const v=ce;return d(),w("div",De,[t(e)&&u.isValid?(d(),b(v,{key:0,role:"button",class:"copy-button position-absolute end-0 mt-1 me-2",onClick:g[0]||(g[0]=i=>t(n)(typeof u.content=="string"?u.content:JSON.stringify(u.content)))})):k("",!0),_("pre",He,[_("code",null,L(u.content),1)])])}}}),qe=Q(Je,[["__scopeId","data-v-1609c93b"]]),Ge={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},We=_("path",{fill:"currentColor",d:"m17 12l-5 5v-3H8v-4h4V7zM3 19V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2m2 0h14V5H5z"},null,-1),Ke=[We];function Qe(u,n){return d(),w("svg",Ge,[...Ke])}const Xe={name:"mdi-arrow-right-bold-box-outline",render:Qe},q=Se("pairlistConfig",()=>{var oe,ne,ae,le;const u=X(),n=x(!1),e=x(),a=x(((oe=u.activeBot)==null?void 0:oe.stakeCurrency)??"USDT"),g=x([]),v=x(!1),i=x({exchange:((ne=u.activeBot)==null?void 0:ne.botState.exchange)??"",trade_mode:{trading_mode:((ae=u.activeBot)==null?void 0:ae.botState.trading_mode)??se.SPOT,margin_mode:((le=u.activeBot)==null?void 0:le.botState.trading_mode)===se.FUTURES?ie.ISOLATED:ie.NONE}}),s=x(y()),o=x([]),m=x(""),$=E(()=>{var l;return!!((l=s.value.pairlists[0])!=null&&l.is_pairlist_generator)}),C=E(()=>$.value&&s.value.pairlists.length>0),U=E(()=>JSON.stringify(te(),null,2)),z=l=>o.value.findIndex(r=>r.name===l)>-1;function I(l,r){l=structuredClone(M(l)),l.showParameters=!1,l.id||(l.id=Date.now().toString(36)+Math.random().toString(36).substring(2));for(const h in l.params)l.params[h].value=Be(l.params[h].default)?l.params[h].default:"";s.value.pairlists.splice(r,0,l)}function S(l){s.value.pairlists.splice(l,1)}function B(l=""){const r=o.value.findIndex(h=>h.name===s.value.name);s.value.name=l,r>-1?o.value[r]=structuredClone(M(s.value)):o.value.push(structuredClone(M(s.value)))}function P(l){const r=y({name:l});o.value.push(r),s.value=structuredClone(r)}function R(l=""){const r=y({name:l,pairlists:M(s.value.pairlists),blacklist:M(s.value.blacklist)});o.value.push(r),s.value=structuredClone(r)}function V(){const l=o.value.findIndex(r=>r.name===s.value.name);l>-1&&(o.value.splice(l,1),f(o.value.length>0?o.value[0].name:"default"))}function f(l){const r=o.value.find(h=>l===h.name);r?s.value=structuredClone(M(r)):P(l)}function y({name:l="",pairlists:r=[],blacklist:h=[]}={}){return{name:l,pairlists:r,blacklist:h}}function G(){s.value.blacklist.push("")}function xe(l){s.value.blacklist.splice(l,1)}function Ce(l){const r=o.value.find(h=>h.name===l);r&&(s.value.blacklist=structuredClone(M(r.blacklist)))}async function Ve(){const l=ye();n.value=!0;try{const{job_id:r}=await u.activeBot.evaluatePairlist(l);console.log("jobId",r),e.value=setInterval(async()=>{if(!(await u.activeBot.getBackgroundJobStatus(r)).running){clearInterval(e.value);const N=await u.activeBot.getPairlistEvalResult(r);n.value=!1,N.status==="success"?g.value=N.result.whitelist:N.error&&(re(N.error,"danger"),n.value=!1)}},1e3)}catch{re("Evaluation failed","danger"),n.value=!1}}function ke(l,r){return l===T.number?Number(r):l===T.boolean?!!r:String(r)}function ye(){const r={pairlists:te(),stake_currency:a.value,blacklist:s.value.blacklist};return v.value&&(console.log("setting custom exchange props"),r.exchange=i.value.exchange,r.trading_mode=i.value.trade_mode.trading_mode,r.margin_mode=i.value.trade_mode.margin_mode),r}function te(){const l=[];return s.value.pairlists.forEach(r=>{const h={method:r.name};for(const N in r.params){const W=r.params[N];W.value&&(h[N]=ke(W.type,W.value))}l.push(h)}),l}return Y(()=>s.value,()=>{m.value=s.value.name},{deep:!0}),{evaluating:n,whitelist:g,config:s,configJSON:U,savedConfigs:o,configName:m,startPairlistEvaluation:Ve,addToConfig:I,removeFromConfig:S,saveConfig:B,duplicateConfig:R,deleteConfig:V,newConfig:P,selectOrCreateConfig:f,addToBlacklist:G,removeFromBlacklist:xe,duplicateBlacklist:Ce,isSavedConfig:z,firstPairlistIsGenerator:$,pairlistValid:C,stakeCurrency:a,customExchange:v,selectedExchange:i}},{persist:{key:"ftPairlistConfig",paths:["savedConfigs","configName"]}}),Ye=O({__name:"PairlistConfigParameter",props:de({param:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const n=Z(u,"modelValue");return(e,a)=>{const g=ee,v=me,i=H,s=Pe;return d(),b(s,{"label-cols":"4","label-size":"md",class:"pb-1 text-start",description:e.param.help},{label:p(()=>[_("label",null,L(e.param.description),1)]),default:p(()=>[e.param.type===t(T).string||e.param.type===t(T).number?(d(),b(g,{key:0,modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=o=>n.value=o),size:"sm"},null,8,["modelValue"])):k("",!0),e.param.type===t(T).boolean?(d(),b(v,{key:1,modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=o=>n.value=o)},null,8,["modelValue"])):k("",!0),e.param.type===t(T).option?(d(),b(i,{key:2,modelValue:n.value,"onUpdate:modelValue":a[2]||(a[2]=o=>n.value=o),options:e.param.options},null,8,["modelValue","options"])):k("",!0)]),_:1},8,["description"])}}}),Ze={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},et=_("path",{fill:"currentColor",d:"M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6l-6 6z"},null,-1),tt=[et];function ot(u,n){return d(),w("svg",Ze,[...tt])}const he={name:"mdi-chevron-up",render:ot},nt={class:"d-flex text-start align-items-center"},at={class:"d-flex flex-grow-1 align-items-center"},lt={class:"fw-bold"},st={class:"text-small"},it=O({__name:"PairlistConfigItem",props:de({index:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const n=q(),e=Z(u,"modelValue"),a=E(()=>Object.keys(e.value.params).length>0);function g(){a.value&&(e.value.showParameters=!e.value.showParameters)}return(v,i)=>{const s=Ee,o=_e,m=be,$=he,C=Ye,U=pe,z=fe,I=ge;return d(),b(I,{"no-body":"",class:"mb-2"},{header:p(()=>[_("div",nt,[_("div",at,[c(s,{role:"button",class:"handle me-2 fs-4 flex-shrink-0",width:"24",height:"24"}),_("div",{role:"button",class:"d-flex flex-grow-1 align-items-start flex-column user-select-none",onClick:g},[_("span",lt,L(e.value.name),1),_("span",st,L(e.value.description),1)])]),c(o,{role:"button",width:"24",height:"24",class:"mx-2",onClick:i[0]||(i[0]=S=>t(n).removeFromConfig(v.index))}),e.value.showParameters?k("",!0):(d(),b(m,{key:0,class:F([t(a)&&!e.value.showParameters?"visible":"invisible","fs-4"]),role:"button",onClick:g},null,8,["class"])),e.value.showParameters?(d(),b($,{key:1,class:F([t(a)&&e.value.showParameters?"visible":"invisible","fs-4"]),role:"button",onClick:g},null,8,["class"])):k("",!0)])]),default:p(()=>[c(z,{modelValue:e.value.showParameters,"onUpdate:modelValue":i[1]||(i[1]=S=>e.value.showParameters=S)},{default:p(()=>[c(U,null,{default:p(()=>[(d(!0),w(A,null,D(e.value.params,(S,B)=>(d(),b(C,{key:B,modelValue:e.value.params[B].value,"onUpdate:modelValue":P=>e.value.params[B].value=P,param:S},null,8,["modelValue","onUpdate:modelValue","param"]))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),rt=_("span",{class:"fw-bold fd-italic"},"Blacklist",-1),ut={class:"d-flex mb-4 align-items-center gap-2"},ct=_("span",{class:"col-auto"},"Copy from:",-1),dt=O({__name:"PairlistConfigBlacklist",setup(u){const n=q(),e=x(""),a=x(!1),g=E(()=>n.savedConfigs.filter(v=>v.name!==n.config.name).map(v=>v.name));return(v,i)=>{const s=be,o=he,m=H,$=ce,C=J,U=ee,z=_e,I=Ue,S=ze,B=pe,P=fe,R=ge;return d(),b(R,{"no-body":"",class:"mb-2"},{header:p(()=>[_("div",{class:"d-flex flex-row align-items-center justify-content-between",role:"button",onClick:i[0]||(i[0]=V=>a.value=!t(a))},[rt,t(a)?k("",!0):(d(),b(s,{key:0,class:F([t(a)?"invisible":"visible","fs-4"]),role:"button"},null,8,["class"])),t(a)?(d(),b(o,{key:1,class:F([t(a)?"visible":"invisible","fs-4"]),role:"button"},null,8,["class"])):k("",!0)])]),default:p(()=>[c(P,{modelValue:t(a),"onUpdate:modelValue":i[4]||(i[4]=V=>K(a)?a.value=V:null)},{default:p(()=>[c(B,null,{default:p(()=>[_("div",ut,[ct,c(m,{modelValue:t(e),"onUpdate:modelValue":i[1]||(i[1]=V=>K(e)?e.value=V:null),size:"sm",options:t(g)},null,8,["modelValue","options"]),c(C,{title:"Copy",size:"sm",onClick:i[2]||(i[2]=V=>t(n).duplicateBlacklist(t(e)))},{default:p(()=>[c($)]),_:1})]),(d(!0),w(A,null,D(t(n).config.blacklist,(V,f)=>(d(),b(S,{key:f,class:"mb-2",size:"sm"},{default:p(()=>[c(U,{modelValue:t(n).config.blacklist[f],"onUpdate:modelValue":y=>t(n).config.blacklist[f]=y},null,8,["modelValue","onUpdate:modelValue"]),c(I,null,{default:p(()=>[c(C,{size:"sm",onClick:y=>t(n).removeFromBlacklist(f)},{default:p(()=>[c(z)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),c(C,{size:"sm",onClick:i[3]||(i[3]=V=>t(n).addToBlacklist())},{default:p(()=>[j("Add")]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),mt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},_t=_("path",{fill:"currentColor",d:"M15 9H5V5h10m-3 14a3 3 0 0 1-3-3a3 3 0 0 1 3-3a3 3 0 0 1 3 3a3 3 0 0 1-3 3m5-16H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V7z"},null,-1),pt=[_t];function ft(u,n){return d(),w("svg",mt,[...pt])}const gt={name:"mdi-content-save",render:ft},vt={class:"d-flex flex-column flex-sm-row mb-2 gap-2"},bt=O({__name:"PairlistConfigActions",setup(u){const n=q();return(e,a)=>{const g=gt,v=J,i=H,s=Ie;return d(),w("div",vt,[c(v,{title:"Save configuration",size:"sm",variant:"primary",onClick:a[0]||(a[0]=o=>t(n).saveConfig(t(n).config.name))},{default:p(()=>[c(g)]),_:1}),c(we,{modelValue:t(n).config.name,"onUpdate:modelValue":a[3]||(a[3]=o=>t(n).config.name=o),"editable-name":"config","allow-add":!0,"allow-duplicate":!0,"allow-edit":!0,class:"d-flex flex-grow-1",onDelete:t(n).deleteConfig,onDuplicate:a[4]||(a[4]=(o,m)=>t(n).duplicateConfig(m)),onNew:a[5]||(a[5]=o=>t(n).newConfig(o)),onRename:a[6]||(a[6]=(o,m)=>t(n).saveConfig(m))},{default:p(()=>[c(i,{modelValue:t(n).configName,"onUpdate:modelValue":[a[1]||(a[1]=o=>t(n).configName=o),a[2]||(a[2]=o=>t(n).selectOrCreateConfig(o))],size:"sm",options:t(n).savedConfigs.map(o=>o.name)},null,8,["modelValue","options"])]),_:1},8,["modelValue","onDelete"]),c(v,{title:"Evaluate pairlist",disabled:t(n).evaluating||!t(n).pairlistValid,variant:"primary",class:"px-5",size:"sm",onClick:a[7]||(a[7]=o=>t(n).startPairlistEvaluation())},{default:p(()=>[t(n).evaluating?(d(),b(s,{key:0,small:""})):k("",!0),_("span",null,L(t(n).evaluating?"":"Evaluate"),1)]),_:1},8,["disabled"])])}}}),ht={class:"w-100 d-flex"},xt=O({__name:"ExchangeSelect",props:{modelValue:{type:Object,required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(u){const n=Z(u,"modelValue"),e=X(),a=E(()=>{const i=e.activeBot.exchangeList.filter(o=>o.valid&&o.supported).sort((o,m)=>o.name.localeCompare(m.name)),s=e.activeBot.exchangeList.filter(o=>o.valid&&!o.supported).sort((o,m)=>o.name.localeCompare(m.name));return[{label:"Supported",options:i.map(o=>o.name)},{label:"Unsupported",options:s.map(o=>o.name)}]}),g=E(()=>{var s;return((s=e.activeBot.exchangeList.find(o=>o.name===n.value.exchange))==null?void 0:s.trade_modes)??[]}),v=E(()=>g.value.map(i=>({text:`${i.margin_mode} ${i.trading_mode}`,value:i})));return Y(()=>n.value.exchange,()=>{g.value.length<2&&(n.value.trade_mode=g.value[0])}),ve(()=>{e.activeBot.exchangeList.length===0&&e.activeBot.getExchangeList()}),(i,s)=>{const o=H,m=Ne,$=J;return d(),w("div",ht,[c(o,{id:"exchange-select",modelValue:n.value.exchange,"onUpdate:modelValue":s[0]||(s[0]=C=>n.value.exchange=C),size:"sm",options:t(a)},null,8,["modelValue","options"]),c(o,{id:"tradeMode-select",modelValue:n.value.trade_mode,"onUpdate:modelValue":s[1]||(s[1]=C=>n.value.trade_mode=C),size:"sm",options:t(v),disabled:t(v).length<2},null,8,["modelValue","options","disabled"]),c($,{class:"ms-2 no-min-w",size:"sm",onClick:t(e).activeBot.getExchangeList},{default:p(()=>[c(m)]),_:1},8,["onClick"])])}}}),Ct=u=>(je("data-v-6a475659"),u=u(),Ae(),u),Vt={class:"d-flex px-3 mb-3 gap-3 flex-column flex-lg-row"},kt={class:"d-flex flex-grow-1 align-items-start flex-column"},yt={class:"fw-bold"},wt={class:"text-small"},$t={class:"d-flex flex-column flex-fill"},St={class:"border rounded-1 p-2 mb-2"},Bt={class:"d-flex align-items-center gap-2 my-2"},Pt=Ct(()=>_("span",{class:"col-auto"},"Stake currency: ",-1)),Et={class:"mb-2 border rounded-1 p-2 text-start"},Ut={class:"d-flex flex-column col-12 col-lg-3"},zt={class:"position-relative flex-fill overflow-auto"},It=O({__name:"PairlistConfigurator",setup(u){const n=X(),e=q(),a=x([]),g=x(null),v=x(null),i=x("Config"),s=E(()=>e.config.pairlists.length==0);return ue(v,a.value,{group:{name:"configurator",pull:"clone",put:!1},sort:!1,filter:".no-drag",dragClass:"dragging"}),ue(g,e.config.pairlists,{handle:".handle",group:"configurator",onUpdate:async o=>{Me(e.config.pairlists,o.oldIndex,o.newIndex)},onAdd:o=>{const m=a.value[o.oldIndex];e.addToConfig(m,o.newIndex),o.clone.replaceWith(o.item),o.clone.remove()}}),ve(async()=>{a.value=(await n.activeBot.getPairlists()).pairlists.sort((o,m)=>o.is_pairlist_generator===m.is_pairlist_generator?o.name.localeCompare(m.name):o.is_pairlist_generator?-1:1),e.selectOrCreateConfig(e.isSavedConfig(e.configName)?e.configName:"default")}),Y(()=>e.whitelist,()=>{i.value="Results"}),(o,m)=>{const $=Xe,C=J,U=Te,z=Le,I=ee,S=me,B=Oe,P=Fe,R=Re,V=qe;return d(),w("div",Vt,[c(z,{ref_key:"availablePairlistsEl",ref:v,class:"available-pairlists"},{default:p(()=>[(d(!0),w(A,null,D(t(a),f=>(d(),b(U,{key:f.name,class:F([{"no-drag":t(e).config.pairlists.length==0&&!f.is_pairlist_generator},"pairlist d-flex text-start align-items-center py-2 px-3"])},{default:p(()=>[_("div",kt,[_("span",yt,L(f.name),1),_("span",wt,L(f.description),1)]),c(C,{class:"p-0 add-pairlist",style:{border:"none"},variant:"outline-light",disabled:t(e).config.pairlists.length==0&&!f.is_pairlist_generator,onClick:y=>t(e).addToConfig(f,t(e).config.pairlists.length)},{default:p(()=>[c($,{class:"fs-4"})]),_:2},1032,["disabled","onClick"])]),_:2},1032,["class"]))),128))]),_:1},512),_("div",$t,[c(bt),_("div",St,[_("div",Bt,[Pt,c(I,{modelValue:t(e).stakeCurrency,"onUpdate:modelValue":m[0]||(m[0]=f=>t(e).stakeCurrency=f),size:"sm"},null,8,["modelValue"])]),_("div",Et,[c(S,{modelValue:t(e).customExchange,"onUpdate:modelValue":m[1]||(m[1]=f=>t(e).customExchange=f),class:"mb-2"},{default:p(()=>[j(" Custom Exchange ")]),_:1},8,["modelValue"]),t(e).customExchange?(d(),b(xt,{key:0,modelValue:t(e).selectedExchange,"onUpdate:modelValue":m[2]||(m[2]=f=>t(e).selectedExchange=f)},null,8,["modelValue"])):k("",!0)])]),c(dt),c(B,{"model-value":t(e).config.pairlists.length>0&&!t(e).firstPairlistIsGenerator,variant:"warning"},{default:p(()=>[j(" First entry in the pairlist must be a Generating pairlist, like StaticPairList or VolumePairList. ")]),_:1},8,["model-value"]),_("div",{ref_key:"pairlistConfigsEl",ref:g,class:F(["d-flex flex-column flex-grow-1 position-relative border rounded-1 p-1",{empty:t(s)}])},[(d(!0),w(A,null,D(t(e).config.pairlists,(f,y)=>(d(),b(it,{key:f.id,modelValue:t(e).config.pairlists[y],"onUpdate:modelValue":G=>t(e).config.pairlists[y]=G,index:y,onRemove:t(e).removeFromConfig},null,8,["modelValue","onUpdate:modelValue","index","onRemove"]))),128))],2)]),_("div",Ut,[c(R,{modelValue:t(i),"onUpdate:modelValue":m[3]||(m[3]=f=>K(i)?i.value=f:null),class:"mb-2",size:"sm",buttons:""},{default:p(()=>[c(P,{button:"",value:"Config"},{default:p(()=>[j(" Config")]),_:1}),c(P,{button:"",value:"Results",disabled:t(e).whitelist.length===0},{default:p(()=>[j(" Results")]),_:1},8,["disabled"])]),_:1},8,["modelValue"]),_("div",zt,[t(i)==="Config"?(d(),b(V,{key:0,class:"position-lg-absolute w-100",content:t(e).configJSON,"is-valid":t(e).pairlistValid},null,8,["content","is-valid"])):k("",!0),t(i)==="Results"?(d(),b(V,{key:1,class:"position-lg-absolute w-100",content:t(e).whitelist},null,8,["content"])):k("",!0)])])])}}}),Nt=Q(It,[["__scopeId","data-v-6a475659"]]),Mt={};function Tt(u,n){const e=Nt;return d(),b(e,{class:"pt-4"})}const jt=Q(Mt,[["render",Tt]]);export{jt as default};
//# sourceMappingURL=PairlistConfigView-eKZnzDZ5.js.map
