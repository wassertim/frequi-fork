import{q as Ia,s as bo,d as Ue,h as z,i as $,v as yt,F as ie,_ as Be,r as B,o as D,c as L,j,g as E,G as zt,a as M,t as ae,m as it,b as P,w as O,H as _o,f as R,p as Oa,e as ka,I as Co,u as La,z as So,J as xo,K,L as X,M as te,N as Vt,P as $t,Q as je,R as wo,S as $e,U as st,k as Rt,V as Et,W as Ma,E as Ao,X as Te}from"./index.b62e8792.js";import{_ as N,a2 as Ba,B as bt,c as _t,ab as Ne,ac as Na,h as za,W as Va,a4 as Ct,u as w,X as oe,ad as le,ae as ue,I as U,af as $a,ag as Po,b as Ra,ah as To,Y as H,ai as lt,d as Se,aj as Do,ak as Ea,al as Io,G as Q,K as be,am as Ft,an as Oo,ao as ko,x as Lo,z as Mo,L as Bo,M as No,ap as Fa,aq as Oe,ar as Wa,as as Ye,at as zo,p as Re,r as ut,au as Vo,av as St,aw as $o,ax as Ro,ay as de,az as Eo,g as ke,Z as me,aA as ye,aB as Wt,aC as xt,aD as Fo,F as Za,aE as Wo,aF as Zo,aG as Zt,aH as Ut,aI as Ua,aJ as Uo,aK as Go,aL as Ho,aM as jo,aN as Yo,y as Le,aO as wt,aP as qo,aQ as Ko,aR as Gt,m as Xo,C as Ga,aS as Ha,aT as Jo,aU as Qo,aV as en,aW as tn,aX as an,aY as on,aZ as nn,a_ as rn,a$ as sn,b0 as Ht,b1 as ln,b2 as jt,b3 as qe,J as un,b4 as dn,b5 as cn,b6 as hn,b7 as pn,b8 as fn,b9 as gn,ba as vn,bb as mn,a5 as yn,bc as bn,a7 as _n,a8 as Cn,a9 as Sn,aa as xn,a6 as wn}from"./install.99a414d3.js";import{c as An,p as ja,S as Pn,i as Tn,t as Dn,r as In,a as On,D as kn,b as Ln,d as Mn,s as Bn,A as Nn,e as zn,f as Vn,g as $n,h as Rn,j as En,k as Fn}from"./install.75dadd29.js";import{c as Wn}from"./createSeriesDataSimply.94dadb56.js";var Ee=(e=>(e.line="line",e.bar="bar",e.scatter="scatter",e))(Ee||{});const We={main_plot:{},subplots:{}};var Zn=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t.hasSymbolVisual=!0,t}return a.prototype.getInitialData=function(t,o){return An(null,this,{useEncodeDefaulter:!0})},a.prototype.getProgressive=function(){var t=this.option.progressive;return t==null?this.option.large?5e3:this.get("progressive"):t},a.prototype.getProgressiveThreshold=function(){var t=this.option.progressiveThreshold;return t==null?this.option.large?1e4:this.get("progressiveThreshold"):t},a.prototype.brushSelector=function(t,o,n){return n.point(o.getItemLayout(t))},a.prototype.getZLevelKey=function(){return this.getData().count()>this.getProgressiveThreshold()?this.id:""},a.type="series.scatter",a.dependencies=["grid","polar","geo","singleAxis","calendar"],a.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{opacity:.8},emphasis:{scale:!0},clip:!0,select:{itemStyle:{borderColor:"#212121"}},universalTransition:{divideShape:"clone"}},a}(Ba),Un=Zn,Ya=4,Gn=function(){function e(){}return e}(),Hn=function(e){N(a,e);function a(t){var o=e.call(this,t)||this;return o._off=0,o.hoverDataIdx=-1,o}return a.prototype.getDefaultShape=function(){return new Gn},a.prototype.reset=function(){this.notClear=!1,this._off=0},a.prototype.buildPath=function(t,o){var n=o.points,r=o.size,i=this.symbolProxy,s=i.shape,l=t.getContext?t.getContext():t,u=l&&r[0]<Ya,d=this.softClipShape,c;if(u){this._ctx=l;return}for(this._ctx=null,c=this._off;c<n.length;){var h=n[c++],f=n[c++];isNaN(h)||isNaN(f)||d&&!d.contain(h,f)||(s.x=h-r[0]/2,s.y=f-r[1]/2,s.width=r[0],s.height=r[1],i.buildPath(t,s,!0))}this.incremental&&(this._off=c,this.notClear=!0)},a.prototype.afterBrush=function(){var t=this.shape,o=t.points,n=t.size,r=this._ctx,i=this.softClipShape,s;if(!!r){for(s=this._off;s<o.length;){var l=o[s++],u=o[s++];isNaN(l)||isNaN(u)||i&&!i.contain(l,u)||r.fillRect(l-n[0]/2,u-n[1]/2,n[0],n[1])}this.incremental&&(this._off=s,this.notClear=!0)}},a.prototype.findDataIndex=function(t,o){for(var n=this.shape,r=n.points,i=n.size,s=Math.max(i[0],4),l=Math.max(i[1],4),u=r.length/2-1;u>=0;u--){var d=u*2,c=r[d]-s/2,h=r[d+1]-l/2;if(t>=c&&o>=h&&t<=c+s&&o<=h+l)return u}return-1},a.prototype.contain=function(t,o){var n=this.transformCoordToLocal(t,o),r=this.getBoundingRect();if(t=n[0],o=n[1],r.contain(t,o)){var i=this.hoverDataIdx=this.findDataIndex(t,o);return i>=0}return this.hoverDataIdx=-1,!1},a.prototype.getBoundingRect=function(){var t=this._rect;if(!t){for(var o=this.shape,n=o.points,r=o.size,i=r[0],s=r[1],l=1/0,u=1/0,d=-1/0,c=-1/0,h=0;h<n.length;){var f=n[h++],p=n[h++];l=Math.min(f,l),d=Math.max(f,d),u=Math.min(p,u),c=Math.max(p,c)}t=this._rect=new bt(l-i/2,u-s/2,d-l+i,c-u+s)}return t},a}(_t),jn=function(){function e(){this.group=new Ne}return e.prototype.updateData=function(a,t){this._clear();var o=this._create();o.setShape({points:a.getLayout("points")}),this._setCommon(o,a,t)},e.prototype.updateLayout=function(a){var t=a.getLayout("points");this.group.eachChild(function(o){if(o.startIndex!=null){var n=(o.endIndex-o.startIndex)*2,r=o.startIndex*4*2;t=new Float32Array(t.buffer,r,n)}o.setShape("points",t),o.reset()})},e.prototype.incrementalPrepareUpdate=function(a){this._clear()},e.prototype.incrementalUpdate=function(a,t,o){var n=this._newAdded[0],r=t.getLayout("points"),i=n&&n.shape.points;if(i&&i.length<2e4){var s=i.length,l=new Float32Array(s+r.length);l.set(i),l.set(r,s),n.endIndex=a.end,n.setShape({points:l})}else{this._newAdded=[];var u=this._create();u.startIndex=a.start,u.endIndex=a.end,u.incremental=!0,u.setShape({points:r}),this._setCommon(u,t,o)}},e.prototype.eachRendered=function(a){this._newAdded[0]&&a(this._newAdded[0])},e.prototype._create=function(){var a=new Hn({cursor:"default"});return a.ignoreCoarsePointer=!0,this.group.add(a),this._newAdded.push(a),a},e.prototype._setCommon=function(a,t,o){var n=t.hostModel;o=o||{};var r=t.getVisual("symbolSize");a.setShape("size",r instanceof Array?r:[r,r]),a.softClipShape=o.clipShape||null,a.symbolProxy=Na(t.getVisual("symbol"),0,0,0,0),a.setColor=a.symbolProxy.setColor;var i=a.shape.size[0]<Ya;a.useStyle(n.getModel("itemStyle").getItemStyle(i?["color","shadowBlur","shadowColor"]:["color"]));var s=t.getVisual("style"),l=s&&s.fill;l&&a.setColor(l);var u=za(a);u.seriesIndex=n.seriesIndex,a.on("mousemove",function(d){u.dataIndex=null;var c=a.hoverDataIdx;c>=0&&(u.dataIndex=c+(a.startIndex||0))})},e.prototype.remove=function(){this._clear()},e.prototype._clear=function(){this._newAdded=[],this.group.removeAll()},e}(),Yn=jn,qn=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.prototype.render=function(t,o,n){var r=t.getData(),i=this._updateSymbolDraw(r,t);i.updateData(r,{clipShape:this._getClipShape(t)}),this._finished=!0},a.prototype.incrementalPrepareRender=function(t,o,n){var r=t.getData(),i=this._updateSymbolDraw(r,t);i.incrementalPrepareUpdate(r),this._finished=!1},a.prototype.incrementalRender=function(t,o,n){this._symbolDraw.incrementalUpdate(t,o.getData(),{clipShape:this._getClipShape(o)}),this._finished=t.end===o.getData().count()},a.prototype.updateTransform=function(t,o,n){var r=t.getData();if(this.group.dirty(),!this._finished||r.count()>1e4)return{update:!0};var i=ja("").reset(t,o,n);i.progress&&i.progress({start:0,end:r.count(),count:r.count()},r),this._symbolDraw.updateLayout(r)},a.prototype.eachRendered=function(t){this._symbolDraw&&this._symbolDraw.eachRendered(t)},a.prototype._getClipShape=function(t){var o=t.coordinateSystem,n=o&&o.getArea&&o.getArea();return t.get("clip",!0)?n:null},a.prototype._updateSymbolDraw=function(t,o){var n=this._symbolDraw,r=o.pipelineContext,i=r.large;return(!n||i!==this._isLargeDraw)&&(n&&n.remove(),n=this._symbolDraw=i?new Yn:new Pn,this._isLargeDraw=i,this.group.removeAll()),this.group.add(n.group),n},a.prototype.remove=function(t,o){this._symbolDraw&&this._symbolDraw.remove(!0),this._symbolDraw=null},a.prototype.dispose=function(){},a.type="scatter",a}(Va),Kn=qn;function Xn(e){Ct(Tn),e.registerSeriesModel(Un),e.registerChartView(Kn),e.registerLayout(ja("scatter"))}var Jn={axisPointer:1,tooltip:1,brush:1};function Qn(e,a,t){var o=a.getComponentByElement(e.topTarget),n=o&&o.coordinateSystem;return o&&o!==t&&!Jn.hasOwnProperty(o.mainType)&&n&&n.model!==t}var fe=!0,Me=Math.min,_e=Math.max,er=Math.pow,tr=1e4,ar=6,or=6,Yt="globalPan",nr={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},rr={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},qt={brushStyle:{lineWidth:2,stroke:"rgba(210,219,238,0.3)",fill:"#D2DBEE"},transformable:!0,brushMode:"single",removeOnClick:!1},ir=0,sr=function(e){N(a,e);function a(t){var o=e.call(this)||this;return o._track=[],o._covers=[],o._handlers={},o._zr=t,o.group=new Ne,o._uid="brushController_"+ir++,w(fr,function(n,r){this._handlers[r]=oe(n,this)},o),o}return a.prototype.enableBrush=function(t){return this._brushType&&this._doDisableBrush(),t.brushType&&this._doEnableBrush(t),this},a.prototype._doEnableBrush=function(t){var o=this._zr;this._enableGlobalPan||Dn(o,Yt,this._uid),w(this._handlers,function(n,r){o.on(r,n)}),this._brushType=t.brushType,this._brushOption=le(ue(qt),t,!0)},a.prototype._doDisableBrush=function(){var t=this._zr;In(t,Yt,this._uid),w(this._handlers,function(o,n){t.off(n,o)}),this._brushType=this._brushOption=null},a.prototype.setPanels=function(t){if(t&&t.length){var o=this._panels={};w(t,function(n){o[n.panelId]=ue(n)})}else this._panels=null;return this},a.prototype.mount=function(t){t=t||{},this._enableGlobalPan=t.enableGlobalPan;var o=this.group;return this._zr.add(o),o.attr({x:t.x||0,y:t.y||0,rotation:t.rotation||0,scaleX:t.scaleX||1,scaleY:t.scaleY||1}),this._transform=o.getLocalTransform(),this},a.prototype.updateCovers=function(t){t=U(t,function(h){return le(ue(qt),h,!0)});var o="\0-brush-index-",n=this._covers,r=this._covers=[],i=this,s=this._creatingCover;return new $a(n,t,u,l).add(d).update(d).remove(c).execute(),this;function l(h,f){return(h.id!=null?h.id:o+f)+"-"+h.brushType}function u(h,f){return l(h.__brushOption,f)}function d(h,f){var p=t[h];if(f!=null&&n[f]===s)r[h]=n[f];else{var g=r[h]=f!=null?(n[f].__brushOption=p,n[f]):Ka(i,qa(i,p));At(i,g)}}function c(h){n[h]!==s&&i.group.remove(n[h])}},a.prototype.unmount=function(){return this.enableBrush(!1),dt(this),this._zr.remove(this.group),this},a.prototype.dispose=function(){this.unmount(),this.off()},a}(Po);function qa(e,a){var t=Ge[a.brushType].createCover(e,a);return t.__brushOption=a,Ja(t,a),e.group.add(t),t}function Ka(e,a){var t=Pt(a);return t.endCreating&&(t.endCreating(e,a),Ja(a,a.__brushOption)),a}function Xa(e,a){var t=a.__brushOption;Pt(a).updateCoverShape(e,a,t.range,t)}function Ja(e,a){var t=a.z;t==null&&(t=tr),e.traverse(function(o){o.z=t,o.z2=t})}function At(e,a){Pt(a).updateCommon(e,a),Xa(e,a)}function Pt(e){return Ge[e.__brushOption.brushType]}function Tt(e,a,t){var o=e._panels;if(!o)return fe;var n,r=e._transform;return w(o,function(i){i.isTargetByCursor(a,t,r)&&(n=i)}),n}function Qa(e,a){var t=e._panels;if(!t)return fe;var o=a.__brushOption.panelId;return o!=null?t[o]:fe}function dt(e){var a=e._covers,t=a.length;return w(a,function(o){e.group.remove(o)},e),a.length=0,!!t}function ge(e,a){var t=U(e._covers,function(o){var n=o.__brushOption,r=ue(n.range);return{brushType:n.brushType,panelId:n.panelId,range:r}});e.trigger("brush",{areas:t,isEnd:!!a.isEnd,removeOnClick:!!a.removeOnClick})}function lr(e){var a=e._track;if(!a.length)return!1;var t=a[a.length-1],o=a[0],n=t[0]-o[0],r=t[1]-o[1],i=er(n*n+r*r,.5);return i>ar}function eo(e){var a=e.length-1;return a<0&&(a=0),[e[0],e[a]]}function to(e,a,t,o){var n=new Ne;return n.add(new lt({name:"main",style:Dt(t),silent:!0,draggable:!0,cursor:"move",drift:H(Kt,e,a,n,["n","s","w","e"]),ondragend:H(ge,a,{isEnd:!0})})),w(o,function(r){n.add(new lt({name:r.join(""),style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:H(Kt,e,a,n,r),ondragend:H(ge,a,{isEnd:!0})}))}),n}function ao(e,a,t,o){var n=o.brushStyle.lineWidth||0,r=_e(n,or),i=t[0][0],s=t[1][0],l=i-n/2,u=s-n/2,d=t[0][1],c=t[1][1],h=d-r+n/2,f=c-r+n/2,p=d-i,g=c-s,v=p+n,y=g+n;re(e,a,"main",i,s,p,g),o.transformable&&(re(e,a,"w",l,u,r,y),re(e,a,"e",h,u,r,y),re(e,a,"n",l,u,v,r),re(e,a,"s",l,f,v,r),re(e,a,"nw",l,u,r,r),re(e,a,"ne",h,u,r,r),re(e,a,"sw",l,f,r,r),re(e,a,"se",h,f,r,r))}function ct(e,a){var t=a.__brushOption,o=t.transformable,n=a.childAt(0);n.useStyle(Dt(t)),n.attr({silent:!o,cursor:o?"move":"default"}),w([["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]],function(r){var i=a.childOfName(r.join("")),s=r.length===1?ht(e,r[0]):dr(e,r);i&&i.attr({silent:!o,invisible:!o,cursor:o?rr[s]+"-resize":null})})}function re(e,a,t,o,n,r,i){var s=a.childOfName(t);s&&s.setShape(hr(It(e,a,[[o,n],[o+r,n+i]])))}function Dt(e){return Se({strokeNoScale:!0},e.brushStyle)}function oo(e,a,t,o){var n=[Me(e,t),Me(a,o)],r=[_e(e,t),_e(a,o)];return[[n[0],r[0]],[n[1],r[1]]]}function ur(e){return Ea(e.group)}function ht(e,a){var t={w:"left",e:"right",n:"top",s:"bottom"},o={left:"w",right:"e",top:"n",bottom:"s"},n=Do(t[a],ur(e));return o[n]}function dr(e,a){var t=[ht(e,a[0]),ht(e,a[1])];return(t[0]==="e"||t[0]==="w")&&t.reverse(),t.join("")}function Kt(e,a,t,o,n,r){var i=t.__brushOption,s=e.toRectRange(i.range),l=no(a,n,r);w(o,function(u){var d=nr[u];s[d[0]][d[1]]+=l[d[0]]}),i.range=e.fromRectRange(oo(s[0][0],s[1][0],s[0][1],s[1][1])),At(a,t),ge(a,{isEnd:!1})}function cr(e,a,t,o){var n=a.__brushOption.range,r=no(e,t,o);w(n,function(i){i[0]+=r[0],i[1]+=r[1]}),At(e,a),ge(e,{isEnd:!1})}function no(e,a,t){var o=e.group,n=o.transformCoordToLocal(a,t),r=o.transformCoordToLocal(0,0);return[n[0]-r[0],n[1]-r[1]]}function It(e,a,t){var o=Qa(e,a);return o&&o!==fe?o.clipPath(t,e._transform):ue(t)}function hr(e){var a=Me(e[0][0],e[1][0]),t=Me(e[0][1],e[1][1]),o=_e(e[0][0],e[1][0]),n=_e(e[0][1],e[1][1]);return{x:a,y:t,width:o-a,height:n-t}}function pr(e,a,t){if(!(!e._brushType||gr(e,a.offsetX,a.offsetY))){var o=e._zr,n=e._covers,r=Tt(e,a,t);if(!e._dragging)for(var i=0;i<n.length;i++){var s=n[i].__brushOption;if(r&&(r===fe||s.panelId===r.panelId)&&Ge[s.brushType].contain(n[i],t[0],t[1]))return}r&&o.setCursorStyle("crosshair")}}function pt(e){var a=e.event;a.preventDefault&&a.preventDefault()}function ft(e,a,t){return e.childOfName("main").contain(a,t)}function ro(e,a,t,o){var n=e._creatingCover,r=e._creatingPanel,i=e._brushOption,s;if(e._track.push(t.slice()),lr(e)||n){if(r&&!n){i.brushMode==="single"&&dt(e);var l=ue(i);l.brushType=Xt(l.brushType,r),l.panelId=r===fe?null:r.panelId,n=e._creatingCover=qa(e,l),e._covers.push(n)}if(n){var u=Ge[Xt(e._brushType,r)],d=n.__brushOption;d.range=u.getCreatingRange(It(e,n,e._track)),o&&(Ka(e,n),u.updateCommon(e,n)),Xa(e,n),s={isEnd:o}}}else o&&i.brushMode==="single"&&i.removeOnClick&&Tt(e,a,t)&&dt(e)&&(s={isEnd:o,removeOnClick:!0});return s}function Xt(e,a){return e==="auto"?a.defaultBrushType:e}var fr={mousedown:function(e){if(this._dragging)Jt(this,e);else if(!e.target||!e.target.draggable){pt(e);var a=this.group.transformCoordToLocal(e.offsetX,e.offsetY);this._creatingCover=null;var t=this._creatingPanel=Tt(this,e,a);t&&(this._dragging=!0,this._track=[a.slice()])}},mousemove:function(e){var a=e.offsetX,t=e.offsetY,o=this.group.transformCoordToLocal(a,t);if(pr(this,e,o),this._dragging){pt(e);var n=ro(this,e,o,!1);n&&ge(this,n)}},mouseup:function(e){Jt(this,e)}};function Jt(e,a){if(e._dragging){pt(a);var t=a.offsetX,o=a.offsetY,n=e.group.transformCoordToLocal(t,o),r=ro(e,a,n,!0);e._dragging=!1,e._track=[],e._creatingCover=null,r&&ge(e,r)}}function gr(e,a,t){var o=e._zr;return a<0||a>o.getWidth()||t<0||t>o.getHeight()}var Ge={lineX:Qt(0),lineY:Qt(1),rect:{createCover:function(e,a){function t(o){return o}return to({toRectRange:t,fromRectRange:t},e,a,[["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]])},getCreatingRange:function(e){var a=eo(e);return oo(a[1][0],a[1][1],a[0][0],a[0][1])},updateCoverShape:function(e,a,t,o){ao(e,a,t,o)},updateCommon:ct,contain:ft},polygon:{createCover:function(e,a){var t=new Ne;return t.add(new Ra({name:"main",style:Dt(a),silent:!0})),t},getCreatingRange:function(e){return e},endCreating:function(e,a){a.remove(a.childAt(0)),a.add(new To({name:"main",draggable:!0,drift:H(cr,e,a),ondragend:H(ge,e,{isEnd:!0})}))},updateCoverShape:function(e,a,t,o){a.childAt(0).setShape({points:It(e,a,t)})},updateCommon:ct,contain:ft}};function Qt(e){return{createCover:function(a,t){return to({toRectRange:function(o){var n=[o,[0,100]];return e&&n.reverse(),n},fromRectRange:function(o){return o[e]}},a,t,[[["w"],["e"]],[["n"],["s"]]][e])},getCreatingRange:function(a){var t=eo(a),o=Me(t[0][e],t[1][e]),n=_e(t[0][e],t[1][e]);return[o,n]},updateCoverShape:function(a,t,o,n){var r,i=Qa(a,t);if(i!==fe&&i.getLinearBrushOtherExtent)r=i.getLinearBrushOtherExtent(e);else{var s=a._zr;r=[0,[s.getWidth(),s.getHeight()][1-e]]}var l=[o,r];e&&l.reverse(),ao(a,t,l,n)},updateCommon:ct,contain:ft}}var vr=sr;function mr(e){return e=Ot(e),function(a){return Io(a,e)}}function yr(e,a){return e=Ot(e),function(t){var o=a!=null?a:t,n=o?e.width:e.height,r=o?e.x:e.y;return[r,r+(n||0)]}}function br(e,a,t){var o=Ot(e);return function(n,r){return o.contain(r[0],r[1])&&!Qn(n,a,t)}}function Ot(e){return bt.create(e)}var _r=function(){function e(){}return e.prototype.getInitialData=function(a,t){var o,n=t.getComponent("xAxis",this.get("xAxisIndex")),r=t.getComponent("yAxis",this.get("yAxisIndex")),i=n.get("type"),s=r.get("type"),l;i==="category"?(a.layout="horizontal",o=n.getOrdinalMeta(),l=!0):s==="category"?(a.layout="vertical",o=r.getOrdinalMeta(),l=!0):a.layout=a.layout||"horizontal";var u=["x","y"],d=a.layout==="horizontal"?0:1,c=this._baseAxisDim=u[d],h=u[1-d],f=[n,r],p=f[d].get("type"),g=f[1-d].get("type"),v=a.data;if(v&&l){var y=[];w(v,function(m,x){var S;Q(m)?(S=m.slice(),m.unshift(x)):Q(m.value)?(S=be({},m),S.value=S.value.slice(),m.value.unshift(x)):S=m,y.push(S)}),a.data=y}var b=this.defaultValueDimensions,_=[{name:c,type:Ft(p),ordinalMeta:o,otherDims:{tooltip:!1,itemName:0},dimsDef:["base"]},{name:h,type:Ft(g),dimsDef:b.slice()}];return Wn(this,{coordDimensions:_,dimensionsCount:b.length+1,encodeDefaulter:H(Oo,_,this)})},e.prototype.getBaseAxis=function(){var a=this._baseAxisDim;return this.ecModel.getComponent(a+"Axis",this.get(a+"AxisIndex")).axis},e}(),Cr=["color","borderColor"],Sr=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.prototype.render=function(t,o,n){this.group.removeClipPath(),this._progressiveEls=null,this._updateDrawMode(t),this._isLargeDraw?this._renderLarge(t):this._renderNormal(t)},a.prototype.incrementalPrepareRender=function(t,o,n){this._clear(),this._updateDrawMode(t)},a.prototype.incrementalRender=function(t,o,n,r){this._progressiveEls=[],this._isLargeDraw?this._incrementalRenderLarge(t,o):this._incrementalRenderNormal(t,o)},a.prototype.eachRendered=function(t){ko(this._progressiveEls||this.group,t)},a.prototype._updateDrawMode=function(t){var o=t.pipelineContext.large;(this._isLargeDraw==null||o!==this._isLargeDraw)&&(this._isLargeDraw=o,this._clear())},a.prototype._renderNormal=function(t){var o=t.getData(),n=this._data,r=this.group,i=o.getLayout("isSimpleBox"),s=t.get("clip",!0),l=t.coordinateSystem,u=l.getArea&&l.getArea();this._data||r.removeAll(),o.diff(n).add(function(d){if(o.hasValue(d)){var c=o.getItemLayout(d);if(s&&ea(u,c))return;var h=Ke(c,d,!0);Lo(h,{shape:{points:c.ends}},t,d),Xe(h,o,d,i),r.add(h),o.setItemGraphicEl(d,h)}}).update(function(d,c){var h=n.getItemGraphicEl(c);if(!o.hasValue(d)){r.remove(h);return}var f=o.getItemLayout(d);if(s&&ea(u,f)){r.remove(h);return}h?(Mo(h,{shape:{points:f.ends}},t,d),Bo(h)):h=Ke(f),Xe(h,o,d,i),r.add(h),o.setItemGraphicEl(d,h)}).remove(function(d){var c=n.getItemGraphicEl(d);c&&r.remove(c)}).execute(),this._data=o},a.prototype._renderLarge=function(t){this._clear(),aa(t,this.group);var o=t.get("clip",!0)?On(t.coordinateSystem,!1,t):null;o?this.group.setClipPath(o):this.group.removeClipPath()},a.prototype._incrementalRenderNormal=function(t,o){for(var n=o.getData(),r=n.getLayout("isSimpleBox"),i;(i=t.next())!=null;){var s=n.getItemLayout(i),l=Ke(s);Xe(l,n,i,r),l.incremental=!0,this.group.add(l),this._progressiveEls.push(l)}},a.prototype._incrementalRenderLarge=function(t,o){aa(o,this.group,this._progressiveEls,!0)},a.prototype.remove=function(t){this._clear()},a.prototype._clear=function(){this.group.removeAll(),this._data=null},a.type="candlestick",a}(Va),xr=function(){function e(){}return e}(),wr=function(e){N(a,e);function a(t){var o=e.call(this,t)||this;return o.type="normalCandlestickBox",o}return a.prototype.getDefaultShape=function(){return new xr},a.prototype.buildPath=function(t,o){var n=o.points;this.__simpleBox?(t.moveTo(n[4][0],n[4][1]),t.lineTo(n[6][0],n[6][1])):(t.moveTo(n[0][0],n[0][1]),t.lineTo(n[1][0],n[1][1]),t.lineTo(n[2][0],n[2][1]),t.lineTo(n[3][0],n[3][1]),t.closePath(),t.moveTo(n[4][0],n[4][1]),t.lineTo(n[5][0],n[5][1]),t.moveTo(n[6][0],n[6][1]),t.lineTo(n[7][0],n[7][1]))},a}(_t);function Ke(e,a,t){var o=e.ends;return new wr({shape:{points:t?Ar(o,e):o},z2:100})}function ea(e,a){for(var t=!0,o=0;o<a.ends.length;o++)if(e.contain(a.ends[o][0],a.ends[o][1])){t=!1;break}return t}function Xe(e,a,t,o){var n=a.getItemModel(t);e.useStyle(a.getItemVisual(t,"style")),e.style.strokeNoScale=!0,e.__simpleBox=o,No(e,n)}function Ar(e,a){return U(e,function(t){return t=t.slice(),t[1]=a.initBaseline,t})}var Pr=function(){function e(){}return e}(),ta=function(e){N(a,e);function a(t){var o=e.call(this,t)||this;return o.type="largeCandlestickBox",o}return a.prototype.getDefaultShape=function(){return new Pr},a.prototype.buildPath=function(t,o){for(var n=o.points,r=0;r<n.length;)if(this.__sign===n[r++]){var i=n[r++];t.moveTo(i,n[r++]),t.lineTo(i,n[r++])}else r+=3},a}(_t);function aa(e,a,t,o){var n=e.getData(),r=n.getLayout("largePoints"),i=new ta({shape:{points:r},__sign:1,ignoreCoarsePointer:!0});a.add(i);var s=new ta({shape:{points:r},__sign:-1,ignoreCoarsePointer:!0});a.add(s),oa(1,i,e),oa(-1,s,e),o&&(i.incremental=!0,s.incremental=!0),t&&t.push(i,s)}function oa(e,a,t,o){var n=t.get(["itemStyle",e>0?"borderColor":"borderColor0"])||t.get(["itemStyle",e>0?"color":"color0"]),r=t.getModel("itemStyle").getItemStyle(Cr);a.useStyle(r),a.style.fill=null,a.style.stroke=n}var Tr=Sr,io=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t.defaultValueDimensions=[{name:"open",defaultTooltip:!0},{name:"close",defaultTooltip:!0},{name:"lowest",defaultTooltip:!0},{name:"highest",defaultTooltip:!0}],t}return a.prototype.getShadowDim=function(){return"open"},a.prototype.brushSelector=function(t,o,n){var r=o.getItemLayout(t);return r&&n.rect(r.brushRect)},a.type="series.candlestick",a.dependencies=["xAxis","yAxis","grid"],a.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,layout:null,clip:!0,itemStyle:{color:"#eb5454",color0:"#47b262",borderColor:"#eb5454",borderColor0:"#47b262",borderWidth:1},emphasis:{scale:!0,itemStyle:{borderWidth:2}},barMaxWidth:null,barMinWidth:null,barWidth:null,large:!0,largeThreshold:600,progressive:3e3,progressiveThreshold:1e4,progressiveChunkMode:"mod",animationEasing:"linear",animationDuration:300},a}(Ba);Fa(io,_r,!0);var Dr=io;function Ir(e){!e||!Q(e.series)||w(e.series,function(a){Oe(a)&&a.type==="k"&&(a.type="candlestick")})}var Or=["itemStyle","borderColor"],kr=["itemStyle","borderColor0"],Lr=["itemStyle","color"],Mr=["itemStyle","color0"],Br={seriesType:"candlestick",plan:Wa(),performRawSeries:!0,reset:function(e,a){function t(r,i){return i.get(r>0?Lr:Mr)}function o(r,i){return i.get(r>0?Or:kr)}if(!a.isSeriesFiltered(e)){var n=e.pipelineContext.large;return!n&&{progress:function(r,i){for(var s;(s=r.next())!=null;){var l=i.getItemModel(s),u=i.getItemLayout(s).sign,d=l.getItemStyle();d.fill=t(u,l),d.stroke=o(u,l)||d.fill;var c=i.ensureUniqueItemVisual(s,"style");be(c,d)}}}}}},Nr=Br,zr={seriesType:"candlestick",plan:Wa(),reset:function(e){var a=e.coordinateSystem,t=e.getData(),o=Vr(e,t),n=0,r=1,i=["x","y"],s=t.getDimensionIndex(t.mapDimension(i[n])),l=U(t.mapDimensionsAll(i[r]),t.getDimensionIndex,t),u=l[0],d=l[1],c=l[2],h=l[3];if(t.setLayout({candleWidth:o,isSimpleBox:o<=1.3}),s<0||l.length<4)return;return{progress:e.pipelineContext.large?p:f};function f(g,v){for(var y,b=v.getStore();(y=g.next())!=null;){var _=b.get(s,y),m=b.get(u,y),x=b.get(d,y),S=b.get(c,y),I=b.get(h,y),k=Math.min(m,x),A=Math.max(m,x),T=ne(k,_),V=ne(A,_),G=ne(S,_),Y=ne(I,_),se=[];ze(se,V,0),ze(se,T,1),se.push(ce(Y),ce(V),ce(G),ce(T)),v.setItemLayout(y,{sign:na(b,y,m,x,d),initBaseline:m>x?V[r]:T[r],ends:se,brushRect:Ve(S,I,_)})}function ne(W,ee){var C=[];return C[n]=ee,C[r]=W,isNaN(ee)||isNaN(W)?[NaN,NaN]:a.dataToPoint(C)}function ze(W,ee,C){var F=ee.slice(),Z=ee.slice();F[n]=Ye(F[n]+o/2,1,!1),Z[n]=Ye(Z[n]-o/2,1,!0),C?W.push(F,Z):W.push(Z,F)}function Ve(W,ee,C){var F=ne(W,C),Z=ne(ee,C);return F[n]-=o/2,Z[n]-=o/2,{x:F[0],y:F[1],width:o,height:Z[1]-F[1]}}function ce(W){return W[n]=Ye(W[n],1),W}}function p(g,v){for(var y=zo(g.count*4),b=0,_,m=[],x=[],S,I=v.getStore();(S=g.next())!=null;){var k=I.get(s,S),A=I.get(u,S),T=I.get(d,S),V=I.get(c,S),G=I.get(h,S);if(isNaN(k)||isNaN(V)||isNaN(G)){y[b++]=NaN,b+=3;continue}y[b++]=na(I,S,A,T,d),m[n]=k,m[r]=V,_=a.dataToPoint(m,null,x),y[b++]=_?_[0]:NaN,y[b++]=_?_[1]:NaN,m[r]=G,_=a.dataToPoint(m,null,x),y[b++]=_?_[1]:NaN}v.setLayout("largePoints",y)}}};function na(e,a,t,o,n){var r;return t>o?r=-1:t<o?r=1:r=a>0?e.get(n,a-1)<=o?1:-1:1,r}function Vr(e,a){var t=e.getBaseAxis(),o,n=t.type==="category"?t.getBandWidth():(o=t.getExtent(),Math.abs(o[1]-o[0])/a.count()),r=Re(ut(e.get("barMaxWidth"),n),n),i=Re(ut(e.get("barMinWidth"),1),n),s=e.get("barWidth");return s!=null?Re(s,n):Math.max(Math.min(n/2,r),i)}var $r=zr;function Rr(e){e.registerChartView(Tr),e.registerSeriesModel(Dr),e.registerPreprocessor(Ir),e.registerVisual(Nr),e.registerLayout($r)}var Er=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.prototype.init=function(t,o,n){var r=Vo(t);e.prototype.init.apply(this,arguments),ra(t,r)},a.prototype.mergeOption=function(t){e.prototype.mergeOption.apply(this,arguments),ra(this.option,t)},a.prototype.getCellSize=function(){return this.option.cellSize},a.type="calendar",a.defaultOption={z:2,left:80,top:60,cellSize:20,orient:"horizontal",splitLine:{show:!0,lineStyle:{color:"#000",width:1,type:"solid"}},itemStyle:{color:"#fff",borderWidth:1,borderColor:"#ccc"},dayLabel:{show:!0,firstDay:0,position:"start",margin:"50%",color:"#000"},monthLabel:{show:!0,position:"start",margin:5,align:"center",formatter:null,color:"#000"},yearLabel:{show:!0,position:null,margin:30,formatter:null,color:"#ccc",fontFamily:"sans-serif",fontWeight:"bolder",fontSize:20}},a}(St);function ra(e,a){var t=e.cellSize,o;Q(t)?o=t:o=e.cellSize=[t,t],o.length===1&&(o[1]=o[0]);var n=U([0,1],function(r){return $o(a,r)&&(o[r]="auto"),o[r]!=null&&o[r]!=="auto"});Ro(e,a,{type:"box",ignoreSize:n})}var Fr=Er,Wr=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.prototype.render=function(t,o,n){var r=this.group;r.removeAll();var i=t.coordinateSystem,s=i.getRangeInfo(),l=i.getOrient(),u=o.getLocaleModel();this._renderDayRect(t,s,r),this._renderLines(t,s,l,r),this._renderYearText(t,s,l,r),this._renderMonthText(t,u,l,r),this._renderWeekText(t,u,s,l,r)},a.prototype._renderDayRect=function(t,o,n){for(var r=t.coordinateSystem,i=t.getModel("itemStyle").getItemStyle(),s=r.getCellWidth(),l=r.getCellHeight(),u=o.start.time;u<=o.end.time;u=r.getNextNDay(u,1).time){var d=r.dataToRect([u],!1).tl,c=new lt({shape:{x:d[0],y:d[1],width:s,height:l},cursor:"default",style:i});n.add(c)}},a.prototype._renderLines=function(t,o,n,r){var i=this,s=t.coordinateSystem,l=t.getModel(["splitLine","lineStyle"]).getLineStyle(),u=t.get(["splitLine","show"]),d=l.lineWidth;this._tlpoints=[],this._blpoints=[],this._firstDayOfMonth=[],this._firstDayPoints=[];for(var c=o.start,h=0;c.time<=o.end.time;h++){p(c.formatedDate),h===0&&(c=s.getDateInfo(o.start.y+"-"+o.start.m));var f=c.date;f.setMonth(f.getMonth()+1),c=s.getDateInfo(f)}p(s.getNextNDay(o.end.time,1).formatedDate);function p(g){i._firstDayOfMonth.push(s.getDateInfo(g)),i._firstDayPoints.push(s.dataToRect([g],!1).tl);var v=i._getLinePointsOfOneWeek(t,g,n);i._tlpoints.push(v[0]),i._blpoints.push(v[v.length-1]),u&&i._drawSplitline(v,l,r)}u&&this._drawSplitline(i._getEdgesPoints(i._tlpoints,d,n),l,r),u&&this._drawSplitline(i._getEdgesPoints(i._blpoints,d,n),l,r)},a.prototype._getEdgesPoints=function(t,o,n){var r=[t[0].slice(),t[t.length-1].slice()],i=n==="horizontal"?0:1;return r[0][i]=r[0][i]-o/2,r[1][i]=r[1][i]+o/2,r},a.prototype._drawSplitline=function(t,o,n){var r=new Ra({z2:20,shape:{points:t},style:o});n.add(r)},a.prototype._getLinePointsOfOneWeek=function(t,o,n){for(var r=t.coordinateSystem,i=r.getDateInfo(o),s=[],l=0;l<7;l++){var u=r.getNextNDay(i.time,l),d=r.dataToRect([u.time],!1);s[2*u.day]=d.tl,s[2*u.day+1]=d[n==="horizontal"?"bl":"tr"]}return s},a.prototype._formatterLabel=function(t,o){return de(t)&&t?Eo(t,o):ke(t)?t(o):o.nameMap},a.prototype._yearTextPositionControl=function(t,o,n,r,i){var s=o[0],l=o[1],u=["center","bottom"];r==="bottom"?(l+=i,u=["center","top"]):r==="left"?s-=i:r==="right"?(s+=i,u=["center","top"]):l-=i;var d=0;return(r==="left"||r==="right")&&(d=Math.PI/2),{rotation:d,x:s,y:l,style:{align:u[0],verticalAlign:u[1]}}},a.prototype._renderYearText=function(t,o,n,r){var i=t.getModel("yearLabel");if(!!i.get("show")){var s=i.get("margin"),l=i.get("position");l||(l=n!=="horizontal"?"top":"left");var u=[this._tlpoints[this._tlpoints.length-1],this._blpoints[0]],d=(u[0][0]+u[1][0])/2,c=(u[0][1]+u[1][1])/2,h=n==="horizontal"?0:1,f={top:[d,u[h][1]],bottom:[d,u[1-h][1]],left:[u[1-h][0],c],right:[u[h][0],c]},p=o.start.y;+o.end.y>+o.start.y&&(p=p+"-"+o.end.y);var g=i.get("formatter"),v={start:o.start.y,end:o.end.y,nameMap:p},y=this._formatterLabel(g,v),b=new me({z2:30,style:ye(i,{text:y})});b.attr(this._yearTextPositionControl(b,f[l],n,l,s)),r.add(b)}},a.prototype._monthTextPositionControl=function(t,o,n,r,i){var s="left",l="top",u=t[0],d=t[1];return n==="horizontal"?(d=d+i,o&&(s="center"),r==="start"&&(l="bottom")):(u=u+i,o&&(l="middle"),r==="start"&&(s="right")),{x:u,y:d,align:s,verticalAlign:l}},a.prototype._renderMonthText=function(t,o,n,r){var i=t.getModel("monthLabel");if(!!i.get("show")){var s=i.get("nameMap"),l=i.get("margin"),u=i.get("position"),d=i.get("align"),c=[this._tlpoints,this._blpoints];(!s||de(s))&&(s&&(o=Wt(s)||o),s=o.get(["time","monthAbbr"])||[]);var h=u==="start"?0:1,f=n==="horizontal"?0:1;l=u==="start"?-l:l;for(var p=d==="center",g=0;g<c[h].length-1;g++){var v=c[h][g].slice(),y=this._firstDayOfMonth[g];if(p){var b=this._firstDayPoints[g];v[f]=(b[f]+c[0][g+1][f])/2}var _=i.get("formatter"),m=s[+y.m-1],x={yyyy:y.y,yy:(y.y+"").slice(2),MM:y.m,M:+y.m,nameMap:m},S=this._formatterLabel(_,x),I=new me({z2:30,style:be(ye(i,{text:S}),this._monthTextPositionControl(v,p,n,u,l))});r.add(I)}}},a.prototype._weekTextPositionControl=function(t,o,n,r,i){var s="center",l="middle",u=t[0],d=t[1],c=n==="start";return o==="horizontal"?(u=u+r+(c?1:-1)*i[0]/2,s=c?"right":"left"):(d=d+r+(c?1:-1)*i[1]/2,l=c?"bottom":"top"),{x:u,y:d,align:s,verticalAlign:l}},a.prototype._renderWeekText=function(t,o,n,r,i){var s=t.getModel("dayLabel");if(!!s.get("show")){var l=t.coordinateSystem,u=s.get("position"),d=s.get("nameMap"),c=s.get("margin"),h=l.getFirstDayOfWeek();if(!d||de(d)){d&&(o=Wt(d)||o);var f=o.get(["time","dayOfWeekShort"]);d=f||U(o.get(["time","dayOfWeekAbbr"]),function(x){return x[0]})}var p=l.getNextNDay(n.end.time,7-n.lweek).time,g=[l.getCellWidth(),l.getCellHeight()];c=Re(c,Math.min(g[1],g[0])),u==="start"&&(p=l.getNextNDay(n.start.time,-(7+n.fweek)).time,c=-c);for(var v=0;v<7;v++){var y=l.getNextNDay(p,v),b=l.dataToRect([y.time],!1).center,_=v;_=Math.abs((v+h)%7);var m=new me({z2:30,style:be(ye(s,{text:d[_]}),this._weekTextPositionControl(b,r,u,c,g))});i.add(m)}}},a.type="calendar",a}(xt),Zr=Wr,Je=864e5,Ur=function(){function e(a,t,o){this.type="calendar",this.dimensions=e.dimensions,this.getDimensionsInfo=e.getDimensionsInfo,this._model=a}return e.getDimensionsInfo=function(){return[{name:"time",type:"time"},"value"]},e.prototype.getRangeInfo=function(){return this._rangeInfo},e.prototype.getModel=function(){return this._model},e.prototype.getRect=function(){return this._rect},e.prototype.getCellWidth=function(){return this._sw},e.prototype.getCellHeight=function(){return this._sh},e.prototype.getOrient=function(){return this._orient},e.prototype.getFirstDayOfWeek=function(){return this._firstDayOfWeek},e.prototype.getDateInfo=function(a){a=Fo(a);var t=a.getFullYear(),o=a.getMonth()+1,n=o<10?"0"+o:""+o,r=a.getDate(),i=r<10?"0"+r:""+r,s=a.getDay();return s=Math.abs((s+7-this.getFirstDayOfWeek())%7),{y:t+"",m:n,d:i,day:s,time:a.getTime(),formatedDate:t+"-"+n+"-"+i,date:a}},e.prototype.getNextNDay=function(a,t){return t=t||0,t===0?this.getDateInfo(a):(a=new Date(this.getDateInfo(a).time),a.setDate(a.getDate()+t),this.getDateInfo(a))},e.prototype.update=function(a,t){this._firstDayOfWeek=+this._model.getModel("dayLabel").get("firstDay"),this._orient=this._model.get("orient"),this._lineWidth=this._model.getModel("itemStyle").getItemStyle().lineWidth||0,this._rangeInfo=this._getRangeInfo(this._initRangeOption());var o=this._rangeInfo.weeks||1,n=["width","height"],r=this._model.getCellSize().slice(),i=this._model.getBoxLayoutParams(),s=this._orient==="horizontal"?[o,7]:[7,o];w([0,1],function(c){d(r,c)&&(i[n[c]]=r[c]*s[c])});var l={width:t.getWidth(),height:t.getHeight()},u=this._rect=Za(i,l);w([0,1],function(c){d(r,c)||(r[c]=u[n[c]]/s[c])});function d(c,h){return c[h]!=null&&c[h]!=="auto"}this._sw=r[0],this._sh=r[1]},e.prototype.dataToPoint=function(a,t){Q(a)&&(a=a[0]),t==null&&(t=!0);var o=this.getDateInfo(a),n=this._rangeInfo,r=o.formatedDate;if(t&&!(o.time>=n.start.time&&o.time<n.end.time+Je))return[NaN,NaN];var i=o.day,s=this._getRangeInfo([n.start.time,r]).nthWeek;return this._orient==="vertical"?[this._rect.x+i*this._sw+this._sw/2,this._rect.y+s*this._sh+this._sh/2]:[this._rect.x+s*this._sw+this._sw/2,this._rect.y+i*this._sh+this._sh/2]},e.prototype.pointToData=function(a){var t=this.pointToDate(a);return t&&t.time},e.prototype.dataToRect=function(a,t){var o=this.dataToPoint(a,t);return{contentShape:{x:o[0]-(this._sw-this._lineWidth)/2,y:o[1]-(this._sh-this._lineWidth)/2,width:this._sw-this._lineWidth,height:this._sh-this._lineWidth},center:o,tl:[o[0]-this._sw/2,o[1]-this._sh/2],tr:[o[0]+this._sw/2,o[1]-this._sh/2],br:[o[0]+this._sw/2,o[1]+this._sh/2],bl:[o[0]-this._sw/2,o[1]+this._sh/2]}},e.prototype.pointToDate=function(a){var t=Math.floor((a[0]-this._rect.x)/this._sw)+1,o=Math.floor((a[1]-this._rect.y)/this._sh)+1,n=this._rangeInfo.range;return this._orient==="vertical"?this._getDateByWeeksAndDay(o,t-1,n):this._getDateByWeeksAndDay(t,o-1,n)},e.prototype.convertToPixel=function(a,t,o){var n=ia(t);return n===this?n.dataToPoint(o):null},e.prototype.convertFromPixel=function(a,t,o){var n=ia(t);return n===this?n.pointToData(o):null},e.prototype.containPoint=function(a){return console.warn("Not implemented."),!1},e.prototype._initRangeOption=function(){var a=this._model.get("range"),t;if(Q(a)&&a.length===1&&(a=a[0]),Q(a))t=a;else{var o=a.toString();if(/^\d{4}$/.test(o)&&(t=[o+"-01-01",o+"-12-31"]),/^\d{4}[\/|-]\d{1,2}$/.test(o)){var n=this.getDateInfo(o),r=n.date;r.setMonth(r.getMonth()+1);var i=this.getNextNDay(r,-1);t=[n.formatedDate,i.formatedDate]}/^\d{4}[\/|-]\d{1,2}[\/|-]\d{1,2}$/.test(o)&&(t=[o,o])}if(!t)return a;var s=this._getRangeInfo(t);return s.start.time>s.end.time&&t.reverse(),t},e.prototype._getRangeInfo=function(a){var t=[this.getDateInfo(a[0]),this.getDateInfo(a[1])],o;t[0].time>t[1].time&&(o=!0,t.reverse());var n=Math.floor(t[1].time/Je)-Math.floor(t[0].time/Je)+1,r=new Date(t[0].time),i=r.getDate(),s=t[1].date.getDate();r.setDate(i+n-1);var l=r.getDate();if(l!==s)for(var u=r.getTime()-t[1].time>0?1:-1;(l=r.getDate())!==s&&(r.getTime()-t[1].time)*u>0;)n-=u,r.setDate(l-u);var d=Math.floor((n+t[0].day+6)/7),c=o?-d+1:d-1;return o&&t.reverse(),{range:[t[0].formatedDate,t[1].formatedDate],start:t[0],end:t[1],allDay:n,weeks:d,nthWeek:c,fweek:t[0].day,lweek:t[1].day}},e.prototype._getDateByWeeksAndDay=function(a,t,o){var n=this._getRangeInfo(o);if(a>n.weeks||a===0&&t<n.fweek||a===n.weeks&&t>n.lweek)return null;var r=(a-1)*7-n.fweek+t,i=new Date(n.start.time);return i.setDate(+n.start.d+r),this.getDateInfo(i)},e.create=function(a,t){var o=[];return a.eachComponent("calendar",function(n){var r=new e(n);o.push(r),n.coordinateSystem=r}),a.eachSeries(function(n){n.get("coordinateSystem")==="calendar"&&(n.coordinateSystem=o[n.get("calendarIndex")||0])}),o},e.dimensions=["time","value"],e}();function ia(e){var a=e.calendarModel,t=e.seriesModel,o=a?a.coordinateSystem:t?t.coordinateSystem:null;return o}var Gr=Ur;function Hr(e){e.registerComponentModel(Fr),e.registerComponentView(Zr),e.registerCoordinateSystem("calendar",Gr)}var jr=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.type="dataZoom.select",a}(kn),Yr=jr,qr=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.type="dataZoom.select",a}(Ln),Kr=qr;function Xr(e){e.registerComponentModel(Yr),e.registerComponentView(Kr),Mn(e)}var J=function(){function e(){}return e}(),so={};function De(e,a){so[e]=a}function lo(e){return so[e]}var Jr=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.prototype.optionUpdated=function(){e.prototype.optionUpdated.apply(this,arguments);var t=this.ecModel;w(this.option.feature,function(o,n){var r=lo(n);r&&(r.getDefaultOption&&(r.defaultOption=r.getDefaultOption(t)),le(o,r.defaultOption))})},a.type="toolbox",a.layoutMode={type:"box",ignoreSize:!0},a.defaultOption={show:!0,z:6,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1,position:"bottom"}},a}(St),Qr=Jr,ei=function(e){N(a,e);function a(){return e!==null&&e.apply(this,arguments)||this}return a.prototype.render=function(t,o,n,r){var i=this.group;if(i.removeAll(),!t.get("show"))return;var s=+t.get("itemSize"),l=t.get("orient")==="vertical",u=t.get("feature")||{},d=this._features||(this._features={}),c=[];w(u,function(p,g){c.push(g)}),new $a(this._featureNames||[],c).add(h).update(h).remove(H(h,null)).execute(),this._featureNames=c;function h(p,g){var v=c[p],y=c[g],b=u[v],_=new Wo(b,t,t.ecModel),m;if(r&&r.newTitle!=null&&r.featureName===v&&(b.title=r.newTitle),v&&!y){if(ti(v))m={onclick:_.option.onclick,featureName:v};else{var x=lo(v);if(!x)return;m=new x}d[v]=m}else if(m=d[y],!m)return;m.uid=Zo("toolbox-feature"),m.model=_,m.ecModel=o,m.api=n;var S=m instanceof J;if(!v&&y){S&&m.dispose&&m.dispose(o,n);return}if(!_.get("show")||S&&m.unusable){S&&m.remove&&m.remove(o,n);return}f(_,m,v),_.setIconStatus=function(I,k){var A=this.option,T=this.iconPaths;A.iconStatus=A.iconStatus||{},A.iconStatus[I]=k,T[I]&&(k==="emphasis"?Zt:Ut)(T[I])},m instanceof J&&m.render&&m.render(_,o,n,r)}function f(p,g,v){var y=p.getModel("iconStyle"),b=p.getModel(["emphasis","iconStyle"]),_=g instanceof J&&g.getIcons?g.getIcons():p.get("icon"),m=p.get("title")||{},x,S;de(_)?(x={},x[v]=_):x=_,de(m)?(S={},S[v]=m):S=m;var I=p.iconPaths={};w(x,function(k,A){var T=Ua(k,{},{x:-s/2,y:-s/2,width:s,height:s});T.setStyle(y.getItemStyle());var V=T.ensureState("emphasis");V.style=b.getItemStyle();var G=new me({style:{text:S[A],align:b.get("textAlign"),borderRadius:b.get("textBorderRadius"),padding:b.get("textPadding"),fill:null},ignore:!0});T.setTextContent(G),Uo({el:T,componentModel:t,itemName:A,formatterParamsExtra:{title:S[A]}}),T.__title=S[A],T.on("mouseover",function(){var Y=b.getItemStyle(),se=l?t.get("right")==null&&t.get("left")!=="right"?"right":"left":t.get("bottom")==null&&t.get("top")!=="bottom"?"bottom":"top";G.setStyle({fill:b.get("textFill")||Y.fill||Y.stroke||"#000",backgroundColor:b.get("textBackgroundColor")}),T.setTextConfig({position:b.get("textPosition")||se}),G.ignore=!t.get("showTitle"),n.enterEmphasis(this)}).on("mouseout",function(){p.get(["iconStatus",A])!=="emphasis"&&n.leaveEmphasis(this),G.hide()}),(p.get(["iconStatus",A])==="emphasis"?Zt:Ut)(T),i.add(T),T.on("click",oe(g.onclick,g,o,n,A)),I[A]=T})}Go(i,t,n),i.add(Ho(i.getBoundingRect(),t)),l||i.eachChild(function(p){var g=p.__title,v=p.ensureState("emphasis"),y=v.textConfig||(v.textConfig={}),b=p.getTextContent(),_=b&&b.ensureState("emphasis");if(_&&!ke(_)&&g){var m=_.style||(_.style={}),x=jo(g,me.makeFont(m)),S=p.x+i.x,I=p.y+i.y+s,k=!1;I+x.height>n.getHeight()&&(y.position="top",k=!0);var A=k?-5-x.height:s+10;S+x.width/2>n.getWidth()?(y.position=["100%",A],m.align="right"):S-x.width/2<0&&(y.position=[0,A],m.align="left")}})},a.prototype.updateView=function(t,o,n,r){w(this._features,function(i){i instanceof J&&i.updateView&&i.updateView(i.model,o,n,r)})},a.prototype.remove=function(t,o){w(this._features,function(n){n instanceof J&&n.remove&&n.remove(t,o)}),this.group.removeAll()},a.prototype.dispose=function(t,o){w(this._features,function(n){n instanceof J&&n.dispose&&n.dispose(t,o)})},a.type="toolbox",a}(xt);function ti(e){return e.indexOf("my")===0}var ai=ei,oi=function(e){N(a,e);function a(){return e!==null&&e.apply(this,arguments)||this}return a.prototype.onclick=function(t,o){var n=this.model,r=n.get("name")||t.get("title.0.text")||"echarts",i=o.getZr().painter.getType()==="svg",s=i?"svg":n.get("type",!0)||"png",l=o.getConnectedDataURL({type:s,backgroundColor:n.get("backgroundColor",!0)||t.get("backgroundColor")||"#fff",connectedBackgroundColor:n.get("connectedBackgroundColor"),excludeComponents:n.get("excludeComponents"),pixelRatio:n.get("pixelRatio")}),u=Yo.browser;if(ke(MouseEvent)&&(u.newEdge||!u.ie&&!u.edge)){var d=document.createElement("a");d.download=r+"."+s,d.target="_blank",d.href=l;var c=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});d.dispatchEvent(c)}else if(window.navigator.msSaveOrOpenBlob||i){var h=l.split(","),f=h[0].indexOf("base64")>-1,p=i?decodeURIComponent(h[1]):h[1];f&&(p=window.atob(p));var g=r+"."+s;if(window.navigator.msSaveOrOpenBlob){for(var v=p.length,y=new Uint8Array(v);v--;)y[v]=p.charCodeAt(v);var b=new Blob([y]);window.navigator.msSaveOrOpenBlob(b,g)}else{var _=document.createElement("iframe");document.body.appendChild(_);var m=_.contentWindow,x=m.document;x.open("image/svg+xml","replace"),x.write(p),x.close(),m.focus(),x.execCommand("SaveAs",!0,g),document.body.removeChild(_)}}else{var S=n.get("lang"),I='<body style="margin:0;"><img src="'+l+'" style="max-width:100%;" title="'+(S&&S[0]||"")+'" /></body>',k=window.open();k.document.write(I),k.document.title=r}},a.getDefaultOption=function(t){var o={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:t.getLocaleModel().get(["toolbox","saveAsImage","title"]),type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],lang:t.getLocaleModel().get(["toolbox","saveAsImage","lang"])};return o},a}(J),ni=oi,sa="__ec_magicType_stack__",ri=[["line","bar"],["stack"]],ii=function(e){N(a,e);function a(){return e!==null&&e.apply(this,arguments)||this}return a.prototype.getIcons=function(){var t=this.model,o=t.get("icon"),n={};return w(t.get("type"),function(r){o[r]&&(n[r]=o[r])}),n},a.getDefaultOption=function(t){var o={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:t.getLocaleModel().get(["toolbox","magicType","title"]),option:{},seriesIndex:{}};return o},a.prototype.onclick=function(t,o,n){var r=this.model,i=r.get(["seriesIndex",n]);if(!!la[n]){var s={series:[]},l=function(c){var h=c.subType,f=c.id,p=la[n](h,f,c,r);p&&(Se(p,c.option),s.series.push(p));var g=c.coordinateSystem;if(g&&g.type==="cartesian2d"&&(n==="line"||n==="bar")){var v=g.getAxesByScale("ordinal")[0];if(v){var y=v.dim,b=y+"Axis",_=c.getReferringComponents(b,qo).models[0],m=_.componentIndex;s[b]=s[b]||[];for(var x=0;x<=m;x++)s[b][m]=s[b][m]||{};s[b][m].boundaryGap=n==="bar"}}};w(ri,function(c){Le(c,n)>=0&&w(c,function(h){r.setIconStatus(h,"normal")})}),r.setIconStatus(n,"emphasis"),t.eachComponent({mainType:"series",query:i==null?null:{seriesIndex:i}},l);var u,d=n;n==="stack"&&(u=le({stack:r.option.title.tiled,tiled:r.option.title.stack},r.option.title),r.get(["iconStatus",n])!=="emphasis"&&(d="tiled")),o.dispatchAction({type:"changeMagicType",currentType:d,newOption:s,newTitle:u,featureName:"magicType"})}},a}(J),la={line:function(e,a,t,o){if(e==="bar")return le({id:a,type:"line",data:t.get("data"),stack:t.get("stack"),markPoint:t.get("markPoint"),markLine:t.get("markLine")},o.get(["option","line"])||{},!0)},bar:function(e,a,t,o){if(e==="line")return le({id:a,type:"bar",data:t.get("data"),stack:t.get("stack"),markPoint:t.get("markPoint"),markLine:t.get("markLine")},o.get(["option","bar"])||{},!0)},stack:function(e,a,t,o){var n=t.get("stack")===sa;if(e==="line"||e==="bar")return o.setIconStatus("stack",n?"normal":"emphasis"),le({id:a,stack:n?"":sa},o.get(["option","stack"])||{},!0)}};wt({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(e,a){a.mergeOption(e.newOption)});var si=ii,He=new Array(60).join("-"),Ce="	";function li(e){var a={},t=[],o=[];return e.eachRawSeries(function(n){var r=n.coordinateSystem;if(r&&(r.type==="cartesian2d"||r.type==="polar")){var i=r.getBaseAxis();if(i.type==="category"){var s=i.dim+"_"+i.index;a[s]||(a[s]={categoryAxis:i,valueAxis:r.getOtherAxis(i),series:[]},o.push({axisDim:i.dim,axisIndex:i.index})),a[s].series.push(n)}else t.push(n)}else t.push(n)}),{seriesGroupByCategoryAxis:a,other:t,meta:o}}function ui(e){var a=[];return w(e,function(t,o){var n=t.categoryAxis,r=t.valueAxis,i=r.dim,s=[" "].concat(U(t.series,function(f){return f.name})),l=[n.model.getCategories()];w(t.series,function(f){var p=f.getRawData();l.push(f.getRawData().mapArray(p.mapDimension(i),function(g){return g}))});for(var u=[s.join(Ce)],d=0;d<l[0].length;d++){for(var c=[],h=0;h<l.length;h++)c.push(l[h][d]);u.push(c.join(Ce))}a.push(u.join(`
`))}),a.join(`

`+He+`

`)}function di(e){return U(e,function(a){var t=a.getRawData(),o=[a.name],n=[];return t.each(t.dimensions,function(){for(var r=arguments.length,i=arguments[r-1],s=t.getName(i),l=0;l<r-1;l++)n[l]=arguments[l];o.push((s?s+Ce:"")+n.join(Ce))}),o.join(`
`)}).join(`

`+He+`

`)}function ci(e){var a=li(e);return{value:Xo([ui(a.seriesGroupByCategoryAxis),di(a.other)],function(t){return!!t.replace(/[\n\t\s]/g,"")}).join(`

`+He+`

`),meta:a.meta}}function Ze(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function hi(e){var a=e.slice(0,e.indexOf(`
`));if(a.indexOf(Ce)>=0)return!0}var gt=new RegExp("["+Ce+"]+","g");function pi(e){for(var a=e.split(/\n+/g),t=Ze(a.shift()).split(gt),o=[],n=U(t,function(l){return{name:l,data:[]}}),r=0;r<a.length;r++){var i=Ze(a[r]).split(gt);o.push(i.shift());for(var s=0;s<i.length;s++)n[s]&&(n[s].data[r]=i[s])}return{series:n,categories:o}}function fi(e){for(var a=e.split(/\n+/g),t=Ze(a.shift()),o=[],n=0;n<a.length;n++){var r=Ze(a[n]);if(!!r){var i=r.split(gt),s="",l=void 0,u=!1;isNaN(i[0])?(u=!0,s=i[0],i=i.slice(1),o[n]={name:s,value:[]},l=o[n].value):l=o[n]=[];for(var d=0;d<i.length;d++)l.push(+i[d]);l.length===1&&(u?o[n].value=l[0]:o[n]=l[0])}}return{name:t,data:o}}function gi(e,a){var t=e.split(new RegExp(`
*`+He+`
*`,"g")),o={series:[]};return w(t,function(n,r){if(hi(n)){var i=pi(n),s=a[r],l=s.axisDim+"Axis";s&&(o[l]=o[l]||[],o[l][s.axisIndex]={data:i.categories},o.series=o.series.concat(i.series))}else{var i=fi(n);o.series.push(i)}}),o}var vi=function(e){N(a,e);function a(){return e!==null&&e.apply(this,arguments)||this}return a.prototype.onclick=function(t,o){setTimeout(function(){o.dispatchAction({type:"hideTip"})});var n=o.getDom(),r=this.model;this._dom&&n.removeChild(this._dom);var i=document.createElement("div");i.style.cssText="position:absolute;top:0;bottom:0;left:0;right:0;padding:5px",i.style.backgroundColor=r.get("backgroundColor")||"#fff";var s=document.createElement("h4"),l=r.get("lang")||[];s.innerHTML=l[0]||r.get("title"),s.style.cssText="margin:10px 20px",s.style.color=r.get("textColor");var u=document.createElement("div"),d=document.createElement("textarea");u.style.cssText="overflow:auto";var c=r.get("optionToContent"),h=r.get("contentToOption"),f=ci(t);if(ke(c)){var p=c(o.getOption());de(p)?u.innerHTML=p:Ko(p)&&u.appendChild(p)}else{d.readOnly=r.get("readOnly");var g=d.style;g.cssText="display:block;width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;resize:none;box-sizing:border-box;outline:none",g.color=r.get("textColor"),g.borderColor=r.get("textareaBorderColor"),g.backgroundColor=r.get("textareaColor"),d.value=f.value,u.appendChild(d)}var v=f.meta,y=document.createElement("div");y.style.cssText="position:absolute;bottom:5px;left:0;right:0";var b="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",_=document.createElement("div"),m=document.createElement("div");b+=";background-color:"+r.get("buttonColor"),b+=";color:"+r.get("buttonTextColor");var x=this;function S(){n.removeChild(i),x._dom=null}Gt(_,"click",S),Gt(m,"click",function(){if(h==null&&c!=null||h!=null&&c==null){S();return}var I;try{ke(h)?I=h(u,o.getOption()):I=gi(d.value,v)}catch(k){throw S(),new Error("Data view format error "+k)}I&&o.dispatchAction({type:"changeDataView",newOption:I}),S()}),_.innerHTML=l[1],m.innerHTML=l[2],m.style.cssText=_.style.cssText=b,!r.get("readOnly")&&y.appendChild(m),y.appendChild(_),i.appendChild(s),i.appendChild(u),i.appendChild(y),u.style.height=n.clientHeight-80+"px",n.appendChild(i),this._dom=i},a.prototype.remove=function(t,o){this._dom&&o.getDom().removeChild(this._dom)},a.prototype.dispose=function(t,o){this.remove(t,o)},a.getDefaultOption=function(t){var o={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:t.getLocaleModel().get(["toolbox","dataView","title"]),lang:t.getLocaleModel().get(["toolbox","dataView","lang"]),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"};return o},a}(J);function mi(e,a){return U(e,function(t,o){var n=a&&a[o];if(Oe(n)&&!Q(n)){var r=Oe(t)&&!Q(t);r||(t={value:t});var i=n.name!=null&&t.name==null;return t=Se(t,n),i&&delete t.name,t}else return t})}wt({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(e,a){var t=[];w(e.newOption.series,function(o){var n=a.getSeriesByName(o.name)[0];if(!n)t.push(be({type:"scatter"},o));else{var r=n.get("data");t.push({name:o.name,data:mi(o.data,r)})}}),a.mergeOption(Se({series:t},e.newOption))});var yi=vi,uo=w,co=Ga();function bi(e,a){var t=kt(e);uo(a,function(o,n){for(var r=t.length-1;r>=0;r--){var i=t[r];if(i[n])break}if(r<0){var s=e.queryComponents({mainType:"dataZoom",subType:"select",id:n})[0];if(s){var l=s.getPercentRange();t[0][n]={dataZoomId:n,start:l[0],end:l[1]}}}}),t.push(a)}function _i(e){var a=kt(e),t=a[a.length-1];a.length>1&&a.pop();var o={};return uo(t,function(n,r){for(var i=a.length-1;i>=0;i--)if(n=a[i][r],n){o[r]=n;break}}),o}function Ci(e){co(e).snapshots=null}function Si(e){return kt(e).length}function kt(e){var a=co(e);return a.snapshots||(a.snapshots=[{}]),a.snapshots}var xi=function(e){N(a,e);function a(){return e!==null&&e.apply(this,arguments)||this}return a.prototype.onclick=function(t,o){Ci(t),o.dispatchAction({type:"restore",from:this.uid})},a.getDefaultOption=function(t){var o={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:t.getLocaleModel().get(["toolbox","restore","title"])};return o},a}(J);wt({type:"restore",event:"restore",update:"prepareAndUpdate"},function(e,a){a.resetOption("recreate")});var wi=xi,Ai=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],Pi=function(){function e(a,t,o){var n=this;this._targetInfoList=[];var r=ua(t,a);w(Ti,function(i,s){(!o||!o.include||Le(o.include,s)>=0)&&i(r,n._targetInfoList)})}return e.prototype.setOutputRanges=function(a,t){return this.matchOutputRanges(a,t,function(o,n,r){if((o.coordRanges||(o.coordRanges=[])).push(n),!o.coordRange){o.coordRange=n;var i=Qe[o.brushType](0,r,n);o.__rangeOffset={offset:pa[o.brushType](i.values,o.range,[1,1]),xyMinMax:i.xyMinMax}}}),a},e.prototype.matchOutputRanges=function(a,t,o){w(a,function(n){var r=this.findTargetInfo(n,t);r&&r!==!0&&w(r.coordSyses,function(i){var s=Qe[n.brushType](1,i,n.range,!0);o(n,s.values,i,t)})},this)},e.prototype.setInputRanges=function(a,t){w(a,function(o){var n=this.findTargetInfo(o,t);if(o.range=o.range||[],n&&n!==!0){o.panelId=n.panelId;var r=Qe[o.brushType](0,n.coordSys,o.coordRange),i=o.__rangeOffset;o.range=i?pa[o.brushType](r.values,i.offset,Di(r.xyMinMax,i.xyMinMax)):r.values}},this)},e.prototype.makePanelOpts=function(a,t){return U(this._targetInfoList,function(o){var n=o.getPanelRect();return{panelId:o.panelId,defaultBrushType:t?t(o):null,clipPath:mr(n),isTargetByCursor:br(n,a,o.coordSysModel),getLinearBrushOtherExtent:yr(n)}})},e.prototype.controlSeries=function(a,t,o){var n=this.findTargetInfo(a,o);return n===!0||n&&Le(n.coordSyses,t.coordinateSystem)>=0},e.prototype.findTargetInfo=function(a,t){for(var o=this._targetInfoList,n=ua(t,a),r=0;r<o.length;r++){var i=o[r],s=a.panelId;if(s){if(i.panelId===s)return i}else for(var l=0;l<da.length;l++)if(da[l](n,i))return i}return!0},e}();function vt(e){return e[0]>e[1]&&e.reverse(),e}function ua(e,a){return Ha(e,a,{includeMainTypes:Ai})}var Ti={grid:function(e,a){var t=e.xAxisModels,o=e.yAxisModels,n=e.gridModels,r=Jo(),i={},s={};!t&&!o&&!n||(w(t,function(l){var u=l.axis.grid.model;r.set(u.id,u),i[u.id]=!0}),w(o,function(l){var u=l.axis.grid.model;r.set(u.id,u),s[u.id]=!0}),w(n,function(l){r.set(l.id,l),i[l.id]=!0,s[l.id]=!0}),r.each(function(l){var u=l.coordinateSystem,d=[];w(u.getCartesians(),function(c,h){(Le(t,c.getAxis("x").model)>=0||Le(o,c.getAxis("y").model)>=0)&&d.push(c)}),a.push({panelId:"grid--"+l.id,gridModel:l,coordSysModel:l,coordSys:d[0],coordSyses:d,getPanelRect:ca.grid,xAxisDeclared:i[l.id],yAxisDeclared:s[l.id]})}))},geo:function(e,a){w(e.geoModels,function(t){var o=t.coordinateSystem;a.push({panelId:"geo--"+t.id,geoModel:t,coordSysModel:t,coordSys:o,coordSyses:[o],getPanelRect:ca.geo})})}},da=[function(e,a){var t=e.xAxisModel,o=e.yAxisModel,n=e.gridModel;return!n&&t&&(n=t.axis.grid.model),!n&&o&&(n=o.axis.grid.model),n&&n===a.gridModel},function(e,a){var t=e.geoModel;return t&&t===a.geoModel}],ca={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var e=this.coordSys,a=e.getBoundingRect().clone();return a.applyTransform(Ea(e)),a}},Qe={lineX:H(ha,0),lineY:H(ha,1),rect:function(e,a,t,o){var n=e?a.pointToData([t[0][0],t[1][0]],o):a.dataToPoint([t[0][0],t[1][0]],o),r=e?a.pointToData([t[0][1],t[1][1]],o):a.dataToPoint([t[0][1],t[1][1]],o),i=[vt([n[0],r[0]]),vt([n[1],r[1]])];return{values:i,xyMinMax:i}},polygon:function(e,a,t,o){var n=[[1/0,-1/0],[1/0,-1/0]],r=U(t,function(i){var s=e?a.pointToData(i,o):a.dataToPoint(i,o);return n[0][0]=Math.min(n[0][0],s[0]),n[1][0]=Math.min(n[1][0],s[1]),n[0][1]=Math.max(n[0][1],s[0]),n[1][1]=Math.max(n[1][1],s[1]),s});return{values:r,xyMinMax:n}}};function ha(e,a,t,o){var n=t.getAxis(["x","y"][e]),r=vt(U([0,1],function(s){return a?n.coordToData(n.toLocalCoord(o[s]),!0):n.toGlobalCoord(n.dataToCoord(o[s]))})),i=[];return i[e]=r,i[1-e]=[NaN,NaN],{values:r,xyMinMax:i}}var pa={lineX:H(fa,0),lineY:H(fa,1),rect:function(e,a,t){return[[e[0][0]-t[0]*a[0][0],e[0][1]-t[0]*a[0][1]],[e[1][0]-t[1]*a[1][0],e[1][1]-t[1]*a[1][1]]]},polygon:function(e,a,t){return U(e,function(o,n){return[o[0]-t[0]*a[n][0],o[1]-t[1]*a[n][1]]})}};function fa(e,a,t,o){return[a[0]-o[e]*t[0],a[1]-o[e]*t[1]]}function Di(e,a){var t=ga(e),o=ga(a),n=[t[0]/o[0],t[1]/o[1]];return isNaN(n[0])&&(n[0]=1),isNaN(n[1])&&(n[1]=1),n}function ga(e){return e?[e[0][1]-e[0][0],e[1][1]-e[1][0]]:[NaN,NaN]}var ho=Pi,mt=w,Ii=en("toolbox-dataZoom_"),Oi=function(e){N(a,e);function a(){return e!==null&&e.apply(this,arguments)||this}return a.prototype.render=function(t,o,n,r){this._brushController||(this._brushController=new vr(n.getZr()),this._brushController.on("brush",oe(this._onBrush,this)).mount()),Mi(t,o,this,r,n),Li(t,o)},a.prototype.onclick=function(t,o,n){ki[n].call(this)},a.prototype.remove=function(t,o){this._brushController&&this._brushController.unmount()},a.prototype.dispose=function(t,o){this._brushController&&this._brushController.dispose()},a.prototype._onBrush=function(t){var o=t.areas;if(!t.isEnd||!o.length)return;var n={},r=this.ecModel;this._brushController.updateCovers([]);var i=new ho(Lt(this.model),r,{include:["grid"]});i.matchOutputRanges(o,r,function(u,d,c){if(c.type==="cartesian2d"){var h=u.brushType;h==="rect"?(s("x",c,d[0]),s("y",c,d[1])):s({lineX:"x",lineY:"y"}[h],c,d)}}),bi(r,n),this._dispatchZoomAction(n);function s(u,d,c){var h=d.getAxis(u),f=h.model,p=l(u,f,r),g=p.findRepresentativeAxisProxy(f).getMinMaxSpan();(g.minValueSpan!=null||g.maxValueSpan!=null)&&(c=Bn(0,c.slice(),h.scale.getExtent(),0,g.minValueSpan,g.maxValueSpan)),p&&(n[p.id]={dataZoomId:p.id,startValue:c[0],endValue:c[1]})}function l(u,d,c){var h;return c.eachComponent({mainType:"dataZoom",subType:"select"},function(f){var p=f.getAxisModel(u,d.componentIndex);p&&(h=f)}),h}},a.prototype._dispatchZoomAction=function(t){var o=[];mt(t,function(n,r){o.push(ue(n))}),o.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:o})},a.getDefaultOption=function(t){var o={show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:t.getLocaleModel().get(["toolbox","dataZoom","title"]),brushStyle:{borderWidth:0,color:"rgba(210,219,238,0.2)"}};return o},a}(J),ki={zoom:function(){var e=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:e})},back:function(){this._dispatchZoomAction(_i(this.ecModel))}};function Lt(e){var a={xAxisIndex:e.get("xAxisIndex",!0),yAxisIndex:e.get("yAxisIndex",!0),xAxisId:e.get("xAxisId",!0),yAxisId:e.get("yAxisId",!0)};return a.xAxisIndex==null&&a.xAxisId==null&&(a.xAxisIndex="all"),a.yAxisIndex==null&&a.yAxisId==null&&(a.yAxisIndex="all"),a}function Li(e,a){e.setIconStatus("back",Si(a)>1?"emphasis":"normal")}function Mi(e,a,t,o,n){var r=t._isZoomActive;o&&o.type==="takeGlobalCursor"&&(r=o.key==="dataZoomSelect"?o.dataZoomSelectActive:!1),t._isZoomActive=r,e.setIconStatus("zoom",r?"emphasis":"normal");var i=new ho(Lt(e),a,{include:["grid"]}),s=i.makePanelOpts(n,function(l){return l.xAxisDeclared&&!l.yAxisDeclared?"lineX":!l.xAxisDeclared&&l.yAxisDeclared?"lineY":"rect"});t._brushController.setPanels(s).enableBrush(r&&s.length?{brushType:"auto",brushStyle:e.getModel("brushStyle").getItemStyle()}:!1)}Qo("dataZoom",function(e){var a=e.getComponent("toolbox",0),t=["feature","dataZoom"];if(!a||a.get(t)==null)return;var o=a.getModel(t),n=[],r=Lt(o),i=Ha(e,r);mt(i.xAxisModels,function(l){return s(l,"xAxis","xAxisIndex")}),mt(i.yAxisModels,function(l){return s(l,"yAxis","yAxisIndex")});function s(l,u,d){var c=l.componentIndex,h={type:"select",$fromToolbox:!0,filterMode:o.get("filterMode",!0)||"filter",id:Ii+u+c};h[d]=c,n.push(h)}return n});var Bi=Oi;function Ni(e){e.registerComponentModel(Qr),e.registerComponentView(ai),De("saveAsImage",ni),De("magicType",si),De("dataView",yi),De("dataZoom",Bi),De("restore",wi),Ct(Xr)}var zi=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t.layoutMode="box",t}return a.prototype.init=function(t,o,n){this.mergeDefaultAndTheme(t,n),this._initData()},a.prototype.mergeOption=function(t){e.prototype.mergeOption.apply(this,arguments),this._initData()},a.prototype.setCurrentIndex=function(t){t==null&&(t=this.option.currentIndex);var o=this._data.count();this.option.loop?t=(t%o+o)%o:(t>=o&&(t=o-1),t<0&&(t=0)),this.option.currentIndex=t},a.prototype.getCurrentIndex=function(){return this.option.currentIndex},a.prototype.isIndexMax=function(){return this.getCurrentIndex()>=this._data.count()-1},a.prototype.setPlayState=function(t){this.option.autoPlay=!!t},a.prototype.getPlayState=function(){return!!this.option.autoPlay},a.prototype._initData=function(){var t=this.option,o=t.data||[],n=t.axisType,r=this._names=[],i;n==="category"?(i=[],w(o,function(u,d){var c=tn(an(u),""),h;Oe(u)?(h=ue(u),h.value=d):h=d,i.push(h),r.push(c)})):i=o;var s={category:"ordinal",time:"time",value:"number"}[n]||"number",l=this._data=new on([{name:"value",type:s}],this);l.initData(i,r)},a.prototype.getData=function(){return this._data},a.prototype.getCategories=function(){if(this.get("axisType")==="category")return this._names.slice()},a.type="timeline",a.defaultOption={z:4,show:!0,axisType:"time",realtime:!0,left:"20%",top:null,right:"20%",bottom:0,width:null,height:40,padding:5,controlPosition:"left",autoPlay:!1,rewind:!1,loop:!0,playInterval:2e3,currentIndex:0,itemStyle:{},label:{color:"#000"},data:[]},a}(St),va=zi,po=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.type="timeline.slider",a.defaultOption=nn(va.defaultOption,{backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,orient:"horizontal",inverse:!1,tooltip:{trigger:"item"},symbol:"circle",symbolSize:12,lineStyle:{show:!0,width:2,color:"#DAE1F5"},label:{position:"auto",show:!0,interval:"auto",rotate:0,color:"#A4B1D7"},itemStyle:{color:"#A4B1D7",borderWidth:1},checkpointStyle:{symbol:"circle",symbolSize:15,color:"#316bf3",borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0, 0, 0, 0.3)",animation:!0,animationDuration:300,animationEasing:"quinticInOut"},controlStyle:{show:!0,showPlayBtn:!0,showPrevBtn:!0,showNextBtn:!0,itemSize:24,itemGap:12,position:"left",playIcon:"path://M31.6,53C17.5,53,6,41.5,6,27.4S17.5,1.8,31.6,1.8C45.7,1.8,57.2,13.3,57.2,27.4S45.7,53,31.6,53z M31.6,3.3 C18.4,3.3,7.5,14.1,7.5,27.4c0,13.3,10.8,24.1,24.1,24.1C44.9,51.5,55.7,40.7,55.7,27.4C55.7,14.1,44.9,3.3,31.6,3.3z M24.9,21.3 c0-2.2,1.6-3.1,3.5-2l10.5,6.1c1.899,1.1,1.899,2.9,0,4l-10.5,6.1c-1.9,1.1-3.5,0.2-3.5-2V21.3z",stopIcon:"path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z",nextIcon:"M2,18.5A1.52,1.52,0,0,1,.92,18a1.49,1.49,0,0,1,0-2.12L7.81,9.36,1,3.11A1.5,1.5,0,1,1,3,.89l8,7.34a1.48,1.48,0,0,1,.49,1.09,1.51,1.51,0,0,1-.46,1.1L3,18.08A1.5,1.5,0,0,1,2,18.5Z",prevIcon:"M10,.5A1.52,1.52,0,0,1,11.08,1a1.49,1.49,0,0,1,0,2.12L4.19,9.64,11,15.89a1.5,1.5,0,1,1-2,2.22L1,10.77A1.48,1.48,0,0,1,.5,9.68,1.51,1.51,0,0,1,1,8.58L9,.92A1.5,1.5,0,0,1,10,.5Z",prevBtnSize:18,nextBtnSize:18,color:"#A4B1D7",borderColor:"#A4B1D7",borderWidth:1},emphasis:{label:{show:!0,color:"#6f778d"},itemStyle:{color:"#316BF3"},controlStyle:{color:"#316BF3",borderColor:"#316BF3",borderWidth:2}},progress:{lineStyle:{color:"#316BF3"},itemStyle:{color:"#316BF3"},label:{color:"#6f778d"}},data:[]}),a}(va);Fa(po,rn.prototype);var Vi=po,$i=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.type="timeline",a}(xt),Ri=$i,Ei=function(e){N(a,e);function a(t,o,n,r){var i=e.call(this,t,o,n)||this;return i.type=r||"value",i}return a.prototype.getLabelModel=function(){return this.model.getModel("label")},a.prototype.isHorizontal=function(){return this.model.get("orient")==="horizontal"},a}(Nn),Fi=Ei,et=Math.PI,ma=Ga(),Wi=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.prototype.init=function(t,o){this.api=o},a.prototype.render=function(t,o,n){if(this.model=t,this.api=n,this.ecModel=o,this.group.removeAll(),t.get("show",!0)){var r=this._layout(t,n),i=this._createGroup("_mainGroup"),s=this._createGroup("_labelGroup"),l=this._axis=this._createAxis(r,t);t.formatTooltip=function(u){var d=l.scale.getLabel({value:u});return sn("nameValue",{noName:!0,value:d})},w(["AxisLine","AxisTick","Control","CurrentPointer"],function(u){this["_render"+u](r,i,l,t)},this),this._renderAxisLabel(r,s,l,t),this._position(r,t)}this._doPlayStop(),this._updateTicksStatus()},a.prototype.remove=function(){this._clearTimer(),this.group.removeAll()},a.prototype.dispose=function(){this._clearTimer()},a.prototype._layout=function(t,o){var n=t.get(["label","position"]),r=t.get("orient"),i=Ui(t,o),s;n==null||n==="auto"?s=r==="horizontal"?i.y+i.height/2<o.getHeight()/2?"-":"+":i.x+i.width/2<o.getWidth()/2?"+":"-":de(n)?s={horizontal:{top:"-",bottom:"+"},vertical:{left:"-",right:"+"}}[r][n]:s=n;var l={horizontal:"center",vertical:s>=0||s==="+"?"left":"right"},u={horizontal:s>=0||s==="+"?"top":"bottom",vertical:"middle"},d={horizontal:0,vertical:et/2},c=r==="vertical"?i.height:i.width,h=t.getModel("controlStyle"),f=h.get("show",!0),p=f?h.get("itemSize"):0,g=f?h.get("itemGap"):0,v=p+g,y=t.get(["label","rotate"])||0;y=y*et/180;var b,_,m,x=h.get("position",!0),S=f&&h.get("showPlayBtn",!0),I=f&&h.get("showPrevBtn",!0),k=f&&h.get("showNextBtn",!0),A=0,T=c;x==="left"||x==="bottom"?(S&&(b=[0,0],A+=v),I&&(_=[A,0],A+=v),k&&(m=[T-p,0],T-=v)):(S&&(b=[T-p,0],T-=v),I&&(_=[0,0],A+=v),k&&(m=[T-p,0],T-=v));var V=[A,T];return t.get("inverse")&&V.reverse(),{viewRect:i,mainLength:c,orient:r,rotation:d[r],labelRotation:y,labelPosOpt:s,labelAlign:t.get(["label","align"])||l[r],labelBaseline:t.get(["label","verticalAlign"])||t.get(["label","baseline"])||u[r],playPosition:b,prevBtnPosition:_,nextBtnPosition:m,axisExtent:V,controlSize:p,controlGap:g}},a.prototype._position=function(t,o){var n=this._mainGroup,r=this._labelGroup,i=t.viewRect;if(t.orient==="vertical"){var s=mn(),l=i.x,u=i.y+i.height;Ht(s,s,[-l,-u]),ln(s,s,-et/2),Ht(s,s,[l,u]),i=i.clone(),i.applyTransform(s)}var d=b(i),c=b(n.getBoundingRect()),h=b(r.getBoundingRect()),f=[n.x,n.y],p=[r.x,r.y];p[0]=f[0]=d[0][0];var g=t.labelPosOpt;if(g==null||de(g)){var v=g==="+"?0:1;_(f,c,d,1,v),_(p,h,d,1,1-v)}else{var v=g>=0?0:1;_(f,c,d,1,v),p[1]=f[1]+g}n.setPosition(f),r.setPosition(p),n.rotation=r.rotation=t.rotation,y(n),y(r);function y(m){m.originX=d[0][0]-m.x,m.originY=d[1][0]-m.y}function b(m){return[[m.x,m.x+m.width],[m.y,m.y+m.height]]}function _(m,x,S,I,k){m[I]+=S[I][k]-x[I][k]}},a.prototype._createAxis=function(t,o){var n=o.getData(),r=o.get("axisType"),i=Zi(o,r);i.getTicks=function(){return n.mapArray(["value"],function(u){return{value:u}})};var s=n.getDataExtent("value");i.setExtent(s[0],s[1]),i.calcNiceTicks();var l=new Fi("value",i,t.axisExtent,r);return l.model=o,l},a.prototype._createGroup=function(t){var o=this[t]=new Ne;return this.group.add(o),o},a.prototype._renderAxisLine=function(t,o,n,r){var i=n.getExtent();if(!!r.get(["lineStyle","show"])){var s=new jt({shape:{x1:i[0],y1:0,x2:i[1],y2:0},style:be({lineCap:"round"},r.getModel("lineStyle").getLineStyle()),silent:!0,z2:1});o.add(s);var l=this._progressLine=new jt({shape:{x1:i[0],x2:this._currentPointer?this._currentPointer.x:i[0],y1:0,y2:0},style:Se({lineCap:"round",lineWidth:s.style.lineWidth},r.getModel(["progress","lineStyle"]).getLineStyle()),silent:!0,z2:1});o.add(l)}},a.prototype._renderAxisTick=function(t,o,n,r){var i=this,s=r.getData(),l=n.scale.getTicks();this._tickSymbols=[],w(l,function(u){var d=n.dataToCoord(u.value),c=s.getItemModel(u.value),h=c.getModel("itemStyle"),f=c.getModel(["emphasis","itemStyle"]),p=c.getModel(["progress","itemStyle"]),g={x:d,y:0,onclick:oe(i._changeTimeline,i,u.value)},v=ya(c,h,o,g);v.ensureState("emphasis").style=f.getItemStyle(),v.ensureState("progress").style=p.getItemStyle(),qe(v);var y=za(v);c.get("tooltip")?(y.dataIndex=u.value,y.dataModel=r):y.dataIndex=y.dataModel=null,i._tickSymbols.push(v)})},a.prototype._renderAxisLabel=function(t,o,n,r){var i=this,s=n.getLabelModel();if(!!s.get("show")){var l=r.getData(),u=n.getViewLabels();this._tickLabels=[],w(u,function(d){var c=d.tickValue,h=l.getItemModel(c),f=h.getModel("label"),p=h.getModel(["emphasis","label"]),g=h.getModel(["progress","label"]),v=n.dataToCoord(d.tickValue),y=new me({x:v,y:0,rotation:t.labelRotation-t.rotation,onclick:oe(i._changeTimeline,i,c),silent:!1,style:ye(f,{text:d.formattedLabel,align:t.labelAlign,verticalAlign:t.labelBaseline})});y.ensureState("emphasis").style=ye(p),y.ensureState("progress").style=ye(g),o.add(y),qe(y),ma(y).dataIndex=c,i._tickLabels.push(y)})}},a.prototype._renderControl=function(t,o,n,r){var i=t.controlSize,s=t.rotation,l=r.getModel("controlStyle").getItemStyle(),u=r.getModel(["emphasis","controlStyle"]).getItemStyle(),d=r.getPlayState(),c=r.get("inverse",!0);h(t.nextBtnPosition,"next",oe(this._changeTimeline,this,c?"-":"+")),h(t.prevBtnPosition,"prev",oe(this._changeTimeline,this,c?"+":"-")),h(t.playPosition,d?"stop":"play",oe(this._handlePlayClick,this,!d),!0);function h(f,p,g,v){if(!!f){var y=un(ut(r.get(["controlStyle",p+"BtnSize"]),i),i),b=[0,-y/2,y,y],_=Gi(r,p+"Icon",b,{x:f[0],y:f[1],originX:i/2,originY:0,rotation:v?-s:0,rectHover:!0,style:l,onclick:g});_.ensureState("emphasis").style=u,o.add(_),qe(_)}}},a.prototype._renderCurrentPointer=function(t,o,n,r){var i=r.getData(),s=r.getCurrentIndex(),l=i.getItemModel(s).getModel("checkpointStyle"),u=this,d={onCreate:function(c){c.draggable=!0,c.drift=oe(u._handlePointerDrag,u),c.ondragend=oe(u._handlePointerDragend,u),ba(c,u._progressLine,s,n,r,!0)},onUpdate:function(c){ba(c,u._progressLine,s,n,r)}};this._currentPointer=ya(l,l,this._mainGroup,{},this._currentPointer,d)},a.prototype._handlePlayClick=function(t){this._clearTimer(),this.api.dispatchAction({type:"timelinePlayChange",playState:t,from:this.uid})},a.prototype._handlePointerDrag=function(t,o,n){this._clearTimer(),this._pointerChangeTimeline([n.offsetX,n.offsetY])},a.prototype._handlePointerDragend=function(t){this._pointerChangeTimeline([t.offsetX,t.offsetY],!0)},a.prototype._pointerChangeTimeline=function(t,o){var n=this._toAxisCoord(t)[0],r=this._axis,i=dn(r.getExtent().slice());n>i[1]&&(n=i[1]),n<i[0]&&(n=i[0]),this._currentPointer.x=n,this._currentPointer.markRedraw(),this._progressLine.shape.x2=n,this._progressLine.dirty();var s=this._findNearestTick(n),l=this.model;(o||s!==l.getCurrentIndex()&&l.get("realtime"))&&this._changeTimeline(s)},a.prototype._doPlayStop=function(){var t=this;this._clearTimer(),this.model.getPlayState()&&(this._timer=setTimeout(function(){var o=t.model;t._changeTimeline(o.getCurrentIndex()+(o.get("rewind",!0)?-1:1))},this.model.get("playInterval")))},a.prototype._toAxisCoord=function(t){var o=this._mainGroup.getLocalTransform();return cn(t,o,!0)},a.prototype._findNearestTick=function(t){var o=this.model.getData(),n=1/0,r,i=this._axis;return o.each(["value"],function(s,l){var u=i.dataToCoord(s),d=Math.abs(u-t);d<n&&(n=d,r=l)}),r},a.prototype._clearTimer=function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},a.prototype._changeTimeline=function(t){var o=this.model.getCurrentIndex();t==="+"?t=o+1:t==="-"&&(t=o-1),this.api.dispatchAction({type:"timelineChange",currentIndex:t,from:this.uid})},a.prototype._updateTicksStatus=function(){var t=this.model.getCurrentIndex(),o=this._tickSymbols,n=this._tickLabels;if(o)for(var r=0;r<o.length;r++)o&&o[r]&&o[r].toggleState("progress",r<t);if(n)for(var r=0;r<n.length;r++)n&&n[r]&&n[r].toggleState("progress",ma(n[r]).dataIndex<=t)},a.type="timeline.slider",a}(Ri);function Zi(e,a){if(a=a||e.get("type"),a)switch(a){case"category":return new fn({ordinalMeta:e.getCategories(),extent:[1/0,-1/0]});case"time":return new pn({locale:e.ecModel.getLocaleModel(),useUTC:e.ecModel.get("useUTC")});default:return new hn}}function Ui(e,a){return Za(e.getBoxLayoutParams(),{width:a.getWidth(),height:a.getHeight()},e.get("padding"))}function Gi(e,a,t,o){var n=o.style,r=Ua(e.get(["controlStyle",a]),o||{},new bt(t[0],t[1],t[2],t[3]));return n&&r.setStyle(n),r}function ya(e,a,t,o,n,r){var i=a.get("color");if(n)n.setColor(i),t.add(n),r&&r.onUpdate(n);else{var s=e.get("symbol");n=Na(s,-1,-1,2,2,i),n.setStyle("strokeNoScale",!0),t.add(n),r&&r.onCreate(n)}var l=a.getItemStyle(["color"]);n.setStyle(l),o=le({rectHover:!0,z2:100},o,!0);var u=gn(e.get("symbolSize"));o.scaleX=u[0]/2,o.scaleY=u[1]/2;var d=vn(e.get("symbolOffset"),u);d&&(o.x=(o.x||0)+d[0],o.y=(o.y||0)+d[1]);var c=e.get("symbolRotate");return o.rotation=(c||0)*Math.PI/180||0,n.attr(o),n.updateTransform(),n}function ba(e,a,t,o,n,r){if(!e.dragging){var i=n.getModel("checkpointStyle"),s=o.dataToCoord(n.getData().get("value",t));if(r||!i.get("animation",!0))e.attr({x:s,y:0}),a&&a.attr({shape:{x2:s}});else{var l={duration:i.get("animationDuration",!0),easing:i.get("animationEasing",!0)};e.stopAnimation(null,!0),e.animateTo({x:s,y:0},l),a&&a.animateTo({shape:{x2:s}},l)}}}var Hi=Wi;function ji(e){e.registerAction({type:"timelineChange",event:"timelineChanged",update:"prepareAndUpdate"},function(a,t,o){var n=t.getComponent("timeline");return n&&a.currentIndex!=null&&(n.setCurrentIndex(a.currentIndex),!n.get("loop",!0)&&n.isIndexMax()&&n.getPlayState()&&(n.setPlayState(!1),o.dispatchAction({type:"timelinePlayChange",playState:!1,from:a.from}))),t.resetOption("timeline",{replaceMerge:n.get("replaceMerge",!0)}),Se({currentIndex:n.option.currentIndex},a)}),e.registerAction({type:"timelinePlayChange",event:"timelinePlayChanged",update:"update"},function(a,t){var o=t.getComponent("timeline");o&&a.playState!=null&&o.setPlayState(a.playState)})}function Yi(e){var a=e&&e.timeline;Q(a)||(a=a?[a]:[]),w(a,function(t){!t||qi(t)})}function qi(e){var a=e.type,t={number:"value",time:"time"};if(t[a]&&(e.axisType=t[a],delete e.type),_a(e),pe(e,"controlPosition")){var o=e.controlStyle||(e.controlStyle={});pe(o,"position")||(o.position=e.controlPosition),o.position==="none"&&!pe(o,"show")&&(o.show=!1,delete o.position),delete e.controlPosition}w(e.data||[],function(n){Oe(n)&&!Q(n)&&(!pe(n,"value")&&pe(n,"name")&&(n.value=n.name),_a(n))})}function _a(e){var a=e.itemStyle||(e.itemStyle={}),t=a.emphasis||(a.emphasis={}),o=e.label||e.label||{},n=o.normal||(o.normal={}),r={normal:1,emphasis:1};w(o,function(i,s){!r[s]&&!pe(n,s)&&(n[s]=i)}),t.label&&!pe(o,"emphasis")&&(o.emphasis=t.label,delete t.label)}function pe(e,a){return e.hasOwnProperty(a)}function Ki(e){e.registerComponentModel(Vi),e.registerComponentView(Hi),e.registerSubTypeDefaulter("timeline",function(){return"slider"}),ji(e),e.registerPreprocessor(Yi)}function Fe(){return`#${(Math.random()*16777215<<0).toString(16)}`}function Xi(e,a){const t=e.indexOf("open"),o=e.indexOf("close"),n=e.indexOf("high"),r=e.indexOf("low");let i;return a.map((s,l)=>{const u=s.slice(),d=l===0?(u[t]+u[o])/2:(i[t]+i[o])/2,c=(u[t]+u[n]+u[r]+u[o])/4,h=Math.max(u[n],u[t],u[o]),f=Math.min(u[r],u[t],u[o]);return u[t]=d,u[o]=c,u[n]=h,u[r]=f,i=u.slice(),u})}const Ji=2,Qi=3;function tt(e,a,t=Qi){const o=a%e;return a-o+(t===Ji?e:0)}function Ca(e,a){var t,o;return`${e.is_short?"Short":"Long"} ${a}  ${Ia(e.profit_ratio)} 
Enter-tag: ${(t=e.enter_tag)!=null?t:""} 
Exit-Tag: ${(o=e.exit_reason)!=null?o:""}`}function es(e,a){var t,o;return`${e.is_short?"Short":"Long"} adjustment
    ${a.ft_order_side==="buy"?"+":"-"}${bo(a.cost,(t=e.quote_currency)!=null?t:"")}
Enter-tag: ${(o=e.enter_tag)!=null?o:""}`}const ts="path://m 52.444161,104.1909 8.386653,25.34314 8.386651,25.34313 -16.731501,0.0422 -16.731501,0.0422 8.344848,-25.38539 z m 0.08656,-48.368126 8.386652,25.343139 8.386652,25.343137 -16.731501,0.0422 -16.731502,0.0422 8.344848,-25.385389 z",Sa="path://m 102.20764,19.885384 h 24.1454 v 41.928829 h -24.1454 z m 12.17344,36.423813 8.38665,25.343139 8.38666,25.343134 -16.7315,0.0422 -16.731507,0.0422 8.344847,-25.385386 z",at="#AD00FF",ot="#0066FF";function as(e,a){var o,n,r;const t=[];for(let i=0,s=a.length;i<s;i+=1){const l=a[i];if(l.open_timestamp>=e.data_start_ts&&l.open_timestamp<=e.data_stop_ts&&l.orders)for(let u=0;u<l.orders.length;u++){const d=l.orders[u];d.order_filled_timestamp&&d.order_filled_timestamp<=e.data_stop_ts&&d.order_filled_timestamp>e.data_start_ts&&(u===0?t.push([tt((o=e.timeframe_ms)!=null?o:0,l.open_timestamp),d.safe_price,Sa,d.ft_order_side=="sell"?180:0,l.is_short?at:ot,l.is_short?"Short":"Long",Ca(l,"entry")]):u===l.orders.length-1&&l.close_timestamp?l.close_timestamp<=e.data_stop_ts&&l.close_timestamp>e.data_start_ts&&l.is_open===!1&&t.push([tt((n=e.timeframe_ms)!=null?n:0,l.close_timestamp),d.safe_price,Sa,l.is_short?0:180,l.is_short?at:ot,Ia(l.profit_ratio,2),Ca(l,"exit")]):t.push([tt((r=e.timeframe_ms)!=null?r:0,d.order_filled_timestamp),d.safe_price,ts,d.ft_order_side=="sell"?180:0,l.is_short?at:ot,"",es(l,d)]))}}return{tradeData:t}}Ct([bn,Hr,_n,zn,Vn,Cn,Ki,Sn,Ni,xn,$n,Rn,Rr,En,Fn,Xn,wn]);const nt="5.5%",rt="1%",xa=55,Ie=8,os="#26A69A",ns="#26A69A",rs="#EF5350",is="#EF5350",ss="#00ff26",ls="#00ff26",us="#faba25",ds="#faba25",cs=Ue({name:"CandleChart",components:{"v-chart":yn},props:{trades:{required:!1,default:()=>[],type:Array},dataset:{required:!0,type:Object},heikinAshi:{required:!1,default:!1,type:Boolean},useUTC:{required:!1,default:!0,type:Boolean},plotConfig:{required:!0,type:Object},theme:{default:"dark",type:String},sliderPosition:{required:!1,type:Object,default:()=>{}}},setup(e){const a=z(),t=z([]),o=z([]),n=z({}),r=$(()=>e.dataset?e.dataset.strategy:""),i=$(()=>e.dataset?e.dataset.pair:""),s=$(()=>e.dataset?e.dataset.timeframe:""),l=$(()=>e.dataset?e.dataset.columns:[]),u=$(()=>e.dataset!==null&&typeof e.dataset=="object"),d=$(()=>e.trades.filter(g=>g.pair===i.value)),c=$(()=>`${r.value} - ${i.value} - ${s.value}`),h=(g=!1)=>{var Ve,ce,W,ee;if(!u.value)return;(Ve=n.value)!=null&&Ve.title&&(n.value.title[0].text=c.value);const v=e.dataset.columns.findIndex(C=>C==="__date_ts"),y=e.dataset.columns.findIndex(C=>C==="open"),b=e.dataset.columns.findIndex(C=>C==="high"),_=e.dataset.columns.findIndex(C=>C==="low"),m=e.dataset.columns.findIndex(C=>C==="close"),x=e.dataset.columns.findIndex(C=>C==="volume"),S=e.dataset.columns.findIndex(C=>C==="_buy_signal_close"||C==="_enter_long_signal_close"),I=e.dataset.columns.findIndex(C=>C==="_sell_signal_close"||C==="_exit_long_signal_close"),k=e.dataset.columns.findIndex(C=>C==="_enter_short_signal_close"),A=e.dataset.columns.findIndex(C=>C==="_exit_short_signal_close"),T="subplots"in e.plotConfig?Object.keys(e.plotConfig.subplots).length+1:1;if(Array.isArray((ce=n.value)==null?void 0:ce.dataZoom))if(g){const C=(1-250/e.dataset.length)*100;n.value.dataZoom.forEach((F,Z)=>{n.value&&n.value.dataZoom&&(n.value.dataZoom[Z].start=C)})}else n.value.dataZoom.forEach((C,F)=>{n.value&&n.value.dataZoom&&(delete n.value.dataZoom[F].start,delete n.value.dataZoom[F].end)});const V=e.heikinAshi?Xi(l.value,e.dataset.data):e.dataset.data.slice(),G=Array(V[V.length-2].length);G[v]=V[V.length-1][v]+e.dataset.timeframe_ms*3,V.push(G);const Y={dataset:{source:V},grid:[{left:nt,right:rt,bottom:`${T*Ie+2}%`},{left:nt,right:rt,bottom:`${T*Ie}%`,height:`${Ie}%`}],series:[{name:"Candles",type:"candlestick",barWidth:"80%",itemStyle:{color:os,color0:rs,borderColor:ns,borderColor0:is},encode:{x:v,y:[y,m,_,b]}},{name:"Volume",type:"bar",xAxisIndex:1,yAxisIndex:1,itemStyle:{color:"#777777"},large:!0,encode:{x:v,y:x}},{name:"Entry",type:"scatter",symbol:"triangle",symbolSize:10,xAxisIndex:0,yAxisIndex:0,itemStyle:{color:ss},encode:{x:v,y:S}}]};if(I>=0&&Array.isArray(Y.series)&&Y.series.push({name:"Exit",type:"scatter",symbol:"diamond",symbolSize:8,xAxisIndex:0,yAxisIndex:0,itemStyle:{color:us},encode:{x:v,y:I}}),Array.isArray(Y.series)&&(k>=0&&Y.series.push({name:"Entry",type:"scatter",symbol:"triangle",symbolRotate:180,symbolSize:10,xAxisIndex:0,yAxisIndex:0,itemStyle:{color:ls},tooltip:{},encode:{x:v,y:k}}),A>=0&&Y.series.push({name:"Exit",type:"scatter",symbol:"pin",symbolSize:8,xAxisIndex:0,yAxisIndex:0,itemStyle:{color:ds},tooltip:{},encode:{x:v,y:A}})),Object.assign(n.value,Y),"main_plot"in e.plotConfig&&Object.entries(e.plotConfig.main_plot).forEach(([C,F])=>{var xe,q,we,Ae,Pe;const Z=e.dataset.columns.findIndex(he=>he===C);if(Z>1){!Array.isArray((xe=n.value)==null?void 0:xe.legend)&&((we=(q=n.value)==null?void 0:q.legend)==null?void 0:we.data)&&n.value.legend.data.push(C);const he={name:C,type:F.type||"line",xAxisIndex:0,yAxisIndex:0,itemStyle:{color:F.color},encode:{x:v,y:Z},showSymbol:!1};Array.isArray((Ae=n.value)==null?void 0:Ae.series)&&((Pe=n.value)==null||Pe.series.push(he))}else console.log(`element ${C} for main plot not found in columns.`)}),"subplots"in e.plotConfig){let C=2;Object.entries(e.plotConfig.subplots).forEach(([F,Z])=>{const xe=C;Array.isArray(n.value.yAxis)&&n.value.yAxis.length<=C&&n.value.yAxis.push({scale:!0,gridIndex:xe,name:F,nameLocation:"middle",nameGap:xa,axisLabel:{show:!0},axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1}}),Array.isArray(n.value.xAxis)&&n.value.xAxis.length<=C&&n.value.xAxis.push({type:"time",scale:!0,gridIndex:xe,boundaryGap:!1,axisLine:{onZero:!1},axisTick:{show:!1},axisLabel:{show:!1},axisPointer:{label:{show:!1}},splitLine:{show:!1},splitNumber:20}),Array.isArray(n.value.dataZoom)&&n.value.dataZoom.forEach(q=>q.xAxisIndex&&Array.isArray(q.xAxisIndex)?q.xAxisIndex.push(C):null),n.value.grid&&Array.isArray(n.value.grid)&&n.value.grid.push({left:nt,right:rt,bottom:`${(T-C+1)*Ie}%`,height:`${Ie}%`}),Object.entries(Z).forEach(([q,we])=>{var Pe;const Ae=e.dataset.columns.findIndex(he=>he===q);if(Ae>0){!Array.isArray(n.value.legend)&&((Pe=n.value.legend)==null?void 0:Pe.data)&&n.value.legend.data.push(q);const he={name:q,type:we.type||"line",xAxisIndex:C,yAxisIndex:C,itemStyle:{color:we.color||Fe()},encode:{x:v,y:Ae},showSymbol:!1};n.value.series&&Array.isArray(n.value.series)&&n.value.series.push(he)}else console.log(`element ${q} was not found in the columns.`)}),C+=1})}Array.isArray(n.value.grid)&&(n.value.grid[n.value.grid.length-1].bottom="50px",delete n.value.grid[n.value.grid.length-1].top);const{tradeData:se}=as(e.dataset,d.value),ne="Trades";!Array.isArray(n.value.legend)&&((W=n.value.legend)==null?void 0:W.data)&&n.value.legend.data.push(ne);const ze={name:ne,type:"scatter",xAxisIndex:0,yAxisIndex:0,encode:{x:0,y:1,label:5,tooltip:6},label:{show:!0,fontSize:12,backgroundColor:e.theme!=="dark"?"#fff":"#000",padding:2,color:e.theme==="dark"?"#fff":"#000"},labelLayout:{rotate:75,align:"left",dx:10},itemStyle:{color:C=>C.data[4],opacity:.9},symbol:C=>C[2],symbolRotate:C=>C[3],symbolSize:13,data:se};Array.isArray(n.value.series)&&n.value.series.push(ze),(ee=a.value)==null||ee.setOption(n.value,{replaceMerge:["series","grid","yAxis","xAxis","legend"],noMerge:!g})},f=()=>{var g;(g=a.value)==null||g.setOption({},{noMerge:!0}),n.value={title:[{show:!1}],backgroundColor:"rgba(0, 0, 0, 0)",useUTC:e.useUTC,animation:!1,legend:{data:["Candles","Volume","Entry","Exit"],right:"1%"},tooltip:{show:!0,trigger:"axis",renderMode:"richText",backgroundColor:"rgba(80,80,80,0.7)",borderWidth:0,textStyle:{color:"#fff"},axisPointer:{type:"cross",lineStyle:{color:"#cccccc",width:1,opacity:1}},position(v,y,b,_,m){const x={top:60};return x[["left","right"][+(v[0]<m.viewSize[0]/2)]]=5,x}},axisPointer:{link:[{xAxisIndex:"all"}],label:{backgroundColor:"#777"}},xAxis:[{type:"time",scale:!0,boundaryGap:!1,axisLine:{onZero:!1},axisTick:{show:!0},axisLabel:{show:!0},axisPointer:{label:{show:!1}},position:"top",splitLine:{show:!1},splitNumber:20,min:"dataMin",max:"dataMax"},{type:"time",gridIndex:1,scale:!0,boundaryGap:!1,axisLine:{onZero:!1},axisTick:{show:!1},axisLabel:{show:!1},axisPointer:{label:{show:!1}},splitLine:{show:!1},splitNumber:20,min:"dataMin",max:"dataMax"}],yAxis:[{scale:!0},{scale:!0,gridIndex:1,splitNumber:2,name:"volume",nameLocation:"middle",nameGap:xa,axisLabel:{show:!1},axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1}}],dataZoom:[{type:"inside",xAxisIndex:[0,1],start:80,end:100},{show:!0,xAxisIndex:[0,1],type:"slider",bottom:10,start:80,end:100}]},console.log("Initialized"),h(!0)},p=()=>{if(!e.sliderPosition)return;const g=zt.format(e.sliderPosition.startValue-e.dataset.timeframe_ms*40,"yyyy-MM-dd HH:mm:ss"),v=zt.format(e.sliderPosition.endValue?e.sliderPosition.endValue+e.dataset.timeframe_ms*40:e.sliderPosition.startValue+e.dataset.timeframe_ms*80,"yyyy-MM-dd HH:mm:ss");a.value&&a.value.dispatchAction({type:"dataZoom",dataZoomIndex:0,startValue:g,endValue:v})};return yt(()=>{f()}),ie(()=>e.useUTC,()=>f()),ie(()=>e.dataset,()=>h()),ie(()=>e.plotConfig,()=>f()),ie(()=>e.heikinAshi,()=>h()),ie(()=>e.sliderPosition,()=>p()),{candleChart:a,buyData:t,sellData:o,strategy:r,pair:i,timeframe:s,datasetColumns:l,hasData:u,filteredTrades:d,chartTitle:c}}}),hs={class:"d-flex flex-grow-1 chart-wrapper"};function ps(e,a,t,o,n,r){const i=B("v-chart");return D(),L("div",hs,[e.hasData?(D(),j(i,{key:0,ref:"candleChart",theme:e.theme,autoresize:"","manual-update":""},null,8,["theme"])):E("",!0)])}var fs=Be(cs,[["render",ps],["__scopeId","data-v-60fc3b2f"]]);const fo="ft_custom_plot_config",go="ft_selected_plot_config";function gs(){return localStorage.getItem(go)||"default"}function vo(e){localStorage.setItem(go,e)}function Mt(){return JSON.parse(localStorage.getItem(fo)||"{}")}function wa(){return Object.keys(Mt())}function mo(e){const a=Mt();return e in a?a[e]:{...We}}function vs(e){const t={...Mt(),...e};localStorage.setItem(fo,JSON.stringify(t)),vo(Object.keys(e)[0])}const ms={name:"CloseCircleOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},ys=["aria-hidden","aria-label"],bs=["fill","width","height"],_s={d:"M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22C17.53,22 22,17.53 22,12C22,6.47 17.53,2 12,2M14.59,8L12,10.59L9.41,8L8,9.41L10.59,12L8,14.59L9.41,16L12,13.41L14.59,16L16,14.59L13.41,12L16,9.41L14.59,8Z"},Cs={key:0};function Ss(e,a,t,o,n,r){return D(),L("span",it(e.$attrs,{"aria-hidden":!t.title,"aria-label":t.title,class:"material-design-icon close-circle-outline-icon",role:"img",onClick:a[0]||(a[0]=i=>e.$emit("click",i))}),[(D(),L("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[M("path",_s,[t.title?(D(),L("title",Cs,ae(t.title),1)):E("",!0)])],8,bs))],16,ys)}var xs=Be(ms,[["render",Ss]]);const ws=Ue({name:"PlotIndicator",components:{Reset:xs},props:{modelValue:{required:!0,type:Object},columns:{required:!0,type:Array},addNew:{required:!0,type:Boolean}},emits:["update:modelValue"],setup(e,{emit:a}){const t=z(Fe()),o=z(Ee.line),n=z(Object.keys(Ee)),r=z(""),i=z(""),s=z(!1),l=$(()=>e.columns.filter(f=>f.toLowerCase().includes(r.value.toLowerCase()))),u=()=>{t.value=Fe()},d=$(()=>s.value||!i.value?{}:{[i.value]:{color:t.value,type:o.value}}),c=()=>{a("update:modelValue",d.value)},h=()=>{s.value=!0,c()};return ie(()=>e.modelValue,()=>{[i.value]=Object.keys(e.modelValue),s.value=!1,i.value&&e.modelValue&&(t.value=e.modelValue[i.value].color||Fe(),o.value=e.modelValue[i.value].type||Ee.line)}),ie(t,()=>{e.addNew||c()}),{selColor:t,graphType:o,availableGraphTypes:n,selAvailableIndicator:i,cancelled:s,combinedIndicator:d,newColor:u,emitIndicator:c,clickCancel:h,indicatorFilter:r,filteredIndicators:l}}}),As=e=>(Oa("data-v-0a49ec00"),e=e(),ka(),e),Ps={key:0},Ts=As(()=>M("hr",null,null,-1)),Ds={class:"d-flex d-flex-columns"};function Is(e,a,t,o,n,r){const i=B("b-form-input"),s=B("Reset"),l=B("b-input-group-append"),u=B("b-input-group"),d=B("b-form-select"),c=B("b-form-group"),h=B("b-input-group-prepend"),f=B("b-button");return D(),L("div",null,[e.addNew?(D(),L("div",Ps,[P(c,{label:"Add indicator","label-for":"indicatorSelector"},{default:O(()=>[P(u,{size:"sm"},{default:O(()=>[P(i,{modelValue:e.indicatorFilter,"onUpdate:modelValue":a[0]||(a[0]=p=>e.indicatorFilter=p),placeholder:"Filter indicators"},null,8,["modelValue"]),P(l,null,{default:O(()=>[P(s,{class:"pointer align-self-center ms-1",size:18,onClick:a[1]||(a[1]=p=>e.indicatorFilter="")})]),_:1})]),_:1}),P(d,{id:"indicatorSelector",modelValue:e.selAvailableIndicator,"onUpdate:modelValue":a[2]||(a[2]=p=>e.selAvailableIndicator=p),options:e.filteredIndicators,"select-size":4},null,8,["modelValue","options"])]),_:1})])):E("",!0),P(c,{label:"Type","label-for":"plotTypeSelector"},{default:O(()=>[P(d,{id:"plotTypeSelector",modelValue:e.graphType,"onUpdate:modelValue":a[3]||(a[3]=p=>e.graphType=p),size:"sm",options:e.availableGraphTypes,onChange:a[4]||(a[4]=p=>e.emitIndicator())},null,8,["modelValue","options"])]),_:1}),Ts,P(c,{label:"Color","label-for":"colsel",size:"sm"},{default:O(()=>[P(u,null,{default:O(()=>[P(h,null,{default:O(()=>[M("div",{style:_o({"background-color":e.selColor}),class:"colorbox me-2"},null,4)]),_:1}),P(i,{id:"colsel",modelValue:e.selColor,"onUpdate:modelValue":a[5]||(a[5]=p=>e.selColor=p),size:"sm"},null,8,["modelValue"]),P(l,null,{default:O(()=>[P(f,{variant:"primary",size:"sm",onClick:e.newColor},{default:O(()=>[R("\u21BB")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),M("div",Ds,[e.addNew?(D(),j(f,{key:0,class:"flex-grow-1",variant:"primary",title:"Add ",size:"sm",onClick:e.emitIndicator},{default:O(()=>[R(" Save indicator ")]),_:1},8,["onClick"])):E("",!0),e.addNew?(D(),j(f,{key:1,class:"ms-1 flex-grow-1",variant:"secondary",title:"Add ",size:"sm",onClick:e.clickCancel},{default:O(()=>[R(" Cancel ")]),_:1},8,["onClick"])):E("",!0)])])}var Os=Be(ws,[["render",Is],["__scopeId","data-v-0a49ec00"]]);const yo=Co("plotConfig",{state:()=>({customPlotConfig:{},plotConfigName:gs(),availablePlotConfigNames:wa(),plotConfig:{...We}}),getters:{},actions:{saveCustomPlotConfig(e){this.customPlotConfig=e,vs(e),this.availablePlotConfigNames=wa()},setPlotConfigName(e){this.plotConfigName=e,vo(e)},plotConfigChanged(){console.log("plotConfigChanged"),this.plotConfig=mo(this.plotConfigName),this.setPlotConfigName(this.plotConfigName)},setPlotConfig(e){console.log("emit..."),this.plotConfig={...e}}}});const ks=Ue({name:"PlotConfigurator",components:{PlotIndicator:Os},props:{columns:{required:!0,type:Array},asModal:{required:!1,default:!0,type:Boolean}},setup(){const e=yo(),a=z(We),t=z("default"),o=z(""),n=z(""),r=z(!1),i=z(!1),s=z("main_plot"),l=z(),u=z(!0),d=$(()=>s.value==="main_plot"),c=$(()=>d.value?a.value.main_plot:a.value.subplots[s.value]),h=$(()=>["main_plot",...Object.keys(a.value.subplots)]),f=$(()=>d.value?Object.keys(a.value.main_plot):s.value in a.value.subplots?Object.keys(a.value.subplots[s.value]):[]),p=A=>{console.log(a.value);const T=Object.keys(A)[0],V=A[T];d.value?(console.log(`Adding ${T} to MainPlot`),a.value.main_plot[T]={...V}):(console.log(`Adding ${T} to ${s.value}`),a.value.subplots[s.value][T]={...V}),a.value={...a.value},r.value=!1,e.setPlotConfig(a.value)},g=$({get(){return r.value?{}:n.value?{[n.value]:c.value[n.value]}:{}},set(A){Object.keys(A)[0]&&A?p(A):r.value=!1}}),v=$({get(){return JSON.stringify(a.value,null,2)},set(A){try{l.value=JSON.parse(A),u.value=!0}catch{u.value=!1}}}),y=()=>{console.log(a.value),d.value?(console.log(`Removing ${n.value} from MainPlot`),delete a.value.main_plot[n.value]):(console.log(`Removing ${n.value} from ${s.value}`),delete a.value.subplots[s.value][n.value]),a.value={...a.value},console.log(a.value),n.value="",e.setPlotConfig(a.value)},b=()=>{a.value.subplots={...a.value.subplots,[o.value]:{}},s.value=o.value,o.value="",e.setPlotConfig(a.value)},_=()=>{delete a.value.subplots[s.value],a.value.subplots={...a.value.subplots},s.value="",e.setPlotConfig(a.value)},m=()=>{a.value=mo(t.value),console.log(a.value),console.log("loading config"),e.setPlotConfig(a.value)},x=()=>{l.value!==void 0&&u.value&&(a.value=l.value,e.setPlotConfig(a.value))},S=()=>{a.value={...We}},I=async()=>{try{const A=La();await A.activeBot.getStrategyPlotConfig(),A.activeBot.strategyPlotConfig&&(a.value=A.activeBot.strategyPlotConfig,e.setPlotConfig(a.value))}catch{So("Failed to load Plot configuration from Strategy.")}},k=()=>{e.saveCustomPlotConfig({[t.value]:a.value})};return yt(()=>{a.value=e.plotConfig,t.value=e.plotConfigName}),{plotStore:e,removeIndicator:y,addSubplot:b,delSubplot:_,loadPlotConfig:m,loadConfigFromString:x,resetConfig:S,loadPlotConfigFromStrategy:I,savePlotConfig:k,showConfig:i,addNewIndicator:r,selIndicatorName:n,usedColumns:f,selSubPlot:s,newSubplotName:o,subplots:h,plotConfigNameLoc:t,selIndicator:g,plotConfigJson:v,tempPlotConfigValid:u}}}),Bt=e=>(Oa("data-v-446b3592"),e=e(),ka(),e),Ls={key:0},Ms={class:"col-mb-3"},Bs=Bt(()=>M("hr",null,null,-1)),Ns=Bt(()=>M("hr",null,null,-1)),zs=Bt(()=>M("hr",null,null,-1)),Vs={key:1,class:"col-mb-5 ms-1 mt-2"};function $s(e,a,t,o,n,r){const i=B("b-form-input"),s=B("b-form-group"),l=B("b-form-select"),u=B("b-button"),d=B("b-input-group-append"),c=B("b-input-group"),h=B("PlotIndicator"),f=B("b-form-textarea");return e.columns?(D(),L("div",Ls,[P(s,{label:"Plot config name","label-for":"idPlotConfigName"},{default:O(()=>[P(i,{id:"idPlotConfigName",modelValue:e.plotConfigNameLoc,"onUpdate:modelValue":a[0]||(a[0]=p=>e.plotConfigNameLoc=p),size:"sm"},null,8,["modelValue"])]),_:1}),M("div",Ms,[Bs,P(s,{label:"Target","label-for":"FieldSel"},{default:O(()=>[P(l,{id:"FieldSel",modelValue:e.selSubPlot,"onUpdate:modelValue":a[1]||(a[1]=p=>e.selSubPlot=p),options:e.subplots,"select-size":3},null,8,["modelValue","options"])]),_:1})]),P(s,{label:"Add new plot","label-for":"newSubPlot"},{default:O(()=>[P(c,{size:"sm"},{default:O(()=>[P(i,{id:"newSubPlot",modelValue:e.newSubplotName,"onUpdate:modelValue":a[2]||(a[2]=p=>e.newSubplotName=p),class:"addPlot"},null,8,["modelValue"]),P(d,null,{default:O(()=>[P(u,{disabled:!e.newSubplotName,onClick:e.addSubplot},{default:O(()=>[R("+")]),_:1},8,["disabled","onClick"]),e.selSubPlot&&e.selSubPlot!="main_plot"?(D(),j(u,{key:0,onClick:e.delSubplot},{default:O(()=>[R("-")]),_:1},8,["onClick"])):E("",!0)]),_:1})]),_:1})]),_:1}),Ns,M("div",null,[P(s,{label:"Used indicators","label-for":"selectedIndicators"},{default:O(()=>[P(l,{id:"selectedIndicators",modelValue:e.selIndicatorName,"onUpdate:modelValue":a[3]||(a[3]=p=>e.selIndicatorName=p),options:e.usedColumns,"select-size":4},null,8,["modelValue","options"])]),_:1})]),M("div",null,[P(u,{variant:"primary",title:"Add indicator to plot",size:"sm",disabled:e.addNewIndicator,onClick:a[4]||(a[4]=p=>e.addNewIndicator=!e.addNewIndicator)},{default:O(()=>[R(" Add new indicator ")]),_:1},8,["disabled"]),P(u,{variant:"secondary",title:"Remove indicator to plot",size:"sm",disabled:!e.selIndicatorName,class:"ms-1",onClick:e.removeIndicator},{default:O(()=>[R(" Remove indicator ")]),_:1},8,["disabled","onClick"])]),e.selIndicatorName||e.addNewIndicator?(D(),j(h,{key:0,modelValue:e.selIndicator,"onUpdate:modelValue":a[5]||(a[5]=p=>e.selIndicator=p),class:"mt-1",columns:e.columns,"add-new":e.addNewIndicator},null,8,["modelValue","columns","add-new"])):E("",!0),zs,M("div",null,[P(u,{class:"ms-1",variant:"secondary",size:"sm",onClick:e.loadPlotConfig},{default:O(()=>[R("Load")]),_:1},8,["onClick"]),P(u,{class:"ms-1",variant:"secondary",size:"sm",onClick:e.loadPlotConfigFromStrategy},{default:O(()=>[R(" From strategy ")]),_:1},8,["onClick"]),P(u,{class:"ms-1",variant:"secondary",size:"sm",title:"Load configuration from text box below",onClick:e.resetConfig},{default:O(()=>[R("Reset")]),_:1},8,["onClick"]),P(u,{id:"showButton",class:"ms-1",variant:"secondary",size:"sm",title:"Show configuration for easy transfer to a strategy",onClick:a[6]||(a[6]=p=>e.showConfig=!e.showConfig)},{default:O(()=>[R("Show")]),_:1}),e.showConfig?(D(),j(u,{key:0,class:"ms-1",variant:"secondary",size:"sm",title:"Load configuration from text box below",onClick:e.loadConfigFromString},{default:O(()=>[R("Load from String")]),_:1},8,["onClick"])):E("",!0),P(u,{class:"ms-1",variant:"primary",size:"sm","data-toggle":"tooltip",title:"Save configuration",onClick:e.savePlotConfig},{default:O(()=>[R("Save")]),_:1},8,["onClick"])]),e.showConfig?(D(),L("div",Vs,[P(f,{id:"TextArea",modelValue:e.plotConfigJson,"onUpdate:modelValue":a[7]||(a[7]=p=>e.plotConfigJson=p),class:"textArea",size:"sm",state:e.tempPlotConfigValid},null,8,["modelValue","state"])])):E("",!0)])):E("",!0)}var Rs=Be(ks,[["render",$s],["__scopeId","data-v-446b3592"]]),Es=Object.defineProperty,Fs=Object.defineProperties,Ws=Object.getOwnPropertyDescriptors,Aa=Object.getOwnPropertySymbols,Zs=Object.prototype.hasOwnProperty,Us=Object.prototype.propertyIsEnumerable,Pa=(e,a,t)=>a in e?Es(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,ve=(e,a)=>{for(var t in a||(a={}))Zs.call(a,t)&&Pa(e,t,a[t]);if(Aa)for(var t of Aa(a))Us.call(a,t)&&Pa(e,t,a[t]);return e},Ta=(e,a)=>Fs(e,Ws(a));const Gs={props:{autoscroll:{type:Boolean,default:!0}},watch:{typeAheadPointer(){this.autoscroll&&this.maybeAdjustScroll()},open(e){this.autoscroll&&e&&this.$nextTick(()=>this.maybeAdjustScroll())}},methods:{maybeAdjustScroll(){var e;const a=((e=this.$refs.dropdownMenu)==null?void 0:e.children[this.typeAheadPointer])||!1;if(a){const t=this.getDropdownViewport(),{top:o,bottom:n,height:r}=a.getBoundingClientRect();if(o<t.top)return this.$refs.dropdownMenu.scrollTop=a.offsetTop;if(n>t.bottom)return this.$refs.dropdownMenu.scrollTop=a.offsetTop-(t.height-r)}},getDropdownViewport(){return this.$refs.dropdownMenu?this.$refs.dropdownMenu.getBoundingClientRect():{height:0,top:0,bottom:0}}}},Hs={data(){return{typeAheadPointer:-1}},watch:{filteredOptions(){for(let e=0;e<this.filteredOptions.length;e++)if(this.selectable(this.filteredOptions[e])){this.typeAheadPointer=e;break}},open(e){e&&this.typeAheadToLastSelected()},selectedValue(){this.open&&this.typeAheadToLastSelected()}},methods:{typeAheadUp(){for(let e=this.typeAheadPointer-1;e>=0;e--)if(this.selectable(this.filteredOptions[e])){this.typeAheadPointer=e;break}},typeAheadDown(){for(let e=this.typeAheadPointer+1;e<this.filteredOptions.length;e++)if(this.selectable(this.filteredOptions[e])){this.typeAheadPointer=e;break}},typeAheadSelect(){const e=this.filteredOptions[this.typeAheadPointer];e&&this.selectable(e)&&this.select(e)},typeAheadToLastSelected(){this.typeAheadPointer=this.selectedValue.length!==0?this.filteredOptions.indexOf(this.selectedValue[this.selectedValue.length-1]):-1}}},js={props:{loading:{type:Boolean,default:!1}},data(){return{mutableLoading:!1}},watch:{search(){this.$emit("search",this.search,this.toggleLoading)},loading(e){this.mutableLoading=e}},methods:{toggleLoading(e=null){return e==null?this.mutableLoading=!this.mutableLoading:this.mutableLoading=e}}},Nt=(e,a)=>{const t=e.__vccOpts||e;for(const[o,n]of a)t[o]=n;return t},Ys={},qs={xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10"},Ks=M("path",{d:"M6.895455 5l2.842897-2.842898c.348864-.348863.348864-.914488 0-1.263636L9.106534.261648c-.348864-.348864-.914489-.348864-1.263636 0L5 3.104545 2.157102.261648c-.348863-.348864-.914488-.348864-1.263636 0L.261648.893466c-.348864.348864-.348864.914489 0 1.263636L3.104545 5 .261648 7.842898c-.348864.348863-.348864.914488 0 1.263636l.631818.631818c.348864.348864.914773.348864 1.263636 0L5 6.895455l2.842898 2.842897c.348863.348864.914772.348864 1.263636 0l.631818-.631818c.348864-.348864.348864-.914489 0-1.263636L6.895455 5z"},null,-1),Xs=[Ks];function Js(e,a){return D(),L("svg",qs,Xs)}const Qs=Nt(Ys,[["render",Js]]),el={},tl={xmlns:"http://www.w3.org/2000/svg",width:"14",height:"10"},al=M("path",{d:"M9.211364 7.59931l4.48338-4.867229c.407008-.441854.407008-1.158247 0-1.60046l-.73712-.80023c-.407008-.441854-1.066904-.441854-1.474243 0L7 5.198617 2.51662.33139c-.407008-.441853-1.066904-.441853-1.474243 0l-.737121.80023c-.407008.441854-.407008 1.158248 0 1.600461l4.48338 4.867228L7 10l2.211364-2.40069z"},null,-1),ol=[al];function nl(e,a){return D(),L("svg",tl,ol)}const rl=Nt(el,[["render",nl]]),Da={Deselect:Qs,OpenIndicator:rl},il={mounted(e,{instance:a}){if(a.appendToBody){const{height:t,top:o,left:n,width:r}=a.$refs.toggle.getBoundingClientRect();let i=window.scrollX||window.pageXOffset,s=window.scrollY||window.pageYOffset;e.unbindPosition=a.calculatePosition(e,a,{width:r+"px",left:i+n+"px",top:s+o+t+"px"}),document.body.appendChild(e)}},unmounted(e,{instance:a}){a.appendToBody&&(e.unbindPosition&&typeof e.unbindPosition=="function"&&e.unbindPosition(),e.parentNode&&e.parentNode.removeChild(e))}};function sl(e){const a={};return Object.keys(e).sort().forEach(t=>{a[t]=e[t]}),JSON.stringify(a)}let ll=0;function ul(){return++ll}const dl={components:ve({},Da),directives:{appendToBody:il},mixins:[Gs,Hs,js],compatConfig:{MODE:3},emits:["open","close","update:modelValue","search","search:compositionstart","search:compositionend","search:keydown","search:blur","search:focus","search:input","option:created","option:selecting","option:selected","option:deselecting","option:deselected"],props:{modelValue:{},components:{type:Object,default:()=>({})},options:{type:Array,default(){return[]}},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},deselectFromDropdown:{type:Boolean,default:!1},searchable:{type:Boolean,default:!0},multiple:{type:Boolean,default:!1},placeholder:{type:String,default:""},transition:{type:String,default:"vs__fade"},clearSearchOnSelect:{type:Boolean,default:!0},closeOnSelect:{type:Boolean,default:!0},label:{type:String,default:"label"},autocomplete:{type:String,default:"off"},reduce:{type:Function,default:e=>e},selectable:{type:Function,default:e=>!0},getOptionLabel:{type:Function,default(e){return typeof e=="object"?e.hasOwnProperty(this.label)?e[this.label]:console.warn(`[vue-select warn]: Label key "option.${this.label}" does not exist in options object ${JSON.stringify(e)}.
https://vue-select.org/api/props.html#getoptionlabel`):e}},getOptionKey:{type:Function,default(e){if(typeof e!="object")return e;try{return e.hasOwnProperty("id")?e.id:sl(e)}catch(a){return console.warn(`[vue-select warn]: Could not stringify this option to generate unique key. Please provide'getOptionKey' prop to return a unique key for each option.
https://vue-select.org/api/props.html#getoptionkey`,e,a)}}},onTab:{type:Function,default:function(){this.selectOnTab&&!this.isComposing&&this.typeAheadSelect()}},taggable:{type:Boolean,default:!1},tabindex:{type:Number,default:null},pushTags:{type:Boolean,default:!1},filterable:{type:Boolean,default:!0},filterBy:{type:Function,default(e,a,t){return(a||"").toLocaleLowerCase().indexOf(t.toLocaleLowerCase())>-1}},filter:{type:Function,default(e,a){return e.filter(t=>{let o=this.getOptionLabel(t);return typeof o=="number"&&(o=o.toString()),this.filterBy(t,o,a)})}},createOption:{type:Function,default(e){return typeof this.optionList[0]=="object"?{[this.label]:e}:e}},resetOnOptionsChange:{default:!1,validator:e=>["function","boolean"].includes(typeof e)},clearSearchOnBlur:{type:Function,default:function({clearSearchOnSelect:e,multiple:a}){return e&&!a}},noDrop:{type:Boolean,default:!1},inputId:{type:String},dir:{type:String,default:"auto"},selectOnTab:{type:Boolean,default:!1},selectOnKeyCodes:{type:Array,default:()=>[13]},searchInputQuerySelector:{type:String,default:"[type=search]"},mapKeydown:{type:Function,default:(e,a)=>e},appendToBody:{type:Boolean,default:!1},calculatePosition:{type:Function,default(e,a,{width:t,top:o,left:n}){e.style.top=o,e.style.left=n,e.style.width=t}},dropdownShouldOpen:{type:Function,default({noDrop:e,open:a,mutableLoading:t}){return e?!1:a&&!t}},uid:{type:[String,Number],default:()=>ul()}},data(){return{search:"",open:!1,isComposing:!1,pushedTags:[],_value:[],deselectButtons:[]}},computed:{isReducingValues(){return this.$props.reduce!==this.$options.props.reduce.default},isTrackingValues(){return typeof this.modelValue=="undefined"||this.isReducingValues},selectedValue(){let e=this.modelValue;return this.isTrackingValues&&(e=this.$data._value),e!=null&&e!==""?[].concat(e):[]},optionList(){return this.options.concat(this.pushTags?this.pushedTags:[])},searchEl(){return this.$slots.search?this.$refs.selectedOptions.querySelector(this.searchInputQuerySelector):this.$refs.search},scope(){const e={search:this.search,loading:this.loading,searching:this.searching,filteredOptions:this.filteredOptions};return{search:{attributes:ve({disabled:this.disabled,placeholder:this.searchPlaceholder,tabindex:this.tabindex,readonly:!this.searchable,id:this.inputId,"aria-autocomplete":"list","aria-labelledby":`vs${this.uid}__combobox`,"aria-controls":`vs${this.uid}__listbox`,ref:"search",type:"search",autocomplete:this.autocomplete,value:this.search},this.dropdownOpen&&this.filteredOptions[this.typeAheadPointer]?{"aria-activedescendant":`vs${this.uid}__option-${this.typeAheadPointer}`}:{}),events:{compositionstart:()=>this.isComposing=!0,compositionend:()=>this.isComposing=!1,keydown:this.onSearchKeyDown,blur:this.onSearchBlur,focus:this.onSearchFocus,input:a=>this.search=a.target.value}},spinner:{loading:this.mutableLoading},noOptions:{search:this.search,loading:this.mutableLoading,searching:this.searching},openIndicator:{attributes:{ref:"openIndicator",role:"presentation",class:"vs__open-indicator"}},listHeader:e,listFooter:e,header:Ta(ve({},e),{deselect:this.deselect}),footer:Ta(ve({},e),{deselect:this.deselect})}},childComponents(){return ve(ve({},Da),this.components)},stateClasses(){return{"vs--open":this.dropdownOpen,"vs--single":!this.multiple,"vs--multiple":this.multiple,"vs--searching":this.searching&&!this.noDrop,"vs--searchable":this.searchable&&!this.noDrop,"vs--unsearchable":!this.searchable,"vs--loading":this.mutableLoading,"vs--disabled":this.disabled}},searching(){return!!this.search},dropdownOpen(){return this.dropdownShouldOpen(this)},searchPlaceholder(){return this.isValueEmpty&&this.placeholder?this.placeholder:void 0},filteredOptions(){const e=[].concat(this.optionList);if(!this.filterable&&!this.taggable)return e;const a=this.search.length?this.filter(e,this.search,this):e;if(this.taggable&&this.search.length){const t=this.createOption(this.search);this.optionExists(t)||a.unshift(t)}return a},isValueEmpty(){return this.selectedValue.length===0},showClearButton(){return!this.multiple&&this.clearable&&!this.open&&!this.isValueEmpty}},watch:{options(e,a){const t=()=>typeof this.resetOnOptionsChange=="function"?this.resetOnOptionsChange(e,a,this.selectedValue):this.resetOnOptionsChange;!this.taggable&&t()&&this.clearSelection(),this.modelValue&&this.isTrackingValues&&this.setInternalValueFromOptions(this.modelValue)},modelValue:{immediate:!0,handler(e){this.isTrackingValues&&this.setInternalValueFromOptions(e)}},multiple(){this.clearSelection()},open(e){this.$emit(e?"open":"close")}},created(){this.mutableLoading=this.loading},methods:{setInternalValueFromOptions(e){Array.isArray(e)?this.$data._value=e.map(a=>this.findOptionFromReducedValue(a)):this.$data._value=this.findOptionFromReducedValue(e)},select(e){this.$emit("option:selecting",e),this.isOptionSelected(e)?this.deselectFromDropdown&&(this.clearable||this.multiple&&this.selectedValue.length>1)&&this.deselect(e):(this.taggable&&!this.optionExists(e)&&(this.$emit("option:created",e),this.pushTag(e)),this.multiple&&(e=this.selectedValue.concat(e)),this.updateValue(e),this.$emit("option:selected",e)),this.onAfterSelect(e)},deselect(e){this.$emit("option:deselecting",e),this.updateValue(this.selectedValue.filter(a=>!this.optionComparator(a,e))),this.$emit("option:deselected",e)},clearSelection(){this.updateValue(this.multiple?[]:null)},onAfterSelect(e){this.closeOnSelect&&(this.open=!this.open,this.searchEl.blur()),this.clearSearchOnSelect&&(this.search="")},updateValue(e){typeof this.modelValue=="undefined"&&(this.$data._value=e),e!==null&&(Array.isArray(e)?e=e.map(a=>this.reduce(a)):e=this.reduce(e)),this.$emit("update:modelValue",e)},toggleDropdown(e){const a=e.target!==this.searchEl;a&&e.preventDefault();const t=[...this.deselectButtons||[],this.$refs.clearButton];if(this.searchEl===void 0||t.filter(Boolean).some(o=>o.contains(e.target)||o===e.target)){e.preventDefault();return}this.open&&a?this.searchEl.blur():this.disabled||(this.open=!0,this.searchEl.focus())},isOptionSelected(e){return this.selectedValue.some(a=>this.optionComparator(a,e))},isOptionDeselectable(e){return this.isOptionSelected(e)&&this.deselectFromDropdown},optionComparator(e,a){return this.getOptionKey(e)===this.getOptionKey(a)},findOptionFromReducedValue(e){const a=o=>JSON.stringify(this.reduce(o))===JSON.stringify(e),t=[...this.options,...this.pushedTags].filter(a);return t.length===1?t[0]:t.find(o=>this.optionComparator(o,this.$data._value))||e},closeSearchOptions(){this.open=!1,this.$emit("search:blur")},maybeDeleteValue(){if(!this.searchEl.value.length&&this.selectedValue&&this.selectedValue.length&&this.clearable){let e=null;this.multiple&&(e=[...this.selectedValue.slice(0,this.selectedValue.length-1)]),this.updateValue(e)}},optionExists(e){return this.optionList.some(a=>this.optionComparator(a,e))},normalizeOptionForSlot(e){return typeof e=="object"?e:{[this.label]:e}},pushTag(e){this.pushedTags.push(e)},onEscape(){this.search.length?this.search="":this.searchEl.blur()},onSearchBlur(){if(this.mousedown&&!this.searching)this.mousedown=!1;else{const{clearSearchOnSelect:e,multiple:a}=this;this.clearSearchOnBlur({clearSearchOnSelect:e,multiple:a})&&(this.search=""),this.closeSearchOptions();return}if(this.search.length===0&&this.options.length===0){this.closeSearchOptions();return}},onSearchFocus(){this.open=!0,this.$emit("search:focus")},onMousedown(){this.mousedown=!0},onMouseUp(){this.mousedown=!1},onSearchKeyDown(e){const a=n=>(n.preventDefault(),!this.isComposing&&this.typeAheadSelect()),t={8:n=>this.maybeDeleteValue(),9:n=>this.onTab(),27:n=>this.onEscape(),38:n=>(n.preventDefault(),this.typeAheadUp()),40:n=>(n.preventDefault(),this.typeAheadDown())};this.selectOnKeyCodes.forEach(n=>t[n]=a);const o=this.mapKeydown(t,this);if(typeof o[e.keyCode]=="function")return o[e.keyCode](e)}}},cl=["dir"],hl=["id","aria-expanded","aria-owns"],pl={ref:"selectedOptions",class:"vs__selected-options"},fl=["disabled","title","aria-label","onClick"],gl={ref:"actions",class:"vs__actions"},vl=["disabled"],ml={class:"vs__spinner"},yl=["id"],bl=["id","aria-selected","onMouseover","onClick"],_l={key:0,class:"vs__no-options"},Cl=R(" Sorry, no matching options. "),Sl=["id"];function xl(e,a,t,o,n,r){const i=xo("append-to-body");return D(),L("div",{dir:t.dir,class:Et(["v-select",r.stateClasses])},[K(e.$slots,"header",X(te(r.scope.header))),M("div",{id:`vs${t.uid}__combobox`,ref:"toggle",class:"vs__dropdown-toggle",role:"combobox","aria-expanded":r.dropdownOpen.toString(),"aria-owns":`vs${t.uid}__listbox`,"aria-label":"Search for option",onMousedown:a[1]||(a[1]=s=>r.toggleDropdown(s))},[M("div",pl,[(D(!0),L(Vt,null,$t(r.selectedValue,(s,l)=>K(e.$slots,"selected-option-container",{option:r.normalizeOptionForSlot(s),deselect:r.deselect,multiple:t.multiple,disabled:t.disabled},()=>[(D(),L("span",{key:t.getOptionKey(s),class:"vs__selected"},[K(e.$slots,"selected-option",X(te(r.normalizeOptionForSlot(s))),()=>[R(ae(t.getOptionLabel(s)),1)]),t.multiple?(D(),L("button",{key:0,ref_for:!0,ref:u=>n.deselectButtons[l]=u,disabled:t.disabled,type:"button",class:"vs__deselect",title:`Deselect ${t.getOptionLabel(s)}`,"aria-label":`Deselect ${t.getOptionLabel(s)}`,onClick:u=>r.deselect(s)},[(D(),j(je(r.childComponents.Deselect)))],8,fl)):E("",!0)]))])),256)),K(e.$slots,"search",X(te(r.scope.search)),()=>[M("input",it({class:"vs__search"},r.scope.search.attributes,wo(r.scope.search.events)),null,16)])],512),M("div",gl,[$e(M("button",{ref:"clearButton",disabled:t.disabled,type:"button",class:"vs__clear",title:"Clear Selected","aria-label":"Clear Selected",onClick:a[0]||(a[0]=(...s)=>r.clearSelection&&r.clearSelection(...s))},[(D(),j(je(r.childComponents.Deselect)))],8,vl),[[st,r.showClearButton]]),K(e.$slots,"open-indicator",X(te(r.scope.openIndicator)),()=>[t.noDrop?E("",!0):(D(),j(je(r.childComponents.OpenIndicator),X(it({key:0},r.scope.openIndicator.attributes)),null,16))]),K(e.$slots,"spinner",X(te(r.scope.spinner)),()=>[$e(M("div",ml,"Loading...",512),[[st,e.mutableLoading]])])],512)],40,hl),P(Ma,{name:t.transition},{default:O(()=>[r.dropdownOpen?$e((D(),L("ul",{id:`vs${t.uid}__listbox`,ref:"dropdownMenu",key:`vs${t.uid}__listbox`,class:"vs__dropdown-menu",role:"listbox",tabindex:"-1",onMousedown:a[2]||(a[2]=Rt((...s)=>r.onMousedown&&r.onMousedown(...s),["prevent"])),onMouseup:a[3]||(a[3]=(...s)=>r.onMouseUp&&r.onMouseUp(...s))},[K(e.$slots,"list-header",X(te(r.scope.listHeader))),(D(!0),L(Vt,null,$t(r.filteredOptions,(s,l)=>(D(),L("li",{id:`vs${t.uid}__option-${l}`,key:t.getOptionKey(s),role:"option",class:Et(["vs__dropdown-option",{"vs__dropdown-option--deselect":r.isOptionDeselectable(s)&&l===e.typeAheadPointer,"vs__dropdown-option--selected":r.isOptionSelected(s),"vs__dropdown-option--highlight":l===e.typeAheadPointer,"vs__dropdown-option--disabled":!t.selectable(s)}]),"aria-selected":l===e.typeAheadPointer?!0:null,onMouseover:u=>t.selectable(s)?e.typeAheadPointer=l:null,onClick:Rt(u=>t.selectable(s)?r.select(s):null,["prevent","stop"])},[K(e.$slots,"option",X(te(r.normalizeOptionForSlot(s))),()=>[R(ae(t.getOptionLabel(s)),1)])],42,bl))),128)),r.filteredOptions.length===0?(D(),L("li",_l,[K(e.$slots,"no-options",X(te(r.scope.noOptions)),()=>[Cl])])):E("",!0),K(e.$slots,"list-footer",X(te(r.scope.listFooter)))],40,yl)),[[i]]):(D(),L("ul",{key:1,id:`vs${t.uid}__listbox`,role:"listbox",style:{display:"none",visibility:"hidden"}},null,8,Sl))]),_:3},8,["name"]),K(e.$slots,"footer",X(te(r.scope.footer)))],10,cl)}const wl=Nt(dl,[["render",xl]]);const Al=Ue({name:"CandleChartContainer",components:{CandleChart:fs,PlotConfigurator:Rs,vSelect:wl},props:{trades:{required:!1,default:()=>[],type:Array},availablePairs:{required:!0,type:Array},timeframe:{required:!0,type:String},historicView:{required:!1,default:!1,type:Boolean},plotConfigModal:{required:!1,default:!0,type:Boolean},timerange:{required:!1,default:"",type:String},strategy:{required:!1,default:"",type:String},sliderPosition:{required:!1,type:Object,default:()=>{}}},setup(e){const a=Ao(),t=La(),o=yo(),n=z(""),r=z(e.plotConfigModal),i=$(()=>{var g,v;return e.historicView?(g=t.activeBot.history[`${n.value}__${e.timeframe}`])==null?void 0:g.data:(v=t.activeBot.candleData[`${n.value}__${e.timeframe}`])==null?void 0:v.data}),s=$(()=>{var g;return e.strategy||((g=i.value)==null?void 0:g.strategy)||""}),l=$(()=>i.value?i.value.columns:[]),u=$(()=>!!i.value),d=$(()=>e.historicView?t.activeBot.historyStatus===Te.loading:t.activeBot.candleDataStatus===Te.loading),c=$(()=>{switch(e.historicView?t.activeBot.historyStatus:t.activeBot.candleDataStatus){case Te.loading:return"Loading...";case Te.success:return"No data available";case Te.error:return"Failed to load data";default:return"Unknown"}}),h=z(!1),f=()=>{e.plotConfigModal?h.value=!h.value:r.value=!r.value},p=()=>{console.log("refresh",n.value,e.timeframe),n.value&&e.timeframe&&(e.historicView?t.activeBot.getPairHistory({pair:n.value,timeframe:e.timeframe,timerange:e.timerange,strategy:e.strategy}):t.activeBot.getPairCandles({pair:n.value,timeframe:e.timeframe,limit:500}))};return ie(()=>e.availablePairs,()=>{e.availablePairs.find(g=>g===n.value)||([n.value]=e.availablePairs,p())}),ie(()=>t.activeBot.selectedPair,()=>{n.value=t.activeBot.selectedPair,p()}),yt(()=>{t.activeBot.selectedPair?n.value=t.activeBot.selectedPair:e.availablePairs.length>0&&([n.value]=e.availablePairs),o.plotConfigChanged(),u||p()}),{botStore:t,settingsStore:a,plotStore:o,history,dataset:i,strategyName:s,datasetColumns:l,isLoadingDataset:d,noDatasetText:c,hasDataset:u,showPlotConfig:r,showConfigurator:f,refresh:p,pair:n,showPlotConfigModal:h}}}),Pl={class:"d-flex h-100"},Tl={class:"flex-fill w-100 flex-column align-items-stretch d-flex h-100"},Dl={class:"d-flex me-0"},Il={class:"ms-2 d-flex flex-wrap flex-md-nowrap align-items-center w-auto"},Ol={class:"ms-2 text-nowrap"},kl={key:0,class:"ms-2 text-nowrap",title:"Long entry signals"},Ll={key:1,class:"ms-2 text-nowrap",title:"Long exit signals"},Ml={key:2,class:"ms-2 text-nowrap"},Bl={key:3,class:"ms-2 text-nowrap"},Nl={class:"ms-auto d-flex align-items-center w-auto"},zl={class:"ms-2"},Vl={class:"ms-2 me-0 me-md-1"},$l={class:"me-1 ms-1 h-100"},Rl={key:1,class:"m-auto"},El={key:1,style:{"font-size":"1.5rem"}},Fl={key:0,class:"w-25 config-sidebar"};function Wl(e,a,t,o,n,r){const i=B("v-select"),s=B("b-button"),l=B("b-form-checkbox"),u=B("b-form-select"),d=B("CandleChart"),c=B("b-spinner"),h=B("PlotConfigurator"),f=B("b-modal");return D(),L("div",Pl,[M("div",Tl,[M("div",Dl,[M("div",Il,[M("span",Ol,ae(e.strategyName)+" | "+ae(e.timeframe||""),1),P(i,{modelValue:e.pair,"onUpdate:modelValue":a[0]||(a[0]=p=>e.pair=p),class:"ms-2",options:e.availablePairs,style:{"min-width":"7em"},size:"sm",clearable:!1,onInput:e.refresh},null,8,["modelValue","options","onInput"]),P(s,{class:"ms-2",disabled:!e.pair,size:"sm",onClick:e.refresh},{default:O(()=>[R("\u21BB")]),_:1},8,["disabled","onClick"]),e.dataset?(D(),L("small",kl,"Long signals: "+ae(e.dataset.enter_long_signals||e.dataset.buy_signals),1)):E("",!0),e.dataset?(D(),L("small",Ll,"Long exit: "+ae(e.dataset.exit_long_signals||e.dataset.sell_signals),1)):E("",!0),e.dataset&&e.dataset.enter_short_signals?(D(),L("small",Ml,"Short entries: "+ae(e.dataset.enter_short_signals),1)):E("",!0),e.dataset&&e.dataset.exit_short_signals?(D(),L("small",Bl,"Short exits: "+ae(e.dataset.exit_short_signals),1)):E("",!0)]),M("div",Nl,[P(l,{modelValue:e.settingsStore.useHeikinAshiCandles,"onUpdate:modelValue":a[1]||(a[1]=p=>e.settingsStore.useHeikinAshiCandles=p)},{default:O(()=>[R("Heikin Ashi")]),_:1},8,["modelValue"]),M("div",zl,[P(u,{modelValue:e.plotStore.plotConfigName,"onUpdate:modelValue":a[2]||(a[2]=p=>e.plotStore.plotConfigName=p),options:e.plotStore.availablePlotConfigNames,size:"sm",onChange:e.plotStore.plotConfigChanged},null,8,["modelValue","options","onChange"])]),M("div",Vl,[P(s,{size:"sm",title:"Plot configurator",onClick:e.showConfigurator},{default:O(()=>[R(" \u2699 ")]),_:1},8,["onClick"])])])]),M("div",$l,[e.hasDataset?(D(),j(d,{key:0,dataset:e.dataset,trades:e.trades,"plot-config":e.plotStore.plotConfig,"heikin-ashi":e.settingsStore.useHeikinAshiCandles,"use-u-t-c":e.settingsStore.timezone==="UTC",theme:e.settingsStore.chartTheme,"slider-position":e.sliderPosition},null,8,["dataset","trades","plot-config","heikin-ashi","use-u-t-c","theme","slider-position"])):(D(),L("div",Rl,[e.isLoadingDataset?(D(),j(c,{key:0,label:"Spinning"})):(D(),L("div",El,ae(e.noDatasetText),1))]))])]),P(Ma,{name:"fade",mode:"in-out"},{default:O(()=>[e.plotConfigModal?E("",!0):$e((D(),L("div",Fl,[P(h,{columns:e.datasetColumns,"as-modal":!1},null,8,["columns"])],512)),[[st,e.showPlotConfig]])]),_:1}),e.plotConfigModal?(D(),j(f,{key:0,id:"plotConfiguratorModal",modelValue:e.showPlotConfigModal,"onUpdate:modelValue":a[3]||(a[3]=p=>e.showPlotConfigModal=p),title:"Plot Configurator","ok-only":"","hide-backdrop":""},{default:O(()=>[P(h,{columns:e.datasetColumns},null,8,["columns"])]),_:1},8,["modelValue"])):E("",!0)])}var jl=Be(Al,[["render",Wl],["__scopeId","data-v-faea7c82"]]);export{jl as C};
//# sourceMappingURL=CandleChartContainer.77b96081.js.map
