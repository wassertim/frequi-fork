import{aJ as f,u as b,aI as g,aE as y,aF as C,aG as v,aH as $}from"./install-10b53263.js";import{d as T,an as x,i as p,g as w,c as R,a as D,j as P,h as k,b as L,w as z,L as G,n as d,o as u,A as N}from"./index-a26190e4.js";import{j as O,e as S,l as I,k as B,g as M,h as V}from"./chartZoom-16ae2117.js";function j(t,a){const n=Math.min(...t),r=(Math.max(...t)-n)*1.01/a,e=[...Array(a).keys()].map(o=>[Math.round((n+o*r)*1e3)/1e3,0]);for(let o=0;o<t.length;o++){const l=Math.min(Math.floor((t[o]-n)/r),a-1);isNaN(l)||e[l][1]++}return e}b([O,g,y,S,C,v,$]);const h="Trade count",F=T({name:"ProfitDistributionChart",components:{"v-chart":f},props:{trades:{required:!0,type:Array},showTitle:{default:!0,type:Boolean}},setup(t){const a=x(),n=[10,15,20,25,50],c=p(()=>{const e=t.trades.map(o=>o.profit_ratio);return j(e,a.profitDistributionBins)}),r=p(()=>({title:{text:"Profit distribution",show:t.showTitle},backgroundColor:"rgba(0, 0, 0, 0)",dataset:{source:c.value},tooltip:{trigger:"axis",axisPointer:{type:"line",label:{backgroundColor:"#6a7985"}}},legend:{data:[h],right:"5%"},xAxis:{type:"category",name:"Profit %",nameLocation:"middle",nameGap:25},yAxis:[{type:"value",name:h,splitLine:{show:!1},nameRotate:90,nameLocation:"middle",nameGap:35,position:"left"}],series:[{type:"bar",name:h,animation:!0,encode:{x:"x0",y:"y0"}}]}));return{settingsStore:a,chartOptions:r,binOptions:n}}});const H={class:"d-flex flex-column h-100 position-relative"},q={class:"flex-grow-1 order-2"};function Z(t,a,n,c,r,e){const o=d("v-chart"),l=d("b-form-select"),i=d("b-form-group");return u(),R("div",H,[D("div",q,[t.trades?(u(),P(o,{key:0,option:t.chartOptions,autoresize:"",theme:t.settingsStore.chartTheme},null,8,["option","theme"])):k("",!0)]),L(i,{class:G(["w-25 order-1",t.showTitle?"ms-5 ps-5":"position-absolute"]),label:"Bins","label-for":"input-bins","label-cols":"6","content-cols":"6",size:"sm"},{default:z(()=>[L(l,{id:"input-bins",modelValue:t.settingsStore.profitDistributionBins,"onUpdate:modelValue":a[0]||(a[0]=m=>t.settingsStore.profitDistributionBins=m),size:"sm",options:t.binOptions},null,8,["modelValue","options"])]),_:1},8,["class"])])}const tt=w(F,[["render",Z],["__scopeId","data-v-4921b3a4"]]);b([O,B,g,y,S,C,v,$]);const _="Profit",E=T({name:"CumProfitChart",components:{"v-chart":f},props:{trades:{required:!0,type:Array},showTitle:{default:!0,type:Boolean},profitColumn:{default:"profit_abs",type:String}},setup(t){const a=x(),n=p(()=>{const r=[],e={},o=t.trades.slice().sort((i,m)=>i.close_timestamp>m.close_timestamp?1:-1);let l=0;for(let i=0,m=o.length;i<m;i+=1){const s=o[i];s.close_timestamp&&s[t.profitColumn]&&(l+=s[t.profitColumn],e[s.close_timestamp]?(e[s.close_timestamp].profit+=s[t.profitColumn],e[s.close_timestamp][s.botId]?e[s.close_timestamp][s.botId]+=s[t.profitColumn]:e[s.close_timestamp][s.botId]=l):e[s.close_timestamp]={profit:l,[s.botId]:l},r.push({date:s.close_timestamp,profit:l,[s.botId]:l}))}return Object.entries(e).map(([i,m])=>({date:parseInt(i,10),profit:m.profit}))}),c=p(()=>({title:{text:"Cumulative Profit",show:t.showTitle},backgroundColor:"rgba(0, 0, 0, 0)",dataset:{dimensions:["date","profit"],source:n.value},tooltip:{trigger:"axis",axisPointer:{type:"line",label:{backgroundColor:"#6a7985"}}},legend:{data:[_],right:"5%"},useUTC:!1,xAxis:{type:"time"},yAxis:[{type:"value",name:_,splitLine:{show:!1},nameRotate:90,nameLocation:"middle",nameGap:40}],grid:{bottom:80},dataZoom:[{type:"inside",start:0,end:100},{bottom:10,start:0,end:100,...I}],series:[{type:"line",name:_,animation:!0,step:"end",lineStyle:{color:a.chartTheme==="dark"?"#c2c2c2":"black"},itemStyle:{color:a.chartTheme==="dark"?"#c2c2c2":"black"}}]}));return{settingsStore:a,cumulativeData:n,chartOptions:c}}});function U(t,a,n,c,r,e){const o=d("v-chart");return t.trades?(u(),P(o,{key:0,option:t.chartOptions,autoresize:"",theme:t.settingsStore.chartTheme},null,8,["option","theme"])):k("",!0)}const et=w(E,[["render",U],["__scopeId","data-v-875b33ce"]]);b([O,B,g,y,S,C,v,$,M,V]);const A="Profit %",J="#9be0a8",K=T({name:"TradesLogChart",components:{"v-chart":f},props:{trades:{required:!0,type:Array},showTitle:{default:!0,type:Boolean}},setup(t){const a=x(),n=p(()=>{const r=[],e=t.trades.slice(0).sort((o,l)=>o.close_timestamp>l.close_timestamp?1:-1);for(let o=0,l=e.length;o<l;o+=1){const i=e[o],m=[o,(i.profit_ratio*100).toFixed(2),i.pair,i.botName,N(i.close_timestamp),i.is_short===void 0||!i.is_short?"Long":"Short"];r.push(m)}return r}),c=p(()=>{const r=n.value.length>0?(1-50/n.value.length)*100:100;return{title:{text:"Trades log",show:t.showTitle},backgroundColor:"rgba(0, 0, 0, 0)",dataset:{dimensions:["date","profit"],source:n.value},tooltip:{trigger:"axis",formatter:e=>{const o=e[0].data[3]?` | ${e[0].data[3]}`:"";return`${e[0].data[2]} | ${e[0].data[5]} ${o}<br>${e[0].data[4]}<br>Profit ${e[0].data[1]} %`},axisPointer:{type:"line",label:{backgroundColor:"#6a7985"}}},xAxis:{type:"value",show:!1},yAxis:[{type:"value",name:A,splitLine:{show:!1},nameRotate:90,nameLocation:"middle",nameGap:30}],grid:{bottom:80},dataZoom:[{type:"inside",start:r,end:100},{bottom:10,start:r,end:100,...I}],visualMap:[{show:!0,seriesIndex:0,pieces:[{max:0,color:"#f84960"},{min:0,color:"#2ed191"}]}],series:[{type:"bar",name:A,barGap:"0%",barCategoryGap:"0%",animation:!1,label:{show:!0,position:"top",rotate:90,offset:[7.5,7.5],formatter:"{@[1]} %",color:a.chartTheme==="dark"?"#c2c2c2":"#3c3c3c"},encode:{x:0,y:1},itemStyle:{color:J}}]}});return{settingsStore:a,chartData:n,chartOptions:c}}});function Q(t,a,n,c,r,e){const o=d("v-chart");return t.trades.length>0?(u(),P(o,{key:0,option:t.chartOptions,autoresize:"",theme:t.settingsStore.chartTheme},null,8,["option","theme"])):k("",!0)}const ot=w(K,[["render",Q],["__scopeId","data-v-ee923c6a"]]);export{et as C,tt as P,ot as T};
//# sourceMappingURL=TradesLog-5e271b1c.js.map
