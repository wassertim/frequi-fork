import{g as P,u as q,r as b,l as z,o as _,c as L,b as n,w as s,a as k,A as ue,v as V,B as N,I as U,N as j,a3 as ce,E as K,x as C,e as $,y as w,j as Z,b1 as W,k as me,b2 as pe,b3 as ve,q as _e,m as M,n as fe,R as be,h as A,L as xe,b4 as ye,_ as ge}from"./index-20bfe6b3.js";import{a as $e,_ as ke}from"./InfoBox.vue_vue_type_script_setup_true_lang-8afe27e2.js";const Te=["onSubmit"],Ve=k("br",null,null,-1),he=P({__name:"ForceExitForm",props:{trade:{type:Object,required:!0},modelValue:{required:!0,default:!1,type:Boolean}},emits:["update:modelValue"],setup(t,{emit:l}){const a=t,p=l,v=q(),h=b(),u=b(void 0),d=b("limit"),f=()=>{var m;return(m=h.value)==null?void 0:m.checkValidity()},r=z({get(){return a.modelValue},set(c){p("update:modelValue",c)}}),B=()=>{if(!f())return;const c={tradeid:String(a.trade.trade_id)};d.value&&(c.ordertype=d.value),u.value&&(c.amount=u.value),v.activeBot.forceexit(c),r.value=!1},x=()=>{var c,m,O,E;u.value=a.trade.amount,d.value=((m=(c=v.activeBot.botState)==null?void 0:c.order_types)==null?void 0:m.force_exit)||((E=(O=v.activeBot.botState)==null?void 0:O.order_types)==null?void 0:E.exit)||"limit"},T=()=>{B()};return(c,m)=>{const O=U,E=j,R=ce,F=K;return _(),L("div",null,[n(F,{id:"forceexit-modal",modelValue:r.value,"onUpdate:modelValue":m[3]||(m[3]=y=>r.value=y),title:"Force exiting a trade",onShow:x,onHidden:x,onOk:T},{default:s(()=>[k("form",{ref_key:"form",ref:h,onSubmit:ue(B,["stop","prevent"])},[k("p",null,[k("span",null,"Exiting Trade #"+V(t.trade.trade_id)+" "+V(t.trade.pair)+".",1),Ve,k("span",null,"Currently owning "+V(t.trade.amount)+" "+V(t.trade.base_currency),1)]),n(E,{label:`*Amount in ${t.trade.base_currency} [optional]`,"label-for":"stake-input","invalid-feedback":"Amount must be empty or a positive number",state:u.value!==void 0&&u.value>0},{default:s(()=>[n(O,{id:"stake-input",modelValue:u.value,"onUpdate:modelValue":m[0]||(m[0]=y=>u.value=y),type:"number",step:"0.000001",onKeydown:N(T,["enter"])},null,8,["modelValue","onKeydown"]),n(O,{id:"stake-input",modelValue:u.value,"onUpdate:modelValue":m[1]||(m[1]=y=>u.value=y),type:"range",step:"0.000001",min:"0",max:t.trade.amount,onKeydown:N(T,["enter"])},null,8,["modelValue","max","onKeydown"])]),_:1},8,["label","state"]),n(E,{label:"*OrderType","label-for":"ordertype-input","invalid-feedback":"OrderType",state:d.value!==void 0},{default:s(()=>[n(R,{modelValue:d.value,"onUpdate:modelValue":m[2]||(m[2]=y=>d.value=y),class:"ms-2",options:["market","limit"],style:{"min-width":"7em"},size:"sm"},null,8,["modelValue"])]),_:1},8,["state"])],40,Te)]),_:1},8,["modelValue"])])}}}),Ce={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},we=k("path",{fill:"currentColor",d:"M10 9a1 1 0 0 1 1-1a1 1 0 0 1 1 1v4.47l1.21.13l4.94 2.19c.53.24.85.77.85 1.35v4.36c-.03.82-.68 1.47-1.5 1.5H11c-.38 0-.74-.15-1-.43l-4.9-4.2l.74-.77c.19-.21.46-.32.74-.32h.22L10 19V9m1-4a4 4 0 0 1 4 4c0 1.5-.8 2.77-2 3.46v-1.22c.61-.55 1-1.35 1-2.24a3 3 0 0 0-3-3a3 3 0 0 0-3 3c0 .89.39 1.69 1 2.24v1.22C7.8 11.77 7 10.5 7 9a4 4 0 0 1 4-4Z"},null,-1),Be=[we];function Ee(t,l){return _(),L("svg",Ce,[...Be])}const Le={name:"mdi-gesture-tap",render:Ee},Oe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ie=k("path",{fill:"currentColor",d:"M2 12c0 5 4 9 9 9c2.4 0 4.7-.9 6.4-2.6l-1.5-1.5c-1.3 1.4-3 2.1-4.9 2.1c-6.2 0-9.4-7.5-4.9-11.9S18 5.8 18 12h-3l4 4h.1l3.9-4h-3c0-5-4-9-9-9s-9 4-9 9m8 3h2v2h-2v-2m0-8h2v6h-2V7"},null,-1),Fe=[Ie];function Se(t,l){return _(),L("svg",Oe,[...Fe])}const Ae={name:"mdi-reload-alert",render:Se},Pe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Re=k("path",{fill:"currentColor",d:"M4 20h14v2H4a2 2 0 0 1-2-2V6h2v14M20.22 2H7.78C6.8 2 6 2.8 6 3.78v12.44C6 17.2 6.8 18 7.78 18h12.44c.98 0 1.78-.8 1.78-1.78V3.78C22 2.8 21.2 2 20.22 2M19 13.6L17.6 15L14 11.4L10.4 15L9 13.6l3.6-3.6L9 6.4L10.4 5L14 8.6L17.6 5L19 6.4L15.4 10l3.6 3.6Z"},null,-1),De=[Re];function He(t,l){return _(),L("svg",Pe,[...De])}const Me={name:"mdi-close-box-multiple",render:He},Ne={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},qe=k("path",{fill:"currentColor",d:"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-3.4 14L12 13.4L8.4 17L7 15.6l3.6-3.6L7 8.4L8.4 7l3.6 3.6L15.6 7L17 8.4L13.4 12l3.6 3.6l-1.4 1.4Z"},null,-1),ze=[qe];function Ue(t,l){return _(),L("svg",Ne,[...ze])}const je={name:"mdi-close-box",render:Ue},Ke={class:"d-flex flex-column"},Ze=P({__name:"TradeActions",props:{botApiVersion:{type:Number,default:1},trade:{type:Object,required:!0}},emits:["forceExit","forceExitPartial","cancelOpenOrder","reloadTrade","deleteTrade"],setup(t){return(l,a)=>{const p=je,v=Z,h=Me,u=W,d=Ae,f=me;return _(),L("div",Ke,[t.botApiVersion<=1.1?(_(),C(v,{key:0,class:"btn-xs text-start",size:"sm",title:"Forceexit",onClick:a[0]||(a[0]=r=>l.$emit("forceExit",t.trade))},{default:s(()=>[n(p,{class:"me-1"}),$("Forceexit ")]),_:1})):w("",!0),t.botApiVersion>1.1?(_(),C(v,{key:1,class:"btn-xs text-start",size:"sm",title:"Forceexit limit",onClick:a[1]||(a[1]=r=>l.$emit("forceExit",t.trade,"limit"))},{default:s(()=>[n(p,{class:"me-1"}),$("Forceexit limit ")]),_:1})):w("",!0),t.botApiVersion>1.1?(_(),C(v,{key:2,class:"btn-xs text-start mt-1",size:"sm",title:"Forceexit market",onClick:a[2]||(a[2]=r=>l.$emit("forceExit",t.trade,"market"))},{default:s(()=>[n(p,{class:"me-1"}),$("Forceexit market ")]),_:1})):w("",!0),t.botApiVersion>2.16?(_(),C(v,{key:3,class:"btn-xs text-start mt-1",size:"sm",title:"Forceexit partial",onClick:a[3]||(a[3]=r=>l.$emit("forceExitPartial",t.trade))},{default:s(()=>[n(h,{class:"me-1"}),$("Forceexit partial ")]),_:1})):w("",!0),t.botApiVersion>=2.24&&(t.trade.open_order_id||t.trade.has_open_orders)?(_(),C(v,{key:4,class:"btn-xs text-start mt-1",size:"sm",title:"Cancel open orders",onClick:a[4]||(a[4]=r=>l.$emit("cancelOpenOrder",t.trade))},{default:s(()=>[n(u,{class:"me-1"}),$("Cancel open order ")]),_:1})):w("",!0),t.botApiVersion>=2.28?(_(),C(v,{key:5,class:"btn-xs text-start mt-1",size:"sm",title:"Reload",onClick:a[5]||(a[5]=r=>l.$emit("reloadTrade",t.trade))},{default:s(()=>[n(d,{class:"me-1"}),$("Reload Trade ")]),_:1})):w("",!0),n(v,{class:"btn-xs text-start mt-1",size:"sm",title:"Delete trade",onClick:a[6]||(a[6]=r=>l.$emit("deleteTrade",t.trade))},{default:s(()=>[n(f,{class:"me-1"}),$(" Delete ")]),_:1})])}}}),We=P({__name:"TradeActionsPopover",props:{trade:{type:Object,required:!0},id:{type:Number,required:!0},botApiVersion:{type:Number,required:!0}},emits:["forceExit","forceExitPartial","cancelOpenOrder","reloadTrade","deleteTrade"],setup(t,{emit:l}){const a=l,p=b(!1);function v(f,r=void 0){p.value=!1,a("forceExit",f,r)}function h(f){p.value=!1,a("forceExitPartial",f)}function u(f){p.value=!1,a("cancelOpenOrder",f)}function d(f){p.value=!1,a("reloadTrade",f)}return(f,r)=>{const B=Le,x=Z,T=W,c=pe;return _(),L("div",null,[n(x,{id:`btn-actions-${t.id}`,class:"btn-xs",size:"sm",title:"Actions",onClick:r[0]||(r[0]=m=>p.value=!p.value)},{default:s(()=>[n(B)]),_:1},8,["id"]),n(c,{container:"body",target:`btn-actions-${t.id}`,title:`Actions for ${t.trade.pair}`,triggers:"manual",show:p.value,placement:"left"},{default:s(()=>[n(Ze,{trade:t.trade,"bot-api-version":t.botApiVersion,onForceExit:v,onForceExitPartial:h,onDeleteTrade:r[1]||(r[1]=m=>{p.value=!1,f.$emit("deleteTrade",t.trade)}),onCancelOpenOrder:u,onReloadTrade:d},null,8,["trade","bot-api-version"]),n(x,{class:"mt-1 w-100 text-start",size:"sm",onClick:r[2]||(r[2]=m=>p.value=!1)},{default:s(()=>[n(T,{class:"me-1"}),$("Close Actions menu ")]),_:1})]),_:1},8,["target","title","show"])])}}}),Ge={class:"h-100 overflow-auto w-100"},Je={class:"w-100 d-flex justify-content-between"},Qe=P({__name:"TradeList",props:{trades:{required:!0,type:Array},title:{default:"Trades",type:String},stakeCurrency:{required:!1,default:"",type:String},activeTrades:{default:!1,type:Boolean},showFilter:{default:!1,type:Boolean},multiBotView:{default:!1,type:Boolean},emptyText:{default:"No Trades to show.",type:String}},setup(t){const l=t,a=q(),p=ve(),v=b(1),h=b(),u=b(""),d=b({}),f=l.activeTrades?200:15,r=b(),B=b(!1),x=b(!1),T=b(""),c=b(null),m=[{key:"actions"}],O=[{key:"close_timestamp",label:"Close date"},{key:"exit_reason",label:"Close Reason"}],E=e=>M(e,a.activeBot.stakeCurrencyDecimals),R=z(()=>l.trades.length),F=b([]);_e(()=>{F.value=[{key:"trade_id",label:"ID"},{key:"pair",label:"Pair"},{key:"amount",label:"Amount"},{key:"stake_amount",label:"Stake amount"},{key:"open_rate",label:"Open rate",formatter:e=>M(e)},{key:l.activeTrades?"current_rate":"close_rate",label:l.activeTrades?"Current rate":"Close rate",formatter:e=>M(e)},{key:"profit",label:l.activeTrades?"Current profit %":"Profit %",formatter:(e,i,g)=>{if(!g)return"";const I=g;return`${fe(I.profit_ratio,2)} ${`(${E(I.profit_abs)})`}`}},{key:"open_timestamp",label:"Open date"},...l.activeTrades?m:O],l.multiBotView&&F.value.unshift({key:"botName",label:"Bot"})});const y=b(void 0),G=(e,i=void 0)=>{d.value=e,c.value=1,T.value=`Really exit trade ${e.trade_id} (Pair ${e.pair}) using ${i} Order?`,x.value=!0,y.value=i},J=()=>{if(c.value===0){const e={tradeid:String(d.value.trade_id),botId:d.value.botId};a.deleteTradeMulti(e).catch(i=>console.log(i.response))}if(c.value===1){const e={tradeid:String(d.value.trade_id),botId:d.value.botId};y.value&&(e.ordertype=y.value),a.forceSellMulti(e).then(i=>console.log(i)).catch(i=>console.log(i.response))}if(c.value===3){const e={tradeid:String(d.value.trade_id),botId:d.value.botId};a.cancelOpenOrderMulti(e)}y.value=void 0,x.value=!1},Q=e=>{T.value=`Really delete trade ${e.trade_id} (Pair ${e.pair})?`,c.value=0,d.value=e,x.value=!0},X=e=>{d.value=e,B.value=!0},Y=e=>{T.value=`Cancel open order for trade ${e.trade_id} (Pair ${e.pair})?`,d.value=e,c.value=3,x.value=!0};function ee(e){a.reloadTradeMulti({tradeid:String(e.trade_id),botId:e.botId})}const te=(e,i,g)=>{l.activeTrades&&(g.preventDefault(),console.log(e))},ae=e=>{l.multiBotView&&a.selectedBot!==e.botId&&a.selectBot(e.botId),e&&e.trade_id!==a.activeBot.detailTradeId?(a.activeBot.setDetailTrade(e),l.multiBotView&&p.push({name:"Freqtrade Trading"})):a.activeBot.setDetailTrade(null)},oe=()=>{var e;if(a.activeBot.detailTradeId){const i=l.trades.findIndex(g=>g.trade_id===a.activeBot.detailTradeId);i>=0?(e=r.value)==null||e.selectRow(i):(console.log(`Unsetting item for tradeid ${h.value}`),h.value=void 0)}};return be(()=>a.activeBot.detailTradeId,e=>{var g;l.trades.findIndex(I=>I.trade_id===e)<0&&((g=r.value)==null||g.clearSelected())}),(e,i)=>{const g=We,I=$e,D=ke,le=xe,ne=ye,re=U,ie=j,de=he,se=K;return _(),L("div",Ge,[n(le,{ref_key:"tradesTable",ref:r,small:"",hover:"",stacked:"md",items:t.trades.filter(o=>{var S,H;return o.pair.toLowerCase().includes(u.value.toLowerCase())||((S=o.exit_reason)==null?void 0:S.toLowerCase().includes(u.value.toLowerCase()))||((H=o.enter_tag)==null?void 0:H.toLowerCase().includes(u.value.toLowerCase()))}),fields:F.value,"show-empty":"","empty-text":t.emptyText,"per-page":A(f),"current-page":v.value,"primary-key":"botTradeId",selectable:"","select-head":!1,"select-mode":"single",onRowContextmenu:te,onRowClicked:ae,onRowSelected:oe},{"cell(actions)":s(({index:o,item:S})=>[n(g,{id:o,trade:S,"bot-api-version":A(a).activeBot.botApiVersion,onDeleteTrade:H=>Q(S),onForceExit:G,onForceExitPartial:X,onCancelOpenOrder:Y,onReloadTrade:ee},null,8,["id","trade","bot-api-version","onDeleteTrade"])]),"cell(pair)":s(o=>[k("span",null,V(`${o.item.pair}${o.item.open_order_id||o.item.has_open_orders?"*":""}`),1)]),"cell(trade_id)":s(o=>[$(V(o.item.trade_id)+" "+V(A(a).activeBot.botApiVersion>2&&o.item.trading_mode!=="spot"?"| "+(o.item.is_short?"Short":"Long"):""),1)]),"cell(stake_amount)":s(o=>[$(V(E(o.item.stake_amount))+" "+V(o.item.trading_mode!=="spot"?`(${o.item.leverage}x)`:""),1)]),"cell(profit)":s(o=>[n(I,{trade:o.item},null,8,["trade"])]),"cell(open_timestamp)":s(o=>[n(D,{date:o.item.open_timestamp},null,8,["date"])]),"cell(close_timestamp)":s(o=>[n(D,{date:o.item.close_timestamp??0},null,8,["date"])]),_:1},8,["items","fields","empty-text","per-page","current-page"]),k("div",Je,[t.activeTrades?w("",!0):(_(),C(ne,{key:0,modelValue:v.value,"onUpdate:modelValue":i[0]||(i[0]=o=>v.value=o),"total-rows":R.value,"per-page":A(f),"aria-controls":"my-table"},null,8,["modelValue","total-rows","per-page"])),t.showFilter?(_(),C(ie,{key:1,"label-for":"trade-filter"},{default:s(()=>[n(re,{id:"trade-filter",modelValue:u.value,"onUpdate:modelValue":i[1]||(i[1]=o=>u.value=o),type:"text",placeholder:"Filter"},null,8,["modelValue"])]),_:1})):w("",!0)]),t.activeTrades?(_(),C(de,{key:0,modelValue:B.value,"onUpdate:modelValue":i[2]||(i[2]=o=>B.value=o),trade:d.value},null,8,["modelValue","trade"])):w("",!0),n(se,{modelValue:x.value,"onUpdate:modelValue":i[3]||(i[3]=o=>x.value=o),title:"Exit trade",onOk:J},{default:s(()=>[$(V(T.value),1)]),_:1},8,["modelValue"])])}}});const et=ge(Qe,[["__scopeId","data-v-5afc8244"]]);export{Me as _,et as a};
//# sourceMappingURL=TradeList-3bbdd605.js.map
