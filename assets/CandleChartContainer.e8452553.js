import{x as Ma,y as wn,d as Ge,i as R,j as E,z as xt,H as ue,_ as Re,I as $t,r as W,o as P,c as z,k as J,h as Z,b as V,t as ie,m as ut,e as T,w as L,l as D,J as An,g as H,p as Ba,f as za,K as Tn,u as Va,s as Et,C as Ft,L as Pn,M as te,N as ae,P as re,Q as Wt,R as Zt,S as qe,U as Dn,V as Ee,W as ct,q as Ut,X as Ht,Y as Na,G as On,Z as Le}from"./index.5e6b3c4a.js";import{_ as N,a2 as Ra,B as Ct,c as St,ab as $e,ac as $a,h as Ea,W as Fa,a4 as wt,u as A,X as se,ad as ce,ae as de,I as K,af as Wa,ag as In,b as Za,ah as Ln,Y as Q,ai as dt,d as Pe,aj as kn,ak as Ua,al as Mn,G as oe,K as we,am as Gt,an as Bn,ao as zn,x as Vn,z as Nn,L as Rn,M as $n,ap as Ha,aq as Be,ar as Ga,as as Ke,at as En,p as Fe,r as ht,au as Fn,av as At,aw as Wn,ax as Zn,ay as he,az as Un,g as ze,Z as Ce,aA as Se,aB as jt,aC as Tt,aD as Hn,F as ja,aE as Gn,aF as jn,aG as Yt,aH as qt,aI as Ya,aJ as Yn,aK as qn,aL as Kn,aM as Xn,aN as Jn,y as Ve,aO as Pt,aP as Qn,aQ as eo,aR as Kt,m as to,C as qa,aS as Ka,aT as ao,aU as no,aV as oo,aW as ro,aX as io,aY as so,aZ as lo,a_ as uo,a$ as co,b0 as Xt,b1 as ho,b2 as Jt,b3 as Xe,J as po,b4 as fo,b5 as vo,b6 as go,b7 as mo,b8 as yo,b9 as _o,ba as bo,bb as xo,a5 as Co,bc as So,a7 as wo,a8 as Ao,a9 as To,aa as Po,a6 as Do}from"./install.6a484433.js";import{c as Oo,p as Xa,S as Io,i as Lo,t as ko,r as Mo,a as Bo,D as zo,b as Vo,d as No,s as Ro,A as $o,e as Eo,f as Fo,g as Wo,h as Zo,j as Uo,k as Ho}from"./install.c51d785f.js";import{c as Go}from"./createSeriesDataSimply.a7ae3a3f.js";var We=(e=>(e.line="line",e.bar="bar",e.scatter="scatter",e))(We||{});const Ue={main_plot:{},subplots:{}};var jo=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t.hasSymbolVisual=!0,t}return a.prototype.getInitialData=function(t,n){return Oo(null,this,{useEncodeDefaulter:!0})},a.prototype.getProgressive=function(){var t=this.option.progressive;return t==null?this.option.large?5e3:this.get("progressive"):t},a.prototype.getProgressiveThreshold=function(){var t=this.option.progressiveThreshold;return t==null?this.option.large?1e4:this.get("progressiveThreshold"):t},a.prototype.brushSelector=function(t,n,o){return o.point(n.getItemLayout(t))},a.prototype.getZLevelKey=function(){return this.getData().count()>this.getProgressiveThreshold()?this.id:""},a.type="series.scatter",a.dependencies=["grid","polar","geo","singleAxis","calendar"],a.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{opacity:.8},emphasis:{scale:!0},clip:!0,select:{itemStyle:{borderColor:"#212121"}},universalTransition:{divideShape:"clone"}},a}(Ra),Yo=jo,Ja=4,qo=function(){function e(){}return e}(),Ko=function(e){N(a,e);function a(t){var n=e.call(this,t)||this;return n._off=0,n.hoverDataIdx=-1,n}return a.prototype.getDefaultShape=function(){return new qo},a.prototype.reset=function(){this.notClear=!1,this._off=0},a.prototype.buildPath=function(t,n){var o=n.points,r=n.size,i=this.symbolProxy,s=i.shape,l=t.getContext?t.getContext():t,u=l&&r[0]<Ja,d=this.softClipShape,c;if(u){this._ctx=l;return}for(this._ctx=null,c=this._off;c<o.length;){var h=o[c++],p=o[c++];isNaN(h)||isNaN(p)||d&&!d.contain(h,p)||(s.x=h-r[0]/2,s.y=p-r[1]/2,s.width=r[0],s.height=r[1],i.buildPath(t,s,!0))}this.incremental&&(this._off=c,this.notClear=!0)},a.prototype.afterBrush=function(){var t=this.shape,n=t.points,o=t.size,r=this._ctx,i=this.softClipShape,s;if(!!r){for(s=this._off;s<n.length;){var l=n[s++],u=n[s++];isNaN(l)||isNaN(u)||i&&!i.contain(l,u)||r.fillRect(l-o[0]/2,u-o[1]/2,o[0],o[1])}this.incremental&&(this._off=s,this.notClear=!0)}},a.prototype.findDataIndex=function(t,n){for(var o=this.shape,r=o.points,i=o.size,s=Math.max(i[0],4),l=Math.max(i[1],4),u=r.length/2-1;u>=0;u--){var d=u*2,c=r[d]-s/2,h=r[d+1]-l/2;if(t>=c&&n>=h&&t<=c+s&&n<=h+l)return u}return-1},a.prototype.contain=function(t,n){var o=this.transformCoordToLocal(t,n),r=this.getBoundingRect();if(t=o[0],n=o[1],r.contain(t,n)){var i=this.hoverDataIdx=this.findDataIndex(t,n);return i>=0}return this.hoverDataIdx=-1,!1},a.prototype.getBoundingRect=function(){var t=this._rect;if(!t){for(var n=this.shape,o=n.points,r=n.size,i=r[0],s=r[1],l=1/0,u=1/0,d=-1/0,c=-1/0,h=0;h<o.length;){var p=o[h++],m=o[h++];l=Math.min(p,l),d=Math.max(p,d),u=Math.min(m,u),c=Math.max(m,c)}t=this._rect=new Ct(l-i/2,u-s/2,d-l+i,c-u+s)}return t},a}(St),Xo=function(){function e(){this.group=new $e}return e.prototype.updateData=function(a,t){this._clear();var n=this._create();n.setShape({points:a.getLayout("points")}),this._setCommon(n,a,t)},e.prototype.updateLayout=function(a){var t=a.getLayout("points");this.group.eachChild(function(n){if(n.startIndex!=null){var o=(n.endIndex-n.startIndex)*2,r=n.startIndex*4*2;t=new Float32Array(t.buffer,r,o)}n.setShape("points",t),n.reset()})},e.prototype.incrementalPrepareUpdate=function(a){this._clear()},e.prototype.incrementalUpdate=function(a,t,n){var o=this._newAdded[0],r=t.getLayout("points"),i=o&&o.shape.points;if(i&&i.length<2e4){var s=i.length,l=new Float32Array(s+r.length);l.set(i),l.set(r,s),o.endIndex=a.end,o.setShape({points:l})}else{this._newAdded=[];var u=this._create();u.startIndex=a.start,u.endIndex=a.end,u.incremental=!0,u.setShape({points:r}),this._setCommon(u,t,n)}},e.prototype.eachRendered=function(a){this._newAdded[0]&&a(this._newAdded[0])},e.prototype._create=function(){var a=new Ko({cursor:"default"});return a.ignoreCoarsePointer=!0,this.group.add(a),this._newAdded.push(a),a},e.prototype._setCommon=function(a,t,n){var o=t.hostModel;n=n||{};var r=t.getVisual("symbolSize");a.setShape("size",r instanceof Array?r:[r,r]),a.softClipShape=n.clipShape||null,a.symbolProxy=$a(t.getVisual("symbol"),0,0,0,0),a.setColor=a.symbolProxy.setColor;var i=a.shape.size[0]<Ja;a.useStyle(o.getModel("itemStyle").getItemStyle(i?["color","shadowBlur","shadowColor"]:["color"]));var s=t.getVisual("style"),l=s&&s.fill;l&&a.setColor(l);var u=Ea(a);u.seriesIndex=o.seriesIndex,a.on("mousemove",function(d){u.dataIndex=null;var c=a.hoverDataIdx;c>=0&&(u.dataIndex=c+(a.startIndex||0))})},e.prototype.remove=function(){this._clear()},e.prototype._clear=function(){this._newAdded=[],this.group.removeAll()},e}(),Jo=Xo,Qo=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.prototype.render=function(t,n,o){var r=t.getData(),i=this._updateSymbolDraw(r,t);i.updateData(r,{clipShape:this._getClipShape(t)}),this._finished=!0},a.prototype.incrementalPrepareRender=function(t,n,o){var r=t.getData(),i=this._updateSymbolDraw(r,t);i.incrementalPrepareUpdate(r),this._finished=!1},a.prototype.incrementalRender=function(t,n,o){this._symbolDraw.incrementalUpdate(t,n.getData(),{clipShape:this._getClipShape(n)}),this._finished=t.end===n.getData().count()},a.prototype.updateTransform=function(t,n,o){var r=t.getData();if(this.group.dirty(),!this._finished||r.count()>1e4)return{update:!0};var i=Xa("").reset(t,n,o);i.progress&&i.progress({start:0,end:r.count(),count:r.count()},r),this._symbolDraw.updateLayout(r)},a.prototype.eachRendered=function(t){this._symbolDraw&&this._symbolDraw.eachRendered(t)},a.prototype._getClipShape=function(t){var n=t.coordinateSystem,o=n&&n.getArea&&n.getArea();return t.get("clip",!0)?o:null},a.prototype._updateSymbolDraw=function(t,n){var o=this._symbolDraw,r=n.pipelineContext,i=r.large;return(!o||i!==this._isLargeDraw)&&(o&&o.remove(),o=this._symbolDraw=i?new Jo:new Io,this._isLargeDraw=i,this.group.removeAll()),this.group.add(o.group),o},a.prototype.remove=function(t,n){this._symbolDraw&&this._symbolDraw.remove(!0),this._symbolDraw=null},a.prototype.dispose=function(){},a.type="scatter",a}(Fa),er=Qo;function tr(e){wt(Lo),e.registerSeriesModel(Yo),e.registerChartView(er),e.registerLayout(Xa("scatter"))}var ar={axisPointer:1,tooltip:1,brush:1};function nr(e,a,t){var n=a.getComponentByElement(e.topTarget),o=n&&n.coordinateSystem;return n&&n!==t&&!ar.hasOwnProperty(n.mainType)&&o&&o.model!==t}var me=!0,Ne=Math.min,Ae=Math.max,or=Math.pow,rr=1e4,ir=6,sr=6,Qt="globalPan",lr={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},ur={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},ea={brushStyle:{lineWidth:2,stroke:"rgba(210,219,238,0.3)",fill:"#D2DBEE"},transformable:!0,brushMode:"single",removeOnClick:!1},cr=0,dr=function(e){N(a,e);function a(t){var n=e.call(this)||this;return n._track=[],n._covers=[],n._handlers={},n._zr=t,n.group=new $e,n._uid="brushController_"+cr++,A(yr,function(o,r){this._handlers[r]=se(o,this)},n),n}return a.prototype.enableBrush=function(t){return this._brushType&&this._doDisableBrush(),t.brushType&&this._doEnableBrush(t),this},a.prototype._doEnableBrush=function(t){var n=this._zr;this._enableGlobalPan||ko(n,Qt,this._uid),A(this._handlers,function(o,r){n.on(r,o)}),this._brushType=t.brushType,this._brushOption=ce(de(ea),t,!0)},a.prototype._doDisableBrush=function(){var t=this._zr;Mo(t,Qt,this._uid),A(this._handlers,function(n,o){t.off(o,n)}),this._brushType=this._brushOption=null},a.prototype.setPanels=function(t){if(t&&t.length){var n=this._panels={};A(t,function(o){n[o.panelId]=de(o)})}else this._panels=null;return this},a.prototype.mount=function(t){t=t||{},this._enableGlobalPan=t.enableGlobalPan;var n=this.group;return this._zr.add(n),n.attr({x:t.x||0,y:t.y||0,rotation:t.rotation||0,scaleX:t.scaleX||1,scaleY:t.scaleY||1}),this._transform=n.getLocalTransform(),this},a.prototype.updateCovers=function(t){t=K(t,function(h){return ce(de(ea),h,!0)});var n="\0-brush-index-",o=this._covers,r=this._covers=[],i=this,s=this._creatingCover;return new Wa(o,t,u,l).add(d).update(d).remove(c).execute(),this;function l(h,p){return(h.id!=null?h.id:n+p)+"-"+h.brushType}function u(h,p){return l(h.__brushOption,p)}function d(h,p){var m=t[h];if(p!=null&&o[p]===s)r[h]=o[p];else{var f=r[h]=p!=null?(o[p].__brushOption=m,o[p]):en(i,Qa(i,m));Dt(i,f)}}function c(h){o[h]!==s&&i.group.remove(o[h])}},a.prototype.unmount=function(){return this.enableBrush(!1),pt(this),this._zr.remove(this.group),this},a.prototype.dispose=function(){this.unmount(),this.off()},a}(In);function Qa(e,a){var t=je[a.brushType].createCover(e,a);return t.__brushOption=a,an(t,a),e.group.add(t),t}function en(e,a){var t=Ot(a);return t.endCreating&&(t.endCreating(e,a),an(a,a.__brushOption)),a}function tn(e,a){var t=a.__brushOption;Ot(a).updateCoverShape(e,a,t.range,t)}function an(e,a){var t=a.z;t==null&&(t=rr),e.traverse(function(n){n.z=t,n.z2=t})}function Dt(e,a){Ot(a).updateCommon(e,a),tn(e,a)}function Ot(e){return je[e.__brushOption.brushType]}function It(e,a,t){var n=e._panels;if(!n)return me;var o,r=e._transform;return A(n,function(i){i.isTargetByCursor(a,t,r)&&(o=i)}),o}function nn(e,a){var t=e._panels;if(!t)return me;var n=a.__brushOption.panelId;return n!=null?t[n]:me}function pt(e){var a=e._covers,t=a.length;return A(a,function(n){e.group.remove(n)},e),a.length=0,!!t}function ye(e,a){var t=K(e._covers,function(n){var o=n.__brushOption,r=de(o.range);return{brushType:o.brushType,panelId:o.panelId,range:r}});e.trigger("brush",{areas:t,isEnd:!!a.isEnd,removeOnClick:!!a.removeOnClick})}function hr(e){var a=e._track;if(!a.length)return!1;var t=a[a.length-1],n=a[0],o=t[0]-n[0],r=t[1]-n[1],i=or(o*o+r*r,.5);return i>ir}function on(e){var a=e.length-1;return a<0&&(a=0),[e[0],e[a]]}function rn(e,a,t,n){var o=new $e;return o.add(new dt({name:"main",style:Lt(t),silent:!0,draggable:!0,cursor:"move",drift:Q(ta,e,a,o,["n","s","w","e"]),ondragend:Q(ye,a,{isEnd:!0})})),A(n,function(r){o.add(new dt({name:r.join(""),style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:Q(ta,e,a,o,r),ondragend:Q(ye,a,{isEnd:!0})}))}),o}function sn(e,a,t,n){var o=n.brushStyle.lineWidth||0,r=Ae(o,sr),i=t[0][0],s=t[1][0],l=i-o/2,u=s-o/2,d=t[0][1],c=t[1][1],h=d-r+o/2,p=c-r+o/2,m=d-i,f=c-s,v=m+o,g=f+o;le(e,a,"main",i,s,m,f),n.transformable&&(le(e,a,"w",l,u,r,g),le(e,a,"e",h,u,r,g),le(e,a,"n",l,u,v,r),le(e,a,"s",l,p,v,r),le(e,a,"nw",l,u,r,r),le(e,a,"ne",h,u,r,r),le(e,a,"sw",l,p,r,r),le(e,a,"se",h,p,r,r))}function ft(e,a){var t=a.__brushOption,n=t.transformable,o=a.childAt(0);o.useStyle(Lt(t)),o.attr({silent:!n,cursor:n?"move":"default"}),A([["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]],function(r){var i=a.childOfName(r.join("")),s=r.length===1?vt(e,r[0]):fr(e,r);i&&i.attr({silent:!n,invisible:!n,cursor:n?ur[s]+"-resize":null})})}function le(e,a,t,n,o,r,i){var s=a.childOfName(t);s&&s.setShape(gr(kt(e,a,[[n,o],[n+r,o+i]])))}function Lt(e){return Pe({strokeNoScale:!0},e.brushStyle)}function ln(e,a,t,n){var o=[Ne(e,t),Ne(a,n)],r=[Ae(e,t),Ae(a,n)];return[[o[0],r[0]],[o[1],r[1]]]}function pr(e){return Ua(e.group)}function vt(e,a){var t={w:"left",e:"right",n:"top",s:"bottom"},n={left:"w",right:"e",top:"n",bottom:"s"},o=kn(t[a],pr(e));return n[o]}function fr(e,a){var t=[vt(e,a[0]),vt(e,a[1])];return(t[0]==="e"||t[0]==="w")&&t.reverse(),t.join("")}function ta(e,a,t,n,o,r){var i=t.__brushOption,s=e.toRectRange(i.range),l=un(a,o,r);A(n,function(u){var d=lr[u];s[d[0]][d[1]]+=l[d[0]]}),i.range=e.fromRectRange(ln(s[0][0],s[1][0],s[0][1],s[1][1])),Dt(a,t),ye(a,{isEnd:!1})}function vr(e,a,t,n){var o=a.__brushOption.range,r=un(e,t,n);A(o,function(i){i[0]+=r[0],i[1]+=r[1]}),Dt(e,a),ye(e,{isEnd:!1})}function un(e,a,t){var n=e.group,o=n.transformCoordToLocal(a,t),r=n.transformCoordToLocal(0,0);return[o[0]-r[0],o[1]-r[1]]}function kt(e,a,t){var n=nn(e,a);return n&&n!==me?n.clipPath(t,e._transform):de(t)}function gr(e){var a=Ne(e[0][0],e[1][0]),t=Ne(e[0][1],e[1][1]),n=Ae(e[0][0],e[1][0]),o=Ae(e[0][1],e[1][1]);return{x:a,y:t,width:n-a,height:o-t}}function mr(e,a,t){if(!(!e._brushType||_r(e,a.offsetX,a.offsetY))){var n=e._zr,o=e._covers,r=It(e,a,t);if(!e._dragging)for(var i=0;i<o.length;i++){var s=o[i].__brushOption;if(r&&(r===me||s.panelId===r.panelId)&&je[s.brushType].contain(o[i],t[0],t[1]))return}r&&n.setCursorStyle("crosshair")}}function gt(e){var a=e.event;a.preventDefault&&a.preventDefault()}function mt(e,a,t){return e.childOfName("main").contain(a,t)}function cn(e,a,t,n){var o=e._creatingCover,r=e._creatingPanel,i=e._brushOption,s;if(e._track.push(t.slice()),hr(e)||o){if(r&&!o){i.brushMode==="single"&&pt(e);var l=de(i);l.brushType=aa(l.brushType,r),l.panelId=r===me?null:r.panelId,o=e._creatingCover=Qa(e,l),e._covers.push(o)}if(o){var u=je[aa(e._brushType,r)],d=o.__brushOption;d.range=u.getCreatingRange(kt(e,o,e._track)),n&&(en(e,o),u.updateCommon(e,o)),tn(e,o),s={isEnd:n}}}else n&&i.brushMode==="single"&&i.removeOnClick&&It(e,a,t)&&pt(e)&&(s={isEnd:n,removeOnClick:!0});return s}function aa(e,a){return e==="auto"?a.defaultBrushType:e}var yr={mousedown:function(e){if(this._dragging)na(this,e);else if(!e.target||!e.target.draggable){gt(e);var a=this.group.transformCoordToLocal(e.offsetX,e.offsetY);this._creatingCover=null;var t=this._creatingPanel=It(this,e,a);t&&(this._dragging=!0,this._track=[a.slice()])}},mousemove:function(e){var a=e.offsetX,t=e.offsetY,n=this.group.transformCoordToLocal(a,t);if(mr(this,e,n),this._dragging){gt(e);var o=cn(this,e,n,!1);o&&ye(this,o)}},mouseup:function(e){na(this,e)}};function na(e,a){if(e._dragging){gt(a);var t=a.offsetX,n=a.offsetY,o=e.group.transformCoordToLocal(t,n),r=cn(e,a,o,!0);e._dragging=!1,e._track=[],e._creatingCover=null,r&&ye(e,r)}}function _r(e,a,t){var n=e._zr;return a<0||a>n.getWidth()||t<0||t>n.getHeight()}var je={lineX:oa(0),lineY:oa(1),rect:{createCover:function(e,a){function t(n){return n}return rn({toRectRange:t,fromRectRange:t},e,a,[["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]])},getCreatingRange:function(e){var a=on(e);return ln(a[1][0],a[1][1],a[0][0],a[0][1])},updateCoverShape:function(e,a,t,n){sn(e,a,t,n)},updateCommon:ft,contain:mt},polygon:{createCover:function(e,a){var t=new $e;return t.add(new Za({name:"main",style:Lt(a),silent:!0})),t},getCreatingRange:function(e){return e},endCreating:function(e,a){a.remove(a.childAt(0)),a.add(new Ln({name:"main",draggable:!0,drift:Q(vr,e,a),ondragend:Q(ye,e,{isEnd:!0})}))},updateCoverShape:function(e,a,t,n){a.childAt(0).setShape({points:kt(e,a,t)})},updateCommon:ft,contain:mt}};function oa(e){return{createCover:function(a,t){return rn({toRectRange:function(n){var o=[n,[0,100]];return e&&o.reverse(),o},fromRectRange:function(n){return n[e]}},a,t,[[["w"],["e"]],[["n"],["s"]]][e])},getCreatingRange:function(a){var t=on(a),n=Ne(t[0][e],t[1][e]),o=Ae(t[0][e],t[1][e]);return[n,o]},updateCoverShape:function(a,t,n,o){var r,i=nn(a,t);if(i!==me&&i.getLinearBrushOtherExtent)r=i.getLinearBrushOtherExtent(e);else{var s=a._zr;r=[0,[s.getWidth(),s.getHeight()][1-e]]}var l=[n,r];e&&l.reverse(),sn(a,t,l,o)},updateCommon:ft,contain:mt}}var br=dr;function xr(e){return e=Mt(e),function(a){return Mn(a,e)}}function Cr(e,a){return e=Mt(e),function(t){var n=a!=null?a:t,o=n?e.width:e.height,r=n?e.x:e.y;return[r,r+(o||0)]}}function Sr(e,a,t){var n=Mt(e);return function(o,r){return n.contain(r[0],r[1])&&!nr(o,a,t)}}function Mt(e){return Ct.create(e)}var wr=function(){function e(){}return e.prototype.getInitialData=function(a,t){var n,o=t.getComponent("xAxis",this.get("xAxisIndex")),r=t.getComponent("yAxis",this.get("yAxisIndex")),i=o.get("type"),s=r.get("type"),l;i==="category"?(a.layout="horizontal",n=o.getOrdinalMeta(),l=!0):s==="category"?(a.layout="vertical",n=r.getOrdinalMeta(),l=!0):a.layout=a.layout||"horizontal";var u=["x","y"],d=a.layout==="horizontal"?0:1,c=this._baseAxisDim=u[d],h=u[1-d],p=[o,r],m=p[d].get("type"),f=p[1-d].get("type"),v=a.data;if(v&&l){var g=[];A(v,function(y,w){var x;oe(y)?(x=y.slice(),y.unshift(w)):oe(y.value)?(x=we({},y),x.value=x.value.slice(),y.value.unshift(w)):x=y,g.push(x)}),a.data=g}var _=this.defaultValueDimensions,b=[{name:c,type:Gt(m),ordinalMeta:n,otherDims:{tooltip:!1,itemName:0},dimsDef:["base"]},{name:h,type:Gt(f),dimsDef:_.slice()}];return Go(this,{coordDimensions:b,dimensionsCount:_.length+1,encodeDefaulter:Q(Bn,b,this)})},e.prototype.getBaseAxis=function(){var a=this._baseAxisDim;return this.ecModel.getComponent(a+"Axis",this.get(a+"AxisIndex")).axis},e}(),Ar=["color","borderColor"],Tr=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.prototype.render=function(t,n,o){this.group.removeClipPath(),this._progressiveEls=null,this._updateDrawMode(t),this._isLargeDraw?this._renderLarge(t):this._renderNormal(t)},a.prototype.incrementalPrepareRender=function(t,n,o){this._clear(),this._updateDrawMode(t)},a.prototype.incrementalRender=function(t,n,o,r){this._progressiveEls=[],this._isLargeDraw?this._incrementalRenderLarge(t,n):this._incrementalRenderNormal(t,n)},a.prototype.eachRendered=function(t){zn(this._progressiveEls||this.group,t)},a.prototype._updateDrawMode=function(t){var n=t.pipelineContext.large;(this._isLargeDraw==null||n!==this._isLargeDraw)&&(this._isLargeDraw=n,this._clear())},a.prototype._renderNormal=function(t){var n=t.getData(),o=this._data,r=this.group,i=n.getLayout("isSimpleBox"),s=t.get("clip",!0),l=t.coordinateSystem,u=l.getArea&&l.getArea();this._data||r.removeAll(),n.diff(o).add(function(d){if(n.hasValue(d)){var c=n.getItemLayout(d);if(s&&ra(u,c))return;var h=Je(c,d,!0);Vn(h,{shape:{points:c.ends}},t,d),Qe(h,n,d,i),r.add(h),n.setItemGraphicEl(d,h)}}).update(function(d,c){var h=o.getItemGraphicEl(c);if(!n.hasValue(d)){r.remove(h);return}var p=n.getItemLayout(d);if(s&&ra(u,p)){r.remove(h);return}h?(Nn(h,{shape:{points:p.ends}},t,d),Rn(h)):h=Je(p),Qe(h,n,d,i),r.add(h),n.setItemGraphicEl(d,h)}).remove(function(d){var c=o.getItemGraphicEl(d);c&&r.remove(c)}).execute(),this._data=n},a.prototype._renderLarge=function(t){this._clear(),ia(t,this.group);var n=t.get("clip",!0)?Bo(t.coordinateSystem,!1,t):null;n?this.group.setClipPath(n):this.group.removeClipPath()},a.prototype._incrementalRenderNormal=function(t,n){for(var o=n.getData(),r=o.getLayout("isSimpleBox"),i;(i=t.next())!=null;){var s=o.getItemLayout(i),l=Je(s);Qe(l,o,i,r),l.incremental=!0,this.group.add(l),this._progressiveEls.push(l)}},a.prototype._incrementalRenderLarge=function(t,n){ia(n,this.group,this._progressiveEls,!0)},a.prototype.remove=function(t){this._clear()},a.prototype._clear=function(){this.group.removeAll(),this._data=null},a.type="candlestick",a}(Fa),Pr=function(){function e(){}return e}(),Dr=function(e){N(a,e);function a(t){var n=e.call(this,t)||this;return n.type="normalCandlestickBox",n}return a.prototype.getDefaultShape=function(){return new Pr},a.prototype.buildPath=function(t,n){var o=n.points;this.__simpleBox?(t.moveTo(o[4][0],o[4][1]),t.lineTo(o[6][0],o[6][1])):(t.moveTo(o[0][0],o[0][1]),t.lineTo(o[1][0],o[1][1]),t.lineTo(o[2][0],o[2][1]),t.lineTo(o[3][0],o[3][1]),t.closePath(),t.moveTo(o[4][0],o[4][1]),t.lineTo(o[5][0],o[5][1]),t.moveTo(o[6][0],o[6][1]),t.lineTo(o[7][0],o[7][1]))},a}(St);function Je(e,a,t){var n=e.ends;return new Dr({shape:{points:t?Or(n,e):n},z2:100})}function ra(e,a){for(var t=!0,n=0;n<a.ends.length;n++)if(e.contain(a.ends[n][0],a.ends[n][1])){t=!1;break}return t}function Qe(e,a,t,n){var o=a.getItemModel(t);e.useStyle(a.getItemVisual(t,"style")),e.style.strokeNoScale=!0,e.__simpleBox=n,$n(e,o)}function Or(e,a){return K(e,function(t){return t=t.slice(),t[1]=a.initBaseline,t})}var Ir=function(){function e(){}return e}(),et=function(e){N(a,e);function a(t){var n=e.call(this,t)||this;return n.type="largeCandlestickBox",n}return a.prototype.getDefaultShape=function(){return new Ir},a.prototype.buildPath=function(t,n){for(var o=n.points,r=0;r<o.length;)if(this.__sign===o[r++]){var i=o[r++];t.moveTo(i,o[r++]),t.lineTo(i,o[r++])}else r+=3},a}(St);function ia(e,a,t,n){var o=e.getData(),r=o.getLayout("largePoints"),i=new et({shape:{points:r},__sign:1,ignoreCoarsePointer:!0});a.add(i);var s=new et({shape:{points:r},__sign:-1,ignoreCoarsePointer:!0});a.add(s);var l=new et({shape:{points:r},__sign:0,ignoreCoarsePointer:!0});a.add(l),tt(1,i,e),tt(-1,s,e),tt(0,l,e),n&&(i.incremental=!0,s.incremental=!0),t&&t.push(i,s)}function tt(e,a,t,n){var o=t.get(["itemStyle",e>0?"borderColor":"borderColor0"])||t.get(["itemStyle",e>0?"color":"color0"]);e===0&&(o=t.get(["itemStyle","borderColorDoji"]));var r=t.getModel("itemStyle").getItemStyle(Ar);a.useStyle(r),a.style.fill=null,a.style.stroke=o}var Lr=Tr,dn=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t.defaultValueDimensions=[{name:"open",defaultTooltip:!0},{name:"close",defaultTooltip:!0},{name:"lowest",defaultTooltip:!0},{name:"highest",defaultTooltip:!0}],t}return a.prototype.getShadowDim=function(){return"open"},a.prototype.brushSelector=function(t,n,o){var r=n.getItemLayout(t);return r&&o.rect(r.brushRect)},a.type="series.candlestick",a.dependencies=["xAxis","yAxis","grid"],a.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,layout:null,clip:!0,itemStyle:{color:"#eb5454",color0:"#47b262",borderColor:"#eb5454",borderColor0:"#47b262",borderColorDoji:null,borderWidth:1},emphasis:{scale:!0,itemStyle:{borderWidth:2}},barMaxWidth:null,barMinWidth:null,barWidth:null,large:!0,largeThreshold:600,progressive:3e3,progressiveThreshold:1e4,progressiveChunkMode:"mod",animationEasing:"linear",animationDuration:300},a}(Ra);Ha(dn,wr,!0);var kr=dn;function Mr(e){!e||!oe(e.series)||A(e.series,function(a){Be(a)&&a.type==="k"&&(a.type="candlestick")})}var Br=["itemStyle","borderColor"],zr=["itemStyle","borderColor0"],Vr=["itemStyle","borderColorDoji"],Nr=["itemStyle","color"],Rr=["itemStyle","color0"],$r={seriesType:"candlestick",plan:Ga(),performRawSeries:!0,reset:function(e,a){function t(r,i){return i.get(r>0?Nr:Rr)}function n(r,i){return i.get(r===0?Vr:r>0?Br:zr)}if(!a.isSeriesFiltered(e)){var o=e.pipelineContext.large;return!o&&{progress:function(r,i){for(var s;(s=r.next())!=null;){var l=i.getItemModel(s),u=i.getItemLayout(s).sign,d=l.getItemStyle();d.fill=t(u,l),d.stroke=n(u,l)||d.fill;var c=i.ensureUniqueItemVisual(s,"style");we(c,d)}}}}}},Er=$r,Fr={seriesType:"candlestick",plan:Ga(),reset:function(e){var a=e.coordinateSystem,t=e.getData(),n=Wr(e,t),o=0,r=1,i=["x","y"],s=t.getDimensionIndex(t.mapDimension(i[o])),l=K(t.mapDimensionsAll(i[r]),t.getDimensionIndex,t),u=l[0],d=l[1],c=l[2],h=l[3];if(t.setLayout({candleWidth:n,isSimpleBox:n<=1.3}),s<0||l.length<4)return;return{progress:e.pipelineContext.large?m:p};function p(f,v){for(var g,_=v.getStore();(g=f.next())!=null;){var b=_.get(s,g),y=_.get(u,g),w=_.get(d,g),x=_.get(c,g),C=_.get(h,g),B=Math.min(y,w),k=Math.max(y,w),I=ee(B,b),M=ee(k,b),O=ee(x,b),F=ee(C,b),X=[];fe(X,M,0),fe(X,I,1),X.push($(F),$(M),$(O),$(I));var pe=v.getItemModel(g),q=!!pe.get(["itemStyle","borderColorDoji"]);v.setItemLayout(g,{sign:sa(_,g,y,w,d,q),initBaseline:y>w?M[r]:I[r],ends:X,brushRect:_e(x,C,b)})}function ee(S,G){var j=[];return j[o]=G,j[r]=S,isNaN(G)||isNaN(S)?[NaN,NaN]:a.dataToPoint(j)}function fe(S,G,j){var Y=G.slice(),U=G.slice();Y[o]=Ke(Y[o]+n/2,1,!1),U[o]=Ke(U[o]-n/2,1,!0),j?S.push(Y,U):S.push(U,Y)}function _e(S,G,j){var Y=ee(S,j),U=ee(G,j);return Y[o]-=n/2,U[o]-=n/2,{x:Y[0],y:Y[1],width:n,height:U[1]-Y[1]}}function $(S){return S[o]=Ke(S[o],1),S}}function m(f,v){for(var g=En(f.count*4),_=0,b,y=[],w=[],x,C=v.getStore(),B=!!e.get(["itemStyle","borderColorDoji"]);(x=f.next())!=null;){var k=C.get(s,x),I=C.get(u,x),M=C.get(d,x),O=C.get(c,x),F=C.get(h,x);if(isNaN(k)||isNaN(O)||isNaN(F)){g[_++]=NaN,_+=3;continue}g[_++]=sa(C,x,I,M,d,B),y[o]=k,y[r]=O,b=a.dataToPoint(y,null,w),g[_++]=b?b[0]:NaN,g[_++]=b?b[1]:NaN,y[r]=F,b=a.dataToPoint(y,null,w),g[_++]=b?b[1]:NaN}v.setLayout("largePoints",g)}}};function sa(e,a,t,n,o,r){var i;return t>n?i=-1:t<n?i=1:i=r?0:a>0?e.get(o,a-1)<=n?1:-1:1,i}function Wr(e,a){var t=e.getBaseAxis(),n,o=t.type==="category"?t.getBandWidth():(n=t.getExtent(),Math.abs(n[1]-n[0])/a.count()),r=Fe(ht(e.get("barMaxWidth"),o),o),i=Fe(ht(e.get("barMinWidth"),1),o),s=e.get("barWidth");return s!=null?Fe(s,o):Math.max(Math.min(o/2,r),i)}var Zr=Fr;function Ur(e){e.registerChartView(Lr),e.registerSeriesModel(kr),e.registerPreprocessor(Mr),e.registerVisual(Er),e.registerLayout(Zr)}var Hr=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.prototype.init=function(t,n,o){var r=Fn(t);e.prototype.init.apply(this,arguments),la(t,r)},a.prototype.mergeOption=function(t){e.prototype.mergeOption.apply(this,arguments),la(this.option,t)},a.prototype.getCellSize=function(){return this.option.cellSize},a.type="calendar",a.defaultOption={z:2,left:80,top:60,cellSize:20,orient:"horizontal",splitLine:{show:!0,lineStyle:{color:"#000",width:1,type:"solid"}},itemStyle:{color:"#fff",borderWidth:1,borderColor:"#ccc"},dayLabel:{show:!0,firstDay:0,position:"start",margin:"50%",color:"#000"},monthLabel:{show:!0,position:"start",margin:5,align:"center",formatter:null,color:"#000"},yearLabel:{show:!0,position:null,margin:30,formatter:null,color:"#ccc",fontFamily:"sans-serif",fontWeight:"bolder",fontSize:20}},a}(At);function la(e,a){var t=e.cellSize,n;oe(t)?n=t:n=e.cellSize=[t,t],n.length===1&&(n[1]=n[0]);var o=K([0,1],function(r){return Wn(a,r)&&(n[r]="auto"),n[r]!=null&&n[r]!=="auto"});Zn(e,a,{type:"box",ignoreSize:o})}var Gr=Hr,jr=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.prototype.render=function(t,n,o){var r=this.group;r.removeAll();var i=t.coordinateSystem,s=i.getRangeInfo(),l=i.getOrient(),u=n.getLocaleModel();this._renderDayRect(t,s,r),this._renderLines(t,s,l,r),this._renderYearText(t,s,l,r),this._renderMonthText(t,u,l,r),this._renderWeekText(t,u,s,l,r)},a.prototype._renderDayRect=function(t,n,o){for(var r=t.coordinateSystem,i=t.getModel("itemStyle").getItemStyle(),s=r.getCellWidth(),l=r.getCellHeight(),u=n.start.time;u<=n.end.time;u=r.getNextNDay(u,1).time){var d=r.dataToRect([u],!1).tl,c=new dt({shape:{x:d[0],y:d[1],width:s,height:l},cursor:"default",style:i});o.add(c)}},a.prototype._renderLines=function(t,n,o,r){var i=this,s=t.coordinateSystem,l=t.getModel(["splitLine","lineStyle"]).getLineStyle(),u=t.get(["splitLine","show"]),d=l.lineWidth;this._tlpoints=[],this._blpoints=[],this._firstDayOfMonth=[],this._firstDayPoints=[];for(var c=n.start,h=0;c.time<=n.end.time;h++){m(c.formatedDate),h===0&&(c=s.getDateInfo(n.start.y+"-"+n.start.m));var p=c.date;p.setMonth(p.getMonth()+1),c=s.getDateInfo(p)}m(s.getNextNDay(n.end.time,1).formatedDate);function m(f){i._firstDayOfMonth.push(s.getDateInfo(f)),i._firstDayPoints.push(s.dataToRect([f],!1).tl);var v=i._getLinePointsOfOneWeek(t,f,o);i._tlpoints.push(v[0]),i._blpoints.push(v[v.length-1]),u&&i._drawSplitline(v,l,r)}u&&this._drawSplitline(i._getEdgesPoints(i._tlpoints,d,o),l,r),u&&this._drawSplitline(i._getEdgesPoints(i._blpoints,d,o),l,r)},a.prototype._getEdgesPoints=function(t,n,o){var r=[t[0].slice(),t[t.length-1].slice()],i=o==="horizontal"?0:1;return r[0][i]=r[0][i]-n/2,r[1][i]=r[1][i]+n/2,r},a.prototype._drawSplitline=function(t,n,o){var r=new Za({z2:20,shape:{points:t},style:n});o.add(r)},a.prototype._getLinePointsOfOneWeek=function(t,n,o){for(var r=t.coordinateSystem,i=r.getDateInfo(n),s=[],l=0;l<7;l++){var u=r.getNextNDay(i.time,l),d=r.dataToRect([u.time],!1);s[2*u.day]=d.tl,s[2*u.day+1]=d[o==="horizontal"?"bl":"tr"]}return s},a.prototype._formatterLabel=function(t,n){return he(t)&&t?Un(t,n):ze(t)?t(n):n.nameMap},a.prototype._yearTextPositionControl=function(t,n,o,r,i){var s=n[0],l=n[1],u=["center","bottom"];r==="bottom"?(l+=i,u=["center","top"]):r==="left"?s-=i:r==="right"?(s+=i,u=["center","top"]):l-=i;var d=0;return(r==="left"||r==="right")&&(d=Math.PI/2),{rotation:d,x:s,y:l,style:{align:u[0],verticalAlign:u[1]}}},a.prototype._renderYearText=function(t,n,o,r){var i=t.getModel("yearLabel");if(!!i.get("show")){var s=i.get("margin"),l=i.get("position");l||(l=o!=="horizontal"?"top":"left");var u=[this._tlpoints[this._tlpoints.length-1],this._blpoints[0]],d=(u[0][0]+u[1][0])/2,c=(u[0][1]+u[1][1])/2,h=o==="horizontal"?0:1,p={top:[d,u[h][1]],bottom:[d,u[1-h][1]],left:[u[1-h][0],c],right:[u[h][0],c]},m=n.start.y;+n.end.y>+n.start.y&&(m=m+"-"+n.end.y);var f=i.get("formatter"),v={start:n.start.y,end:n.end.y,nameMap:m},g=this._formatterLabel(f,v),_=new Ce({z2:30,style:Se(i,{text:g})});_.attr(this._yearTextPositionControl(_,p[l],o,l,s)),r.add(_)}},a.prototype._monthTextPositionControl=function(t,n,o,r,i){var s="left",l="top",u=t[0],d=t[1];return o==="horizontal"?(d=d+i,n&&(s="center"),r==="start"&&(l="bottom")):(u=u+i,n&&(l="middle"),r==="start"&&(s="right")),{x:u,y:d,align:s,verticalAlign:l}},a.prototype._renderMonthText=function(t,n,o,r){var i=t.getModel("monthLabel");if(!!i.get("show")){var s=i.get("nameMap"),l=i.get("margin"),u=i.get("position"),d=i.get("align"),c=[this._tlpoints,this._blpoints];(!s||he(s))&&(s&&(n=jt(s)||n),s=n.get(["time","monthAbbr"])||[]);var h=u==="start"?0:1,p=o==="horizontal"?0:1;l=u==="start"?-l:l;for(var m=d==="center",f=0;f<c[h].length-1;f++){var v=c[h][f].slice(),g=this._firstDayOfMonth[f];if(m){var _=this._firstDayPoints[f];v[p]=(_[p]+c[0][f+1][p])/2}var b=i.get("formatter"),y=s[+g.m-1],w={yyyy:g.y,yy:(g.y+"").slice(2),MM:g.m,M:+g.m,nameMap:y},x=this._formatterLabel(b,w),C=new Ce({z2:30,style:we(Se(i,{text:x}),this._monthTextPositionControl(v,m,o,u,l))});r.add(C)}}},a.prototype._weekTextPositionControl=function(t,n,o,r,i){var s="center",l="middle",u=t[0],d=t[1],c=o==="start";return n==="horizontal"?(u=u+r+(c?1:-1)*i[0]/2,s=c?"right":"left"):(d=d+r+(c?1:-1)*i[1]/2,l=c?"bottom":"top"),{x:u,y:d,align:s,verticalAlign:l}},a.prototype._renderWeekText=function(t,n,o,r,i){var s=t.getModel("dayLabel");if(!!s.get("show")){var l=t.coordinateSystem,u=s.get("position"),d=s.get("nameMap"),c=s.get("margin"),h=l.getFirstDayOfWeek();if(!d||he(d)){d&&(n=jt(d)||n);var p=n.get(["time","dayOfWeekShort"]);d=p||K(n.get(["time","dayOfWeekAbbr"]),function(w){return w[0]})}var m=l.getNextNDay(o.end.time,7-o.lweek).time,f=[l.getCellWidth(),l.getCellHeight()];c=Fe(c,Math.min(f[1],f[0])),u==="start"&&(m=l.getNextNDay(o.start.time,-(7+o.fweek)).time,c=-c);for(var v=0;v<7;v++){var g=l.getNextNDay(m,v),_=l.dataToRect([g.time],!1).center,b=v;b=Math.abs((v+h)%7);var y=new Ce({z2:30,style:we(Se(s,{text:d[b]}),this._weekTextPositionControl(_,r,u,c,f))});i.add(y)}}},a.type="calendar",a}(Tt),Yr=jr,at=864e5,qr=function(){function e(a,t,n){this.type="calendar",this.dimensions=e.dimensions,this.getDimensionsInfo=e.getDimensionsInfo,this._model=a}return e.getDimensionsInfo=function(){return[{name:"time",type:"time"},"value"]},e.prototype.getRangeInfo=function(){return this._rangeInfo},e.prototype.getModel=function(){return this._model},e.prototype.getRect=function(){return this._rect},e.prototype.getCellWidth=function(){return this._sw},e.prototype.getCellHeight=function(){return this._sh},e.prototype.getOrient=function(){return this._orient},e.prototype.getFirstDayOfWeek=function(){return this._firstDayOfWeek},e.prototype.getDateInfo=function(a){a=Hn(a);var t=a.getFullYear(),n=a.getMonth()+1,o=n<10?"0"+n:""+n,r=a.getDate(),i=r<10?"0"+r:""+r,s=a.getDay();return s=Math.abs((s+7-this.getFirstDayOfWeek())%7),{y:t+"",m:o,d:i,day:s,time:a.getTime(),formatedDate:t+"-"+o+"-"+i,date:a}},e.prototype.getNextNDay=function(a,t){return t=t||0,t===0?this.getDateInfo(a):(a=new Date(this.getDateInfo(a).time),a.setDate(a.getDate()+t),this.getDateInfo(a))},e.prototype.update=function(a,t){this._firstDayOfWeek=+this._model.getModel("dayLabel").get("firstDay"),this._orient=this._model.get("orient"),this._lineWidth=this._model.getModel("itemStyle").getItemStyle().lineWidth||0,this._rangeInfo=this._getRangeInfo(this._initRangeOption());var n=this._rangeInfo.weeks||1,o=["width","height"],r=this._model.getCellSize().slice(),i=this._model.getBoxLayoutParams(),s=this._orient==="horizontal"?[n,7]:[7,n];A([0,1],function(c){d(r,c)&&(i[o[c]]=r[c]*s[c])});var l={width:t.getWidth(),height:t.getHeight()},u=this._rect=ja(i,l);A([0,1],function(c){d(r,c)||(r[c]=u[o[c]]/s[c])});function d(c,h){return c[h]!=null&&c[h]!=="auto"}this._sw=r[0],this._sh=r[1]},e.prototype.dataToPoint=function(a,t){oe(a)&&(a=a[0]),t==null&&(t=!0);var n=this.getDateInfo(a),o=this._rangeInfo,r=n.formatedDate;if(t&&!(n.time>=o.start.time&&n.time<o.end.time+at))return[NaN,NaN];var i=n.day,s=this._getRangeInfo([o.start.time,r]).nthWeek;return this._orient==="vertical"?[this._rect.x+i*this._sw+this._sw/2,this._rect.y+s*this._sh+this._sh/2]:[this._rect.x+s*this._sw+this._sw/2,this._rect.y+i*this._sh+this._sh/2]},e.prototype.pointToData=function(a){var t=this.pointToDate(a);return t&&t.time},e.prototype.dataToRect=function(a,t){var n=this.dataToPoint(a,t);return{contentShape:{x:n[0]-(this._sw-this._lineWidth)/2,y:n[1]-(this._sh-this._lineWidth)/2,width:this._sw-this._lineWidth,height:this._sh-this._lineWidth},center:n,tl:[n[0]-this._sw/2,n[1]-this._sh/2],tr:[n[0]+this._sw/2,n[1]-this._sh/2],br:[n[0]+this._sw/2,n[1]+this._sh/2],bl:[n[0]-this._sw/2,n[1]+this._sh/2]}},e.prototype.pointToDate=function(a){var t=Math.floor((a[0]-this._rect.x)/this._sw)+1,n=Math.floor((a[1]-this._rect.y)/this._sh)+1,o=this._rangeInfo.range;return this._orient==="vertical"?this._getDateByWeeksAndDay(n,t-1,o):this._getDateByWeeksAndDay(t,n-1,o)},e.prototype.convertToPixel=function(a,t,n){var o=ua(t);return o===this?o.dataToPoint(n):null},e.prototype.convertFromPixel=function(a,t,n){var o=ua(t);return o===this?o.pointToData(n):null},e.prototype.containPoint=function(a){return console.warn("Not implemented."),!1},e.prototype._initRangeOption=function(){var a=this._model.get("range"),t;if(oe(a)&&a.length===1&&(a=a[0]),oe(a))t=a;else{var n=a.toString();if(/^\d{4}$/.test(n)&&(t=[n+"-01-01",n+"-12-31"]),/^\d{4}[\/|-]\d{1,2}$/.test(n)){var o=this.getDateInfo(n),r=o.date;r.setMonth(r.getMonth()+1);var i=this.getNextNDay(r,-1);t=[o.formatedDate,i.formatedDate]}/^\d{4}[\/|-]\d{1,2}[\/|-]\d{1,2}$/.test(n)&&(t=[n,n])}if(!t)return a;var s=this._getRangeInfo(t);return s.start.time>s.end.time&&t.reverse(),t},e.prototype._getRangeInfo=function(a){var t=[this.getDateInfo(a[0]),this.getDateInfo(a[1])],n;t[0].time>t[1].time&&(n=!0,t.reverse());var o=Math.floor(t[1].time/at)-Math.floor(t[0].time/at)+1,r=new Date(t[0].time),i=r.getDate(),s=t[1].date.getDate();r.setDate(i+o-1);var l=r.getDate();if(l!==s)for(var u=r.getTime()-t[1].time>0?1:-1;(l=r.getDate())!==s&&(r.getTime()-t[1].time)*u>0;)o-=u,r.setDate(l-u);var d=Math.floor((o+t[0].day+6)/7),c=n?-d+1:d-1;return n&&t.reverse(),{range:[t[0].formatedDate,t[1].formatedDate],start:t[0],end:t[1],allDay:o,weeks:d,nthWeek:c,fweek:t[0].day,lweek:t[1].day}},e.prototype._getDateByWeeksAndDay=function(a,t,n){var o=this._getRangeInfo(n);if(a>o.weeks||a===0&&t<o.fweek||a===o.weeks&&t>o.lweek)return null;var r=(a-1)*7-o.fweek+t,i=new Date(o.start.time);return i.setDate(+o.start.d+r),this.getDateInfo(i)},e.create=function(a,t){var n=[];return a.eachComponent("calendar",function(o){var r=new e(o);n.push(r),o.coordinateSystem=r}),a.eachSeries(function(o){o.get("coordinateSystem")==="calendar"&&(o.coordinateSystem=n[o.get("calendarIndex")||0])}),n},e.dimensions=["time","value"],e}();function ua(e){var a=e.calendarModel,t=e.seriesModel,n=a?a.coordinateSystem:t?t.coordinateSystem:null;return n}var Kr=qr;function Xr(e){e.registerComponentModel(Gr),e.registerComponentView(Yr),e.registerCoordinateSystem("calendar",Kr)}var Jr=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.type="dataZoom.select",a}(zo),Qr=Jr,ei=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.type="dataZoom.select",a}(Vo),ti=ei;function ai(e){e.registerComponentModel(Qr),e.registerComponentView(ti),No(e)}var ne=function(){function e(){}return e}(),hn={};function ke(e,a){hn[e]=a}function pn(e){return hn[e]}var ni=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.prototype.optionUpdated=function(){e.prototype.optionUpdated.apply(this,arguments);var t=this.ecModel;A(this.option.feature,function(n,o){var r=pn(o);r&&(r.getDefaultOption&&(r.defaultOption=r.getDefaultOption(t)),ce(n,r.defaultOption))})},a.type="toolbox",a.layoutMode={type:"box",ignoreSize:!0},a.defaultOption={show:!0,z:6,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1,position:"bottom"}},a}(At),oi=ni,ri=function(e){N(a,e);function a(){return e!==null&&e.apply(this,arguments)||this}return a.prototype.render=function(t,n,o,r){var i=this.group;if(i.removeAll(),!t.get("show"))return;var s=+t.get("itemSize"),l=t.get("orient")==="vertical",u=t.get("feature")||{},d=this._features||(this._features={}),c=[];A(u,function(m,f){c.push(f)}),new Wa(this._featureNames||[],c).add(h).update(h).remove(Q(h,null)).execute(),this._featureNames=c;function h(m,f){var v=c[m],g=c[f],_=u[v],b=new Gn(_,t,t.ecModel),y;if(r&&r.newTitle!=null&&r.featureName===v&&(_.title=r.newTitle),v&&!g){if(ii(v))y={onclick:b.option.onclick,featureName:v};else{var w=pn(v);if(!w)return;y=new w}d[v]=y}else if(y=d[g],!y)return;y.uid=jn("toolbox-feature"),y.model=b,y.ecModel=n,y.api=o;var x=y instanceof ne;if(!v&&g){x&&y.dispose&&y.dispose(n,o);return}if(!b.get("show")||x&&y.unusable){x&&y.remove&&y.remove(n,o);return}p(b,y,v),b.setIconStatus=function(C,B){var k=this.option,I=this.iconPaths;k.iconStatus=k.iconStatus||{},k.iconStatus[C]=B,I[C]&&(B==="emphasis"?Yt:qt)(I[C])},y instanceof ne&&y.render&&y.render(b,n,o,r)}function p(m,f,v){var g=m.getModel("iconStyle"),_=m.getModel(["emphasis","iconStyle"]),b=f instanceof ne&&f.getIcons?f.getIcons():m.get("icon"),y=m.get("title")||{},w,x;he(b)?(w={},w[v]=b):w=b,he(y)?(x={},x[v]=y):x=y;var C=m.iconPaths={};A(w,function(B,k){var I=Ya(B,{},{x:-s/2,y:-s/2,width:s,height:s});I.setStyle(g.getItemStyle());var M=I.ensureState("emphasis");M.style=_.getItemStyle();var O=new Ce({style:{text:x[k],align:_.get("textAlign"),borderRadius:_.get("textBorderRadius"),padding:_.get("textPadding"),fill:null},ignore:!0});I.setTextContent(O),Yn({el:I,componentModel:t,itemName:k,formatterParamsExtra:{title:x[k]}}),I.__title=x[k],I.on("mouseover",function(){var F=_.getItemStyle(),X=l?t.get("right")==null&&t.get("left")!=="right"?"right":"left":t.get("bottom")==null&&t.get("top")!=="bottom"?"bottom":"top";O.setStyle({fill:_.get("textFill")||F.fill||F.stroke||"#000",backgroundColor:_.get("textBackgroundColor")}),I.setTextConfig({position:_.get("textPosition")||X}),O.ignore=!t.get("showTitle"),o.enterEmphasis(this)}).on("mouseout",function(){m.get(["iconStatus",k])!=="emphasis"&&o.leaveEmphasis(this),O.hide()}),(m.get(["iconStatus",k])==="emphasis"?Yt:qt)(I),i.add(I),I.on("click",se(f.onclick,f,n,o,k)),C[k]=I})}qn(i,t,o),i.add(Kn(i.getBoundingRect(),t)),l||i.eachChild(function(m){var f=m.__title,v=m.ensureState("emphasis"),g=v.textConfig||(v.textConfig={}),_=m.getTextContent(),b=_&&_.ensureState("emphasis");if(b&&!ze(b)&&f){var y=b.style||(b.style={}),w=Xn(f,Ce.makeFont(y)),x=m.x+i.x,C=m.y+i.y+s,B=!1;C+w.height>o.getHeight()&&(g.position="top",B=!0);var k=B?-5-w.height:s+10;x+w.width/2>o.getWidth()?(g.position=["100%",k],y.align="right"):x-w.width/2<0&&(g.position=[0,k],y.align="left")}})},a.prototype.updateView=function(t,n,o,r){A(this._features,function(i){i instanceof ne&&i.updateView&&i.updateView(i.model,n,o,r)})},a.prototype.remove=function(t,n){A(this._features,function(o){o instanceof ne&&o.remove&&o.remove(t,n)}),this.group.removeAll()},a.prototype.dispose=function(t,n){A(this._features,function(o){o instanceof ne&&o.dispose&&o.dispose(t,n)})},a.type="toolbox",a}(Tt);function ii(e){return e.indexOf("my")===0}var si=ri,li=function(e){N(a,e);function a(){return e!==null&&e.apply(this,arguments)||this}return a.prototype.onclick=function(t,n){var o=this.model,r=o.get("name")||t.get("title.0.text")||"echarts",i=n.getZr().painter.getType()==="svg",s=i?"svg":o.get("type",!0)||"png",l=n.getConnectedDataURL({type:s,backgroundColor:o.get("backgroundColor",!0)||t.get("backgroundColor")||"#fff",connectedBackgroundColor:o.get("connectedBackgroundColor"),excludeComponents:o.get("excludeComponents"),pixelRatio:o.get("pixelRatio")}),u=Jn.browser;if(ze(MouseEvent)&&(u.newEdge||!u.ie&&!u.edge)){var d=document.createElement("a");d.download=r+"."+s,d.target="_blank",d.href=l;var c=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});d.dispatchEvent(c)}else if(window.navigator.msSaveOrOpenBlob||i){var h=l.split(","),p=h[0].indexOf("base64")>-1,m=i?decodeURIComponent(h[1]):h[1];p&&(m=window.atob(m));var f=r+"."+s;if(window.navigator.msSaveOrOpenBlob){for(var v=m.length,g=new Uint8Array(v);v--;)g[v]=m.charCodeAt(v);var _=new Blob([g]);window.navigator.msSaveOrOpenBlob(_,f)}else{var b=document.createElement("iframe");document.body.appendChild(b);var y=b.contentWindow,w=y.document;w.open("image/svg+xml","replace"),w.write(m),w.close(),y.focus(),w.execCommand("SaveAs",!0,f),document.body.removeChild(b)}}else{var x=o.get("lang"),C='<body style="margin:0;"><img src="'+l+'" style="max-width:100%;" title="'+(x&&x[0]||"")+'" /></body>',B=window.open();B.document.write(C),B.document.title=r}},a.getDefaultOption=function(t){var n={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:t.getLocaleModel().get(["toolbox","saveAsImage","title"]),type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],lang:t.getLocaleModel().get(["toolbox","saveAsImage","lang"])};return n},a}(ne),ui=li,ca="__ec_magicType_stack__",ci=[["line","bar"],["stack"]],di=function(e){N(a,e);function a(){return e!==null&&e.apply(this,arguments)||this}return a.prototype.getIcons=function(){var t=this.model,n=t.get("icon"),o={};return A(t.get("type"),function(r){n[r]&&(o[r]=n[r])}),o},a.getDefaultOption=function(t){var n={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:t.getLocaleModel().get(["toolbox","magicType","title"]),option:{},seriesIndex:{}};return n},a.prototype.onclick=function(t,n,o){var r=this.model,i=r.get(["seriesIndex",o]);if(!!da[o]){var s={series:[]},l=function(c){var h=c.subType,p=c.id,m=da[o](h,p,c,r);m&&(Pe(m,c.option),s.series.push(m));var f=c.coordinateSystem;if(f&&f.type==="cartesian2d"&&(o==="line"||o==="bar")){var v=f.getAxesByScale("ordinal")[0];if(v){var g=v.dim,_=g+"Axis",b=c.getReferringComponents(_,Qn).models[0],y=b.componentIndex;s[_]=s[_]||[];for(var w=0;w<=y;w++)s[_][y]=s[_][y]||{};s[_][y].boundaryGap=o==="bar"}}};A(ci,function(c){Ve(c,o)>=0&&A(c,function(h){r.setIconStatus(h,"normal")})}),r.setIconStatus(o,"emphasis"),t.eachComponent({mainType:"series",query:i==null?null:{seriesIndex:i}},l);var u,d=o;o==="stack"&&(u=ce({stack:r.option.title.tiled,tiled:r.option.title.stack},r.option.title),r.get(["iconStatus",o])!=="emphasis"&&(d="tiled")),n.dispatchAction({type:"changeMagicType",currentType:d,newOption:s,newTitle:u,featureName:"magicType"})}},a}(ne),da={line:function(e,a,t,n){if(e==="bar")return ce({id:a,type:"line",data:t.get("data"),stack:t.get("stack"),markPoint:t.get("markPoint"),markLine:t.get("markLine")},n.get(["option","line"])||{},!0)},bar:function(e,a,t,n){if(e==="line")return ce({id:a,type:"bar",data:t.get("data"),stack:t.get("stack"),markPoint:t.get("markPoint"),markLine:t.get("markLine")},n.get(["option","bar"])||{},!0)},stack:function(e,a,t,n){var o=t.get("stack")===ca;if(e==="line"||e==="bar")return n.setIconStatus("stack",o?"normal":"emphasis"),ce({id:a,stack:o?"":ca},n.get(["option","stack"])||{},!0)}};Pt({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(e,a){a.mergeOption(e.newOption)});var hi=di,Ye=new Array(60).join("-"),Te="	";function pi(e){var a={},t=[],n=[];return e.eachRawSeries(function(o){var r=o.coordinateSystem;if(r&&(r.type==="cartesian2d"||r.type==="polar")){var i=r.getBaseAxis();if(i.type==="category"){var s=i.dim+"_"+i.index;a[s]||(a[s]={categoryAxis:i,valueAxis:r.getOtherAxis(i),series:[]},n.push({axisDim:i.dim,axisIndex:i.index})),a[s].series.push(o)}else t.push(o)}else t.push(o)}),{seriesGroupByCategoryAxis:a,other:t,meta:n}}function fi(e){var a=[];return A(e,function(t,n){var o=t.categoryAxis,r=t.valueAxis,i=r.dim,s=[" "].concat(K(t.series,function(p){return p.name})),l=[o.model.getCategories()];A(t.series,function(p){var m=p.getRawData();l.push(p.getRawData().mapArray(m.mapDimension(i),function(f){return f}))});for(var u=[s.join(Te)],d=0;d<l[0].length;d++){for(var c=[],h=0;h<l.length;h++)c.push(l[h][d]);u.push(c.join(Te))}a.push(u.join(`
`))}),a.join(`

`+Ye+`

`)}function vi(e){return K(e,function(a){var t=a.getRawData(),n=[a.name],o=[];return t.each(t.dimensions,function(){for(var r=arguments.length,i=arguments[r-1],s=t.getName(i),l=0;l<r-1;l++)o[l]=arguments[l];n.push((s?s+Te:"")+o.join(Te))}),n.join(`
`)}).join(`

`+Ye+`

`)}function gi(e){var a=pi(e);return{value:to([fi(a.seriesGroupByCategoryAxis),vi(a.other)],function(t){return!!t.replace(/[\n\t\s]/g,"")}).join(`

`+Ye+`

`),meta:a.meta}}function He(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function mi(e){var a=e.slice(0,e.indexOf(`
`));if(a.indexOf(Te)>=0)return!0}var yt=new RegExp("["+Te+"]+","g");function yi(e){for(var a=e.split(/\n+/g),t=He(a.shift()).split(yt),n=[],o=K(t,function(l){return{name:l,data:[]}}),r=0;r<a.length;r++){var i=He(a[r]).split(yt);n.push(i.shift());for(var s=0;s<i.length;s++)o[s]&&(o[s].data[r]=i[s])}return{series:o,categories:n}}function _i(e){for(var a=e.split(/\n+/g),t=He(a.shift()),n=[],o=0;o<a.length;o++){var r=He(a[o]);if(!!r){var i=r.split(yt),s="",l=void 0,u=!1;isNaN(i[0])?(u=!0,s=i[0],i=i.slice(1),n[o]={name:s,value:[]},l=n[o].value):l=n[o]=[];for(var d=0;d<i.length;d++)l.push(+i[d]);l.length===1&&(u?n[o].value=l[0]:n[o]=l[0])}}return{name:t,data:n}}function bi(e,a){var t=e.split(new RegExp(`
*`+Ye+`
*`,"g")),n={series:[]};return A(t,function(o,r){if(mi(o)){var i=yi(o),s=a[r],l=s.axisDim+"Axis";s&&(n[l]=n[l]||[],n[l][s.axisIndex]={data:i.categories},n.series=n.series.concat(i.series))}else{var i=_i(o);n.series.push(i)}}),n}var xi=function(e){N(a,e);function a(){return e!==null&&e.apply(this,arguments)||this}return a.prototype.onclick=function(t,n){setTimeout(function(){n.dispatchAction({type:"hideTip"})});var o=n.getDom(),r=this.model;this._dom&&o.removeChild(this._dom);var i=document.createElement("div");i.style.cssText="position:absolute;top:0;bottom:0;left:0;right:0;padding:5px",i.style.backgroundColor=r.get("backgroundColor")||"#fff";var s=document.createElement("h4"),l=r.get("lang")||[];s.innerHTML=l[0]||r.get("title"),s.style.cssText="margin:10px 20px",s.style.color=r.get("textColor");var u=document.createElement("div"),d=document.createElement("textarea");u.style.cssText="overflow:auto";var c=r.get("optionToContent"),h=r.get("contentToOption"),p=gi(t);if(ze(c)){var m=c(n.getOption());he(m)?u.innerHTML=m:eo(m)&&u.appendChild(m)}else{d.readOnly=r.get("readOnly");var f=d.style;f.cssText="display:block;width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;resize:none;box-sizing:border-box;outline:none",f.color=r.get("textColor"),f.borderColor=r.get("textareaBorderColor"),f.backgroundColor=r.get("textareaColor"),d.value=p.value,u.appendChild(d)}var v=p.meta,g=document.createElement("div");g.style.cssText="position:absolute;bottom:5px;left:0;right:0";var _="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",b=document.createElement("div"),y=document.createElement("div");_+=";background-color:"+r.get("buttonColor"),_+=";color:"+r.get("buttonTextColor");var w=this;function x(){o.removeChild(i),w._dom=null}Kt(b,"click",x),Kt(y,"click",function(){if(h==null&&c!=null||h!=null&&c==null){x();return}var C;try{ze(h)?C=h(u,n.getOption()):C=bi(d.value,v)}catch(B){throw x(),new Error("Data view format error "+B)}C&&n.dispatchAction({type:"changeDataView",newOption:C}),x()}),b.innerHTML=l[1],y.innerHTML=l[2],y.style.cssText=b.style.cssText=_,!r.get("readOnly")&&g.appendChild(y),g.appendChild(b),i.appendChild(s),i.appendChild(u),i.appendChild(g),u.style.height=o.clientHeight-80+"px",o.appendChild(i),this._dom=i},a.prototype.remove=function(t,n){this._dom&&n.getDom().removeChild(this._dom)},a.prototype.dispose=function(t,n){this.remove(t,n)},a.getDefaultOption=function(t){var n={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:t.getLocaleModel().get(["toolbox","dataView","title"]),lang:t.getLocaleModel().get(["toolbox","dataView","lang"]),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"};return n},a}(ne);function Ci(e,a){return K(e,function(t,n){var o=a&&a[n];if(Be(o)&&!oe(o)){var r=Be(t)&&!oe(t);r||(t={value:t});var i=o.name!=null&&t.name==null;return t=Pe(t,o),i&&delete t.name,t}else return t})}Pt({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(e,a){var t=[];A(e.newOption.series,function(n){var o=a.getSeriesByName(n.name)[0];if(!o)t.push(we({type:"scatter"},n));else{var r=o.get("data");t.push({name:n.name,data:Ci(n.data,r)})}}),a.mergeOption(Pe({series:t},e.newOption))});var Si=xi,fn=A,vn=qa();function wi(e,a){var t=Bt(e);fn(a,function(n,o){for(var r=t.length-1;r>=0;r--){var i=t[r];if(i[o])break}if(r<0){var s=e.queryComponents({mainType:"dataZoom",subType:"select",id:o})[0];if(s){var l=s.getPercentRange();t[0][o]={dataZoomId:o,start:l[0],end:l[1]}}}}),t.push(a)}function Ai(e){var a=Bt(e),t=a[a.length-1];a.length>1&&a.pop();var n={};return fn(t,function(o,r){for(var i=a.length-1;i>=0;i--)if(o=a[i][r],o){n[r]=o;break}}),n}function Ti(e){vn(e).snapshots=null}function Pi(e){return Bt(e).length}function Bt(e){var a=vn(e);return a.snapshots||(a.snapshots=[{}]),a.snapshots}var Di=function(e){N(a,e);function a(){return e!==null&&e.apply(this,arguments)||this}return a.prototype.onclick=function(t,n){Ti(t),n.dispatchAction({type:"restore",from:this.uid})},a.getDefaultOption=function(t){var n={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:t.getLocaleModel().get(["toolbox","restore","title"])};return n},a}(ne);Pt({type:"restore",event:"restore",update:"prepareAndUpdate"},function(e,a){a.resetOption("recreate")});var Oi=Di,Ii=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],Li=function(){function e(a,t,n){var o=this;this._targetInfoList=[];var r=ha(t,a);A(ki,function(i,s){(!n||!n.include||Ve(n.include,s)>=0)&&i(r,o._targetInfoList)})}return e.prototype.setOutputRanges=function(a,t){return this.matchOutputRanges(a,t,function(n,o,r){if((n.coordRanges||(n.coordRanges=[])).push(o),!n.coordRange){n.coordRange=o;var i=nt[n.brushType](0,r,o);n.__rangeOffset={offset:ga[n.brushType](i.values,n.range,[1,1]),xyMinMax:i.xyMinMax}}}),a},e.prototype.matchOutputRanges=function(a,t,n){A(a,function(o){var r=this.findTargetInfo(o,t);r&&r!==!0&&A(r.coordSyses,function(i){var s=nt[o.brushType](1,i,o.range,!0);n(o,s.values,i,t)})},this)},e.prototype.setInputRanges=function(a,t){A(a,function(n){var o=this.findTargetInfo(n,t);if(n.range=n.range||[],o&&o!==!0){n.panelId=o.panelId;var r=nt[n.brushType](0,o.coordSys,n.coordRange),i=n.__rangeOffset;n.range=i?ga[n.brushType](r.values,i.offset,Mi(r.xyMinMax,i.xyMinMax)):r.values}},this)},e.prototype.makePanelOpts=function(a,t){return K(this._targetInfoList,function(n){var o=n.getPanelRect();return{panelId:n.panelId,defaultBrushType:t?t(n):null,clipPath:xr(o),isTargetByCursor:Sr(o,a,n.coordSysModel),getLinearBrushOtherExtent:Cr(o)}})},e.prototype.controlSeries=function(a,t,n){var o=this.findTargetInfo(a,n);return o===!0||o&&Ve(o.coordSyses,t.coordinateSystem)>=0},e.prototype.findTargetInfo=function(a,t){for(var n=this._targetInfoList,o=ha(t,a),r=0;r<n.length;r++){var i=n[r],s=a.panelId;if(s){if(i.panelId===s)return i}else for(var l=0;l<pa.length;l++)if(pa[l](o,i))return i}return!0},e}();function _t(e){return e[0]>e[1]&&e.reverse(),e}function ha(e,a){return Ka(e,a,{includeMainTypes:Ii})}var ki={grid:function(e,a){var t=e.xAxisModels,n=e.yAxisModels,o=e.gridModels,r=ao(),i={},s={};!t&&!n&&!o||(A(t,function(l){var u=l.axis.grid.model;r.set(u.id,u),i[u.id]=!0}),A(n,function(l){var u=l.axis.grid.model;r.set(u.id,u),s[u.id]=!0}),A(o,function(l){r.set(l.id,l),i[l.id]=!0,s[l.id]=!0}),r.each(function(l){var u=l.coordinateSystem,d=[];A(u.getCartesians(),function(c,h){(Ve(t,c.getAxis("x").model)>=0||Ve(n,c.getAxis("y").model)>=0)&&d.push(c)}),a.push({panelId:"grid--"+l.id,gridModel:l,coordSysModel:l,coordSys:d[0],coordSyses:d,getPanelRect:fa.grid,xAxisDeclared:i[l.id],yAxisDeclared:s[l.id]})}))},geo:function(e,a){A(e.geoModels,function(t){var n=t.coordinateSystem;a.push({panelId:"geo--"+t.id,geoModel:t,coordSysModel:t,coordSys:n,coordSyses:[n],getPanelRect:fa.geo})})}},pa=[function(e,a){var t=e.xAxisModel,n=e.yAxisModel,o=e.gridModel;return!o&&t&&(o=t.axis.grid.model),!o&&n&&(o=n.axis.grid.model),o&&o===a.gridModel},function(e,a){var t=e.geoModel;return t&&t===a.geoModel}],fa={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var e=this.coordSys,a=e.getBoundingRect().clone();return a.applyTransform(Ua(e)),a}},nt={lineX:Q(va,0),lineY:Q(va,1),rect:function(e,a,t,n){var o=e?a.pointToData([t[0][0],t[1][0]],n):a.dataToPoint([t[0][0],t[1][0]],n),r=e?a.pointToData([t[0][1],t[1][1]],n):a.dataToPoint([t[0][1],t[1][1]],n),i=[_t([o[0],r[0]]),_t([o[1],r[1]])];return{values:i,xyMinMax:i}},polygon:function(e,a,t,n){var o=[[1/0,-1/0],[1/0,-1/0]],r=K(t,function(i){var s=e?a.pointToData(i,n):a.dataToPoint(i,n);return o[0][0]=Math.min(o[0][0],s[0]),o[1][0]=Math.min(o[1][0],s[1]),o[0][1]=Math.max(o[0][1],s[0]),o[1][1]=Math.max(o[1][1],s[1]),s});return{values:r,xyMinMax:o}}};function va(e,a,t,n){var o=t.getAxis(["x","y"][e]),r=_t(K([0,1],function(s){return a?o.coordToData(o.toLocalCoord(n[s]),!0):o.toGlobalCoord(o.dataToCoord(n[s]))})),i=[];return i[e]=r,i[1-e]=[NaN,NaN],{values:r,xyMinMax:i}}var ga={lineX:Q(ma,0),lineY:Q(ma,1),rect:function(e,a,t){return[[e[0][0]-t[0]*a[0][0],e[0][1]-t[0]*a[0][1]],[e[1][0]-t[1]*a[1][0],e[1][1]-t[1]*a[1][1]]]},polygon:function(e,a,t){return K(e,function(n,o){return[n[0]-t[0]*a[o][0],n[1]-t[1]*a[o][1]]})}};function ma(e,a,t,n){return[a[0]-n[e]*t[0],a[1]-n[e]*t[1]]}function Mi(e,a){var t=ya(e),n=ya(a),o=[t[0]/n[0],t[1]/n[1]];return isNaN(o[0])&&(o[0]=1),isNaN(o[1])&&(o[1]=1),o}function ya(e){return e?[e[0][1]-e[0][0],e[1][1]-e[1][0]]:[NaN,NaN]}var gn=Li,bt=A,Bi=oo("toolbox-dataZoom_"),zi=function(e){N(a,e);function a(){return e!==null&&e.apply(this,arguments)||this}return a.prototype.render=function(t,n,o,r){this._brushController||(this._brushController=new br(o.getZr()),this._brushController.on("brush",se(this._onBrush,this)).mount()),Ri(t,n,this,r,o),Ni(t,n)},a.prototype.onclick=function(t,n,o){Vi[o].call(this)},a.prototype.remove=function(t,n){this._brushController&&this._brushController.unmount()},a.prototype.dispose=function(t,n){this._brushController&&this._brushController.dispose()},a.prototype._onBrush=function(t){var n=t.areas;if(!t.isEnd||!n.length)return;var o={},r=this.ecModel;this._brushController.updateCovers([]);var i=new gn(zt(this.model),r,{include:["grid"]});i.matchOutputRanges(n,r,function(u,d,c){if(c.type==="cartesian2d"){var h=u.brushType;h==="rect"?(s("x",c,d[0]),s("y",c,d[1])):s({lineX:"x",lineY:"y"}[h],c,d)}}),wi(r,o),this._dispatchZoomAction(o);function s(u,d,c){var h=d.getAxis(u),p=h.model,m=l(u,p,r),f=m.findRepresentativeAxisProxy(p).getMinMaxSpan();(f.minValueSpan!=null||f.maxValueSpan!=null)&&(c=Ro(0,c.slice(),h.scale.getExtent(),0,f.minValueSpan,f.maxValueSpan)),m&&(o[m.id]={dataZoomId:m.id,startValue:c[0],endValue:c[1]})}function l(u,d,c){var h;return c.eachComponent({mainType:"dataZoom",subType:"select"},function(p){var m=p.getAxisModel(u,d.componentIndex);m&&(h=p)}),h}},a.prototype._dispatchZoomAction=function(t){var n=[];bt(t,function(o,r){n.push(de(o))}),n.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:n})},a.getDefaultOption=function(t){var n={show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:t.getLocaleModel().get(["toolbox","dataZoom","title"]),brushStyle:{borderWidth:0,color:"rgba(210,219,238,0.2)"}};return n},a}(ne),Vi={zoom:function(){var e=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:e})},back:function(){this._dispatchZoomAction(Ai(this.ecModel))}};function zt(e){var a={xAxisIndex:e.get("xAxisIndex",!0),yAxisIndex:e.get("yAxisIndex",!0),xAxisId:e.get("xAxisId",!0),yAxisId:e.get("yAxisId",!0)};return a.xAxisIndex==null&&a.xAxisId==null&&(a.xAxisIndex="all"),a.yAxisIndex==null&&a.yAxisId==null&&(a.yAxisIndex="all"),a}function Ni(e,a){e.setIconStatus("back",Pi(a)>1?"emphasis":"normal")}function Ri(e,a,t,n,o){var r=t._isZoomActive;n&&n.type==="takeGlobalCursor"&&(r=n.key==="dataZoomSelect"?n.dataZoomSelectActive:!1),t._isZoomActive=r,e.setIconStatus("zoom",r?"emphasis":"normal");var i=new gn(zt(e),a,{include:["grid"]}),s=i.makePanelOpts(o,function(l){return l.xAxisDeclared&&!l.yAxisDeclared?"lineX":!l.xAxisDeclared&&l.yAxisDeclared?"lineY":"rect"});t._brushController.setPanels(s).enableBrush(r&&s.length?{brushType:"auto",brushStyle:e.getModel("brushStyle").getItemStyle()}:!1)}no("dataZoom",function(e){var a=e.getComponent("toolbox",0),t=["feature","dataZoom"];if(!a||a.get(t)==null)return;var n=a.getModel(t),o=[],r=zt(n),i=Ka(e,r);bt(i.xAxisModels,function(l){return s(l,"xAxis","xAxisIndex")}),bt(i.yAxisModels,function(l){return s(l,"yAxis","yAxisIndex")});function s(l,u,d){var c=l.componentIndex,h={type:"select",$fromToolbox:!0,filterMode:n.get("filterMode",!0)||"filter",id:Bi+u+c};h[d]=c,o.push(h)}return o});var $i=zi;function Ei(e){e.registerComponentModel(oi),e.registerComponentView(si),ke("saveAsImage",ui),ke("magicType",hi),ke("dataView",Si),ke("dataZoom",$i),ke("restore",Oi),wt(ai)}var Fi=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t.layoutMode="box",t}return a.prototype.init=function(t,n,o){this.mergeDefaultAndTheme(t,o),this._initData()},a.prototype.mergeOption=function(t){e.prototype.mergeOption.apply(this,arguments),this._initData()},a.prototype.setCurrentIndex=function(t){t==null&&(t=this.option.currentIndex);var n=this._data.count();this.option.loop?t=(t%n+n)%n:(t>=n&&(t=n-1),t<0&&(t=0)),this.option.currentIndex=t},a.prototype.getCurrentIndex=function(){return this.option.currentIndex},a.prototype.isIndexMax=function(){return this.getCurrentIndex()>=this._data.count()-1},a.prototype.setPlayState=function(t){this.option.autoPlay=!!t},a.prototype.getPlayState=function(){return!!this.option.autoPlay},a.prototype._initData=function(){var t=this.option,n=t.data||[],o=t.axisType,r=this._names=[],i;o==="category"?(i=[],A(n,function(u,d){var c=ro(io(u),""),h;Be(u)?(h=de(u),h.value=d):h=d,i.push(h),r.push(c)})):i=n;var s={category:"ordinal",time:"time",value:"number"}[o]||"number",l=this._data=new so([{name:"value",type:s}],this);l.initData(i,r)},a.prototype.getData=function(){return this._data},a.prototype.getCategories=function(){if(this.get("axisType")==="category")return this._names.slice()},a.type="timeline",a.defaultOption={z:4,show:!0,axisType:"time",realtime:!0,left:"20%",top:null,right:"20%",bottom:0,width:null,height:40,padding:5,controlPosition:"left",autoPlay:!1,rewind:!1,loop:!0,playInterval:2e3,currentIndex:0,itemStyle:{},label:{color:"#000"},data:[]},a}(At),_a=Fi,mn=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.type="timeline.slider",a.defaultOption=lo(_a.defaultOption,{backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,orient:"horizontal",inverse:!1,tooltip:{trigger:"item"},symbol:"circle",symbolSize:12,lineStyle:{show:!0,width:2,color:"#DAE1F5"},label:{position:"auto",show:!0,interval:"auto",rotate:0,color:"#A4B1D7"},itemStyle:{color:"#A4B1D7",borderWidth:1},checkpointStyle:{symbol:"circle",symbolSize:15,color:"#316bf3",borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0, 0, 0, 0.3)",animation:!0,animationDuration:300,animationEasing:"quinticInOut"},controlStyle:{show:!0,showPlayBtn:!0,showPrevBtn:!0,showNextBtn:!0,itemSize:24,itemGap:12,position:"left",playIcon:"path://M31.6,53C17.5,53,6,41.5,6,27.4S17.5,1.8,31.6,1.8C45.7,1.8,57.2,13.3,57.2,27.4S45.7,53,31.6,53z M31.6,3.3 C18.4,3.3,7.5,14.1,7.5,27.4c0,13.3,10.8,24.1,24.1,24.1C44.9,51.5,55.7,40.7,55.7,27.4C55.7,14.1,44.9,3.3,31.6,3.3z M24.9,21.3 c0-2.2,1.6-3.1,3.5-2l10.5,6.1c1.899,1.1,1.899,2.9,0,4l-10.5,6.1c-1.9,1.1-3.5,0.2-3.5-2V21.3z",stopIcon:"path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z",nextIcon:"M2,18.5A1.52,1.52,0,0,1,.92,18a1.49,1.49,0,0,1,0-2.12L7.81,9.36,1,3.11A1.5,1.5,0,1,1,3,.89l8,7.34a1.48,1.48,0,0,1,.49,1.09,1.51,1.51,0,0,1-.46,1.1L3,18.08A1.5,1.5,0,0,1,2,18.5Z",prevIcon:"M10,.5A1.52,1.52,0,0,1,11.08,1a1.49,1.49,0,0,1,0,2.12L4.19,9.64,11,15.89a1.5,1.5,0,1,1-2,2.22L1,10.77A1.48,1.48,0,0,1,.5,9.68,1.51,1.51,0,0,1,1,8.58L9,.92A1.5,1.5,0,0,1,10,.5Z",prevBtnSize:18,nextBtnSize:18,color:"#A4B1D7",borderColor:"#A4B1D7",borderWidth:1},emphasis:{label:{show:!0,color:"#6f778d"},itemStyle:{color:"#316BF3"},controlStyle:{color:"#316BF3",borderColor:"#316BF3",borderWidth:2}},progress:{lineStyle:{color:"#316BF3"},itemStyle:{color:"#316BF3"},label:{color:"#6f778d"}},data:[]}),a}(_a);Ha(mn,uo.prototype);var Wi=mn,Zi=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.type="timeline",a}(Tt),Ui=Zi,Hi=function(e){N(a,e);function a(t,n,o,r){var i=e.call(this,t,n,o)||this;return i.type=r||"value",i}return a.prototype.getLabelModel=function(){return this.model.getModel("label")},a.prototype.isHorizontal=function(){return this.model.get("orient")==="horizontal"},a}($o),Gi=Hi,ot=Math.PI,ba=qa(),ji=function(e){N(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;return t.type=a.type,t}return a.prototype.init=function(t,n){this.api=n},a.prototype.render=function(t,n,o){if(this.model=t,this.api=o,this.ecModel=n,this.group.removeAll(),t.get("show",!0)){var r=this._layout(t,o),i=this._createGroup("_mainGroup"),s=this._createGroup("_labelGroup"),l=this._axis=this._createAxis(r,t);t.formatTooltip=function(u){var d=l.scale.getLabel({value:u});return co("nameValue",{noName:!0,value:d})},A(["AxisLine","AxisTick","Control","CurrentPointer"],function(u){this["_render"+u](r,i,l,t)},this),this._renderAxisLabel(r,s,l,t),this._position(r,t)}this._doPlayStop(),this._updateTicksStatus()},a.prototype.remove=function(){this._clearTimer(),this.group.removeAll()},a.prototype.dispose=function(){this._clearTimer()},a.prototype._layout=function(t,n){var o=t.get(["label","position"]),r=t.get("orient"),i=qi(t,n),s;o==null||o==="auto"?s=r==="horizontal"?i.y+i.height/2<n.getHeight()/2?"-":"+":i.x+i.width/2<n.getWidth()/2?"+":"-":he(o)?s={horizontal:{top:"-",bottom:"+"},vertical:{left:"-",right:"+"}}[r][o]:s=o;var l={horizontal:"center",vertical:s>=0||s==="+"?"left":"right"},u={horizontal:s>=0||s==="+"?"top":"bottom",vertical:"middle"},d={horizontal:0,vertical:ot/2},c=r==="vertical"?i.height:i.width,h=t.getModel("controlStyle"),p=h.get("show",!0),m=p?h.get("itemSize"):0,f=p?h.get("itemGap"):0,v=m+f,g=t.get(["label","rotate"])||0;g=g*ot/180;var _,b,y,w=h.get("position",!0),x=p&&h.get("showPlayBtn",!0),C=p&&h.get("showPrevBtn",!0),B=p&&h.get("showNextBtn",!0),k=0,I=c;w==="left"||w==="bottom"?(x&&(_=[0,0],k+=v),C&&(b=[k,0],k+=v),B&&(y=[I-m,0],I-=v)):(x&&(_=[I-m,0],I-=v),C&&(b=[0,0],k+=v),B&&(y=[I-m,0],I-=v));var M=[k,I];return t.get("inverse")&&M.reverse(),{viewRect:i,mainLength:c,orient:r,rotation:d[r],labelRotation:g,labelPosOpt:s,labelAlign:t.get(["label","align"])||l[r],labelBaseline:t.get(["label","verticalAlign"])||t.get(["label","baseline"])||u[r],playPosition:_,prevBtnPosition:b,nextBtnPosition:y,axisExtent:M,controlSize:m,controlGap:f}},a.prototype._position=function(t,n){var o=this._mainGroup,r=this._labelGroup,i=t.viewRect;if(t.orient==="vertical"){var s=xo(),l=i.x,u=i.y+i.height;Xt(s,s,[-l,-u]),ho(s,s,-ot/2),Xt(s,s,[l,u]),i=i.clone(),i.applyTransform(s)}var d=_(i),c=_(o.getBoundingRect()),h=_(r.getBoundingRect()),p=[o.x,o.y],m=[r.x,r.y];m[0]=p[0]=d[0][0];var f=t.labelPosOpt;if(f==null||he(f)){var v=f==="+"?0:1;b(p,c,d,1,v),b(m,h,d,1,1-v)}else{var v=f>=0?0:1;b(p,c,d,1,v),m[1]=p[1]+f}o.setPosition(p),r.setPosition(m),o.rotation=r.rotation=t.rotation,g(o),g(r);function g(y){y.originX=d[0][0]-y.x,y.originY=d[1][0]-y.y}function _(y){return[[y.x,y.x+y.width],[y.y,y.y+y.height]]}function b(y,w,x,C,B){y[C]+=x[C][B]-w[C][B]}},a.prototype._createAxis=function(t,n){var o=n.getData(),r=n.get("axisType"),i=Yi(n,r);i.getTicks=function(){return o.mapArray(["value"],function(u){return{value:u}})};var s=o.getDataExtent("value");i.setExtent(s[0],s[1]),i.calcNiceTicks();var l=new Gi("value",i,t.axisExtent,r);return l.model=n,l},a.prototype._createGroup=function(t){var n=this[t]=new $e;return this.group.add(n),n},a.prototype._renderAxisLine=function(t,n,o,r){var i=o.getExtent();if(!!r.get(["lineStyle","show"])){var s=new Jt({shape:{x1:i[0],y1:0,x2:i[1],y2:0},style:we({lineCap:"round"},r.getModel("lineStyle").getLineStyle()),silent:!0,z2:1});n.add(s);var l=this._progressLine=new Jt({shape:{x1:i[0],x2:this._currentPointer?this._currentPointer.x:i[0],y1:0,y2:0},style:Pe({lineCap:"round",lineWidth:s.style.lineWidth},r.getModel(["progress","lineStyle"]).getLineStyle()),silent:!0,z2:1});n.add(l)}},a.prototype._renderAxisTick=function(t,n,o,r){var i=this,s=r.getData(),l=o.scale.getTicks();this._tickSymbols=[],A(l,function(u){var d=o.dataToCoord(u.value),c=s.getItemModel(u.value),h=c.getModel("itemStyle"),p=c.getModel(["emphasis","itemStyle"]),m=c.getModel(["progress","itemStyle"]),f={x:d,y:0,onclick:se(i._changeTimeline,i,u.value)},v=xa(c,h,n,f);v.ensureState("emphasis").style=p.getItemStyle(),v.ensureState("progress").style=m.getItemStyle(),Xe(v);var g=Ea(v);c.get("tooltip")?(g.dataIndex=u.value,g.dataModel=r):g.dataIndex=g.dataModel=null,i._tickSymbols.push(v)})},a.prototype._renderAxisLabel=function(t,n,o,r){var i=this,s=o.getLabelModel();if(!!s.get("show")){var l=r.getData(),u=o.getViewLabels();this._tickLabels=[],A(u,function(d){var c=d.tickValue,h=l.getItemModel(c),p=h.getModel("label"),m=h.getModel(["emphasis","label"]),f=h.getModel(["progress","label"]),v=o.dataToCoord(d.tickValue),g=new Ce({x:v,y:0,rotation:t.labelRotation-t.rotation,onclick:se(i._changeTimeline,i,c),silent:!1,style:Se(p,{text:d.formattedLabel,align:t.labelAlign,verticalAlign:t.labelBaseline})});g.ensureState("emphasis").style=Se(m),g.ensureState("progress").style=Se(f),n.add(g),Xe(g),ba(g).dataIndex=c,i._tickLabels.push(g)})}},a.prototype._renderControl=function(t,n,o,r){var i=t.controlSize,s=t.rotation,l=r.getModel("controlStyle").getItemStyle(),u=r.getModel(["emphasis","controlStyle"]).getItemStyle(),d=r.getPlayState(),c=r.get("inverse",!0);h(t.nextBtnPosition,"next",se(this._changeTimeline,this,c?"-":"+")),h(t.prevBtnPosition,"prev",se(this._changeTimeline,this,c?"+":"-")),h(t.playPosition,d?"stop":"play",se(this._handlePlayClick,this,!d),!0);function h(p,m,f,v){if(!!p){var g=po(ht(r.get(["controlStyle",m+"BtnSize"]),i),i),_=[0,-g/2,g,g],b=Ki(r,m+"Icon",_,{x:p[0],y:p[1],originX:i/2,originY:0,rotation:v?-s:0,rectHover:!0,style:l,onclick:f});b.ensureState("emphasis").style=u,n.add(b),Xe(b)}}},a.prototype._renderCurrentPointer=function(t,n,o,r){var i=r.getData(),s=r.getCurrentIndex(),l=i.getItemModel(s).getModel("checkpointStyle"),u=this,d={onCreate:function(c){c.draggable=!0,c.drift=se(u._handlePointerDrag,u),c.ondragend=se(u._handlePointerDragend,u),Ca(c,u._progressLine,s,o,r,!0)},onUpdate:function(c){Ca(c,u._progressLine,s,o,r)}};this._currentPointer=xa(l,l,this._mainGroup,{},this._currentPointer,d)},a.prototype._handlePlayClick=function(t){this._clearTimer(),this.api.dispatchAction({type:"timelinePlayChange",playState:t,from:this.uid})},a.prototype._handlePointerDrag=function(t,n,o){this._clearTimer(),this._pointerChangeTimeline([o.offsetX,o.offsetY])},a.prototype._handlePointerDragend=function(t){this._pointerChangeTimeline([t.offsetX,t.offsetY],!0)},a.prototype._pointerChangeTimeline=function(t,n){var o=this._toAxisCoord(t)[0],r=this._axis,i=fo(r.getExtent().slice());o>i[1]&&(o=i[1]),o<i[0]&&(o=i[0]),this._currentPointer.x=o,this._currentPointer.markRedraw();var s=this._progressLine;s&&(s.shape.x2=o,s.dirty());var l=this._findNearestTick(o),u=this.model;(n||l!==u.getCurrentIndex()&&u.get("realtime"))&&this._changeTimeline(l)},a.prototype._doPlayStop=function(){var t=this;this._clearTimer(),this.model.getPlayState()&&(this._timer=setTimeout(function(){var n=t.model;t._changeTimeline(n.getCurrentIndex()+(n.get("rewind",!0)?-1:1))},this.model.get("playInterval")))},a.prototype._toAxisCoord=function(t){var n=this._mainGroup.getLocalTransform();return vo(t,n,!0)},a.prototype._findNearestTick=function(t){var n=this.model.getData(),o=1/0,r,i=this._axis;return n.each(["value"],function(s,l){var u=i.dataToCoord(s),d=Math.abs(u-t);d<o&&(o=d,r=l)}),r},a.prototype._clearTimer=function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},a.prototype._changeTimeline=function(t){var n=this.model.getCurrentIndex();t==="+"?t=n+1:t==="-"&&(t=n-1),this.api.dispatchAction({type:"timelineChange",currentIndex:t,from:this.uid})},a.prototype._updateTicksStatus=function(){var t=this.model.getCurrentIndex(),n=this._tickSymbols,o=this._tickLabels;if(n)for(var r=0;r<n.length;r++)n&&n[r]&&n[r].toggleState("progress",r<t);if(o)for(var r=0;r<o.length;r++)o&&o[r]&&o[r].toggleState("progress",ba(o[r]).dataIndex<=t)},a.type="timeline.slider",a}(Ui);function Yi(e,a){if(a=a||e.get("type"),a)switch(a){case"category":return new yo({ordinalMeta:e.getCategories(),extent:[1/0,-1/0]});case"time":return new mo({locale:e.ecModel.getLocaleModel(),useUTC:e.ecModel.get("useUTC")});default:return new go}}function qi(e,a){return ja(e.getBoxLayoutParams(),{width:a.getWidth(),height:a.getHeight()},e.get("padding"))}function Ki(e,a,t,n){var o=n.style,r=Ya(e.get(["controlStyle",a]),n||{},new Ct(t[0],t[1],t[2],t[3]));return o&&r.setStyle(o),r}function xa(e,a,t,n,o,r){var i=a.get("color");if(o)o.setColor(i),t.add(o),r&&r.onUpdate(o);else{var s=e.get("symbol");o=$a(s,-1,-1,2,2,i),o.setStyle("strokeNoScale",!0),t.add(o),r&&r.onCreate(o)}var l=a.getItemStyle(["color"]);o.setStyle(l),n=ce({rectHover:!0,z2:100},n,!0);var u=_o(e.get("symbolSize"));n.scaleX=u[0]/2,n.scaleY=u[1]/2;var d=bo(e.get("symbolOffset"),u);d&&(n.x=(n.x||0)+d[0],n.y=(n.y||0)+d[1]);var c=e.get("symbolRotate");return n.rotation=(c||0)*Math.PI/180||0,o.attr(n),o.updateTransform(),o}function Ca(e,a,t,n,o,r){if(!e.dragging){var i=o.getModel("checkpointStyle"),s=n.dataToCoord(o.getData().get("value",t));if(r||!i.get("animation",!0))e.attr({x:s,y:0}),a&&a.attr({shape:{x2:s}});else{var l={duration:i.get("animationDuration",!0),easing:i.get("animationEasing",!0)};e.stopAnimation(null,!0),e.animateTo({x:s,y:0},l),a&&a.animateTo({shape:{x2:s}},l)}}}var Xi=ji;function Ji(e){e.registerAction({type:"timelineChange",event:"timelineChanged",update:"prepareAndUpdate"},function(a,t,n){var o=t.getComponent("timeline");return o&&a.currentIndex!=null&&(o.setCurrentIndex(a.currentIndex),!o.get("loop",!0)&&o.isIndexMax()&&o.getPlayState()&&(o.setPlayState(!1),n.dispatchAction({type:"timelinePlayChange",playState:!1,from:a.from}))),t.resetOption("timeline",{replaceMerge:o.get("replaceMerge",!0)}),Pe({currentIndex:o.option.currentIndex},a)}),e.registerAction({type:"timelinePlayChange",event:"timelinePlayChanged",update:"update"},function(a,t){var n=t.getComponent("timeline");n&&a.playState!=null&&n.setPlayState(a.playState)})}function Qi(e){var a=e&&e.timeline;oe(a)||(a=a?[a]:[]),A(a,function(t){!t||es(t)})}function es(e){var a=e.type,t={number:"value",time:"time"};if(t[a]&&(e.axisType=t[a],delete e.type),Sa(e),ge(e,"controlPosition")){var n=e.controlStyle||(e.controlStyle={});ge(n,"position")||(n.position=e.controlPosition),n.position==="none"&&!ge(n,"show")&&(n.show=!1,delete n.position),delete e.controlPosition}A(e.data||[],function(o){Be(o)&&!oe(o)&&(!ge(o,"value")&&ge(o,"name")&&(o.value=o.name),Sa(o))})}function Sa(e){var a=e.itemStyle||(e.itemStyle={}),t=a.emphasis||(a.emphasis={}),n=e.label||e.label||{},o=n.normal||(n.normal={}),r={normal:1,emphasis:1};A(n,function(i,s){!r[s]&&!ge(o,s)&&(o[s]=i)}),t.label&&!ge(n,"emphasis")&&(n.emphasis=t.label,delete t.label)}function ge(e,a){return e.hasOwnProperty(a)}function ts(e){e.registerComponentModel(Wi),e.registerComponentView(Xi),e.registerSubTypeDefaulter("timeline",function(){return"slider"}),Ji(e),e.registerPreprocessor(Qi)}function Ze(){return`#${(Math.random()*16777215<<0).toString(16)}`}function as(e,a){const t=e.indexOf("open"),n=e.indexOf("close"),o=e.indexOf("high"),r=e.indexOf("low");let i;return a.map((s,l)=>{const u=s.slice(),d=l===0?(u[t]+u[n])/2:(i[t]+i[n])/2,c=(u[t]+u[o]+u[r]+u[n])/4,h=Math.max(u[o],u[t],u[n]),p=Math.min(u[r],u[t],u[n]);return u[t]=d,u[n]=c,u[o]=h,u[r]=p,i=u.slice(),u})}const ns=2,os=3;function be(e,a,t=os){const n=a%e;return a-n+(t===ns?e:0)}function yn(e,a){var t;return`${a.ft_order_side==="buy"?"+":"-"}${wn("cost"in a?a.cost:a.amount*a.safe_price,(t=e.quote_currency)!=null?t:"<stake_currency>")}`}function wa(e,a,t){var n,o;return`${e.is_short?"Short":"Long"} ${t}  ${Ma(e.profit_ratio)}
  ${yn(e,a)}
  Enter-tag: ${(n=e.enter_tag)!=null?n:""}
  Exit-Tag: ${(o=e.exit_reason)!=null?o:""}`}function rs(e,a){var t;return`${e.is_short?"Short":"Long"} adjustment
  ${yn(e,a)}
  Enter-tag: ${(t=e.enter_tag)!=null?t:""}`}const is="path://m 52.444161,104.1909 8.386653,25.34314 8.386651,25.34313 -16.731501,0.0422 -16.731501,0.0422 8.344848,-25.38539 z m 0.08656,-48.368126 8.386652,25.343139 8.386652,25.343137 -16.731501,0.0422 -16.731502,0.0422 8.344848,-25.385389 z",Aa="path://m 102.20764,19.885384 h 24.1454 v 41.928829 h -24.1454 z m 12.17344,36.423813 8.38665,25.343139 8.38666,25.343134 -16.7315,0.0422 -16.731507,0.0422 8.344847,-25.385386 z",rt="#AD00FF",it="#0066FF";function ss(e,a){var n,o,r,i,s,l;const t=[];for(let u=0,d=a.length;u<d;u+=1){const c=a[u];if((be((n=e.timeframe_ms)!=null?n:0,c.open_timestamp)<=e.data_stop_ts||!c.close_timestamp||c.close_timestamp&&c.close_timestamp>=e.data_start_ts)&&c.orders)for(let h=0;h<c.orders.length;h++){const p=c.orders[h];p.order_filled_timestamp&&be((o=e.timeframe_ms)!=null?o:0,p.order_filled_timestamp)<=e.data_stop_ts&&p.order_filled_timestamp>e.data_start_ts&&(h===0?t.push([be((r=e.timeframe_ms)!=null?r:0,c.open_timestamp),p.safe_price,Aa,p.ft_order_side=="sell"?180:0,c.is_short?rt:it,c.is_short?"Short":"Long",wa(c,p,"entry")]):h===c.orders.length-1&&c.close_timestamp?be((i=e.timeframe_ms)!=null?i:0,c.close_timestamp)<=e.data_stop_ts&&c.close_timestamp>e.data_start_ts&&c.is_open===!1&&t.push([be((s=e.timeframe_ms)!=null?s:0,c.close_timestamp),p.safe_price,Aa,c.is_short?0:180,c.is_short?rt:it,Ma(c.profit_ratio,2),wa(c,p,"exit")]):t.push([be((l=e.timeframe_ms)!=null?l:0,p.order_filled_timestamp),p.safe_price,is,p.ft_order_side=="sell"?180:0,c.is_short?rt:it,"",rs(c,p)]))}}return{tradeData:t}}wt([So,Xr,wo,Eo,Fo,Ao,ts,To,Ei,Po,Wo,Zo,Ur,Uo,Ho,tr,Do]);const st="5.5%",lt="1%",Ta=55,Me=8,ls="#26A69A",us="#26A69A",cs="#EF5350",ds="#EF5350",hs="#00ff26",ps="#00ff26",fs="#faba25",vs="#faba25",gs=Ge({name:"CandleChart",components:{"v-chart":Co},props:{trades:{required:!1,default:()=>[],type:Array},dataset:{required:!0,type:Object},heikinAshi:{required:!1,default:!1,type:Boolean},useUTC:{required:!1,default:!0,type:Boolean},plotConfig:{required:!0,type:Object},theme:{default:"dark",type:String},sliderPosition:{required:!1,type:Object,default:()=>{}}},setup(e){const a=R(),t=R([]),n=R([]),o=R({}),r=E(()=>e.dataset?e.dataset.strategy:""),i=E(()=>e.dataset?e.dataset.pair:""),s=E(()=>e.dataset?e.dataset.timeframe:""),l=E(()=>e.dataset?e.dataset.columns:[]),u=E(()=>e.dataset!==null&&typeof e.dataset=="object"),d=E(()=>e.trades.filter(f=>f.pair===i.value)),c=E(()=>`${r.value} - ${i.value} - ${s.value}`),h=(f=!1)=>{var ee,fe,_e,$;if(!u.value)return;(ee=o.value)!=null&&ee.title&&(o.value.title[0].text=c.value);const v=e.dataset.columns.findIndex(S=>S==="__date_ts"),g=e.dataset.columns.findIndex(S=>S==="open"),_=e.dataset.columns.findIndex(S=>S==="high"),b=e.dataset.columns.findIndex(S=>S==="low"),y=e.dataset.columns.findIndex(S=>S==="close"),w=e.dataset.columns.findIndex(S=>S==="volume"),x=e.dataset.columns.findIndex(S=>S==="_buy_signal_close"||S==="_enter_long_signal_close"),C=e.dataset.columns.findIndex(S=>S==="_sell_signal_close"||S==="_exit_long_signal_close"),B=e.dataset.columns.findIndex(S=>S==="_enter_short_signal_close"),k=e.dataset.columns.findIndex(S=>S==="_exit_short_signal_close"),I="subplots"in e.plotConfig?Object.keys(e.plotConfig.subplots).length+1:1;if(Array.isArray((fe=o.value)==null?void 0:fe.dataZoom))if(f){const S=(1-250/e.dataset.length)*100;o.value.dataZoom.forEach((G,j)=>{o.value&&o.value.dataZoom&&(o.value.dataZoom[j].start=S)})}else o.value.dataZoom.forEach((S,G)=>{o.value&&o.value.dataZoom&&(delete o.value.dataZoom[G].start,delete o.value.dataZoom[G].end)});const M=e.heikinAshi?as(l.value,e.dataset.data):e.dataset.data.slice(),O=Array(M.length>0?M[M.length-2].length:0);O[v]=M[M.length-1][v]+e.dataset.timeframe_ms*3,M.push(O);const F={dataset:{source:M},grid:[{left:st,right:lt,bottom:`${I*Me+2}%`},{left:st,right:lt,bottom:`${I*Me}%`,height:`${Me}%`}],series:[{name:"Candles",type:"candlestick",barWidth:"80%",itemStyle:{color:ls,color0:cs,borderColor:us,borderColor0:ds},encode:{x:v,y:[g,y,b,_]}},{name:"Volume",type:"bar",xAxisIndex:1,yAxisIndex:1,itemStyle:{color:"#777777"},large:!0,encode:{x:v,y:w}},{name:"Entry",type:"scatter",symbol:"triangle",symbolSize:10,xAxisIndex:0,yAxisIndex:0,itemStyle:{color:hs},encode:{x:v,y:x}}]};if(C>=0&&Array.isArray(F.series)&&F.series.push({name:"Exit",type:"scatter",symbol:"diamond",symbolSize:8,xAxisIndex:0,yAxisIndex:0,itemStyle:{color:fs},encode:{x:v,y:C}}),Array.isArray(F.series)&&(B>=0&&F.series.push({name:"Entry",type:"scatter",symbol:"triangle",symbolRotate:180,symbolSize:10,xAxisIndex:0,yAxisIndex:0,itemStyle:{color:ps},tooltip:{},encode:{x:v,y:B}}),k>=0&&F.series.push({name:"Exit",type:"scatter",symbol:"pin",symbolSize:8,xAxisIndex:0,yAxisIndex:0,itemStyle:{color:vs},tooltip:{},encode:{x:v,y:k}})),Object.assign(o.value,F),"main_plot"in e.plotConfig&&Object.entries(e.plotConfig.main_plot).forEach(([S,G])=>{var Y,U,De,Oe,Ie;const j=e.dataset.columns.findIndex(ve=>ve===S);if(j>1){!Array.isArray((Y=o.value)==null?void 0:Y.legend)&&((De=(U=o.value)==null?void 0:U.legend)==null?void 0:De.data)&&o.value.legend.data.push(S);const ve={name:S,type:G.type||"line",xAxisIndex:0,yAxisIndex:0,itemStyle:{color:G.color},encode:{x:v,y:j},showSymbol:!1};Array.isArray((Oe=o.value)==null?void 0:Oe.series)&&((Ie=o.value)==null||Ie.series.push(ve))}else console.log(`element ${S} for main plot not found in columns.`)}),"subplots"in e.plotConfig){let S=2;Object.entries(e.plotConfig.subplots).forEach(([G,j])=>{const Y=S;Array.isArray(o.value.yAxis)&&o.value.yAxis.length<=S&&o.value.yAxis.push({scale:!0,gridIndex:Y,name:G,nameLocation:"middle",nameGap:Ta,axisLabel:{show:!0},axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1}}),Array.isArray(o.value.xAxis)&&o.value.xAxis.length<=S&&o.value.xAxis.push({type:"time",scale:!0,gridIndex:Y,boundaryGap:!1,axisLine:{onZero:!1},axisTick:{show:!1},axisLabel:{show:!1},axisPointer:{label:{show:!1}},splitLine:{show:!1},splitNumber:20}),Array.isArray(o.value.dataZoom)&&o.value.dataZoom.forEach(U=>U.xAxisIndex&&Array.isArray(U.xAxisIndex)?U.xAxisIndex.push(S):null),o.value.grid&&Array.isArray(o.value.grid)&&o.value.grid.push({left:st,right:lt,bottom:`${(I-S+1)*Me}%`,height:`${Me}%`}),Object.entries(j).forEach(([U,De])=>{var Ie;const Oe=e.dataset.columns.findIndex(ve=>ve===U);if(Oe>0){!Array.isArray(o.value.legend)&&((Ie=o.value.legend)==null?void 0:Ie.data)&&o.value.legend.data.push(U);const ve={name:U,type:De.type||"line",xAxisIndex:S,yAxisIndex:S,itemStyle:{color:De.color||Ze()},encode:{x:v,y:Oe},showSymbol:!1};o.value.series&&Array.isArray(o.value.series)&&o.value.series.push(ve)}else console.log(`element ${U} was not found in the columns.`)}),S+=1})}Array.isArray(o.value.grid)&&(o.value.grid[o.value.grid.length-1].bottom="50px",delete o.value.grid[o.value.grid.length-1].top);const{tradeData:X}=ss(e.dataset,d.value),pe="Trades";!Array.isArray(o.value.legend)&&((_e=o.value.legend)==null?void 0:_e.data)&&o.value.legend.data.push(pe);const q={name:pe,type:"scatter",xAxisIndex:0,yAxisIndex:0,encode:{x:0,y:1,label:5,tooltip:6},label:{show:!0,fontSize:12,backgroundColor:e.theme!=="dark"?"#fff":"#000",padding:2,color:e.theme==="dark"?"#fff":"#000"},labelLayout:{rotate:75,align:"left",dx:10},itemStyle:{color:S=>S.data[4],opacity:.9},symbol:S=>S[2],symbolRotate:S=>S[3],symbolSize:13,data:X};Array.isArray(o.value.series)&&o.value.series.push(q),($=a.value)==null||$.setOption(o.value,{replaceMerge:["series","grid","yAxis","xAxis","legend"],noMerge:!f})},p=()=>{var f;(f=a.value)==null||f.setOption({},{noMerge:!0}),o.value={title:[{show:!1}],backgroundColor:"rgba(0, 0, 0, 0)",useUTC:e.useUTC,animation:!1,legend:{data:["Candles","Volume","Entry","Exit"],right:"1%"},tooltip:{show:!0,trigger:"axis",renderMode:"richText",backgroundColor:"rgba(80,80,80,0.7)",borderWidth:0,textStyle:{color:"#fff"},axisPointer:{type:"cross",lineStyle:{color:"#cccccc",width:1,opacity:1}},position(v,g,_,b,y){const w={top:60},x=v[0]<y.viewSize[0]/2;return w[["left","right"][+x]]=x?5:60,w}},axisPointer:{link:[{xAxisIndex:"all"}],label:{backgroundColor:"#777"}},xAxis:[{type:"time",scale:!0,boundaryGap:!1,axisLine:{onZero:!1},axisTick:{show:!0},axisLabel:{show:!0},axisPointer:{label:{show:!1}},position:"top",splitLine:{show:!1},splitNumber:20,min:"dataMin",max:"dataMax"},{type:"time",gridIndex:1,scale:!0,boundaryGap:!1,axisLine:{onZero:!1},axisTick:{show:!1},axisLabel:{show:!1},axisPointer:{label:{show:!1}},splitLine:{show:!1},splitNumber:20,min:"dataMin",max:"dataMax"}],yAxis:[{scale:!0},{scale:!0,gridIndex:1,splitNumber:2,name:"volume",nameLocation:"middle",nameGap:Ta,axisLabel:{show:!1},axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1}}],dataZoom:[{type:"inside",xAxisIndex:[0,1],start:80,end:100},{show:!0,xAxisIndex:[0,1],type:"slider",bottom:10,start:80,end:100}]},console.log("Initialized"),h(!0)},m=()=>{if(!e.sliderPosition)return;const f=$t(e.sliderPosition.startValue-e.dataset.timeframe_ms*40,"yyyy-MM-dd HH:mm:ss"),v=$t(e.sliderPosition.endValue?e.sliderPosition.endValue+e.dataset.timeframe_ms*40:e.sliderPosition.startValue+e.dataset.timeframe_ms*80,"yyyy-MM-dd HH:mm:ss");a.value&&a.value.dispatchAction({type:"dataZoom",dataZoomIndex:0,startValue:f,endValue:v})};return xt(()=>{p()}),ue(()=>e.useUTC,()=>p()),ue(()=>e.dataset,()=>h()),ue(()=>e.plotConfig,()=>p()),ue(()=>e.heikinAshi,()=>h()),ue(()=>e.sliderPosition,()=>m()),{candleChart:a,buyData:t,sellData:n,strategy:r,pair:i,timeframe:s,datasetColumns:l,hasData:u,filteredTrades:d,chartTitle:c}}}),ms={class:"d-flex flex-grow-1 chart-wrapper"};function ys(e,a,t,n,o,r){const i=W("v-chart");return P(),z("div",ms,[e.hasData?(P(),J(i,{key:0,ref:"candleChart",theme:e.theme,autoresize:"","manual-update":""},null,8,["theme"])):Z("",!0)])}var _s=Re(gs,[["render",ys],["__scopeId","data-v-9311de8a"]]);const _n="ft_custom_plot_config",bn="ft_selected_plot_config";function bs(){return localStorage.getItem(bn)||"default"}function xn(e){localStorage.setItem(bn,e)}function Vt(){return JSON.parse(localStorage.getItem(_n)||"{}")}function Pa(){return Object.keys(Vt())}function Cn(e){const a=Vt();return e in a?a[e]:{...Ue}}function xs(e){const t={...Vt(),...e};localStorage.setItem(_n,JSON.stringify(t)),xn(Object.keys(e)[0])}const Cs={name:"CloseCircleOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Ss=["aria-hidden","aria-label"],ws=["fill","width","height"],As={d:"M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22C17.53,22 22,17.53 22,12C22,6.47 17.53,2 12,2M14.59,8L12,10.59L9.41,8L8,9.41L10.59,12L8,14.59L9.41,16L12,13.41L14.59,16L16,14.59L13.41,12L16,9.41L14.59,8Z"},Ts={key:0};function Ps(e,a,t,n,o,r){return P(),z("span",ut(e.$attrs,{"aria-hidden":!t.title,"aria-label":t.title,class:"material-design-icon close-circle-outline-icon",role:"img",onClick:a[0]||(a[0]=i=>e.$emit("click",i))}),[(P(),z("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[V("path",As,[t.title?(P(),z("title",Ts,ie(t.title),1)):Z("",!0)])],8,ws))],16,Ss)}var Ds=Re(Cs,[["render",Ps]]);const Os=e=>(Ba("data-v-0ff81b08"),e=e(),za(),e),Is={key:0},Ls=Os(()=>V("hr",null,null,-1)),ks={class:"d-flex d-flex-columns"},Ms=Ge({__name:"PlotIndicator",props:{modelValue:{required:!0,type:Object},columns:{required:!0,type:Array},addNew:{required:!0,type:Boolean}},emits:["update:modelValue"],setup(e,{emit:a}){const t=e,n=R(Ze()),o=R(We.line),r=R(Object.keys(We)),i=R(""),s=R(""),l=R(!1),u=E(()=>t.columns.filter(m=>m.toLowerCase().includes(i.value.toLowerCase()))),d=()=>{n.value=Ze()},c=E(()=>l.value||!s.value?{}:{[s.value]:{color:n.value,type:o.value}}),h=()=>{a("update:modelValue",c.value)},p=()=>{l.value=!0,h()};return ue(()=>t.modelValue,()=>{[s.value]=Object.keys(t.modelValue),l.value=!1,s.value&&t.modelValue&&(n.value=t.modelValue[s.value].color||Ze(),o.value=t.modelValue[s.value].type||We.line)}),ue(n,()=>{t.addNew||h()}),(m,f)=>{const v=W("b-form-input"),g=W("b-input-group-append"),_=W("b-input-group"),b=W("b-form-select"),y=W("b-form-group"),w=W("b-input-group-prepend"),x=W("b-button");return P(),z("div",null,[e.addNew?(P(),z("div",Is,[T(y,{label:"Add indicator","label-for":"indicatorSelector"},{default:L(()=>[T(_,{size:"sm"},{default:L(()=>[T(v,{modelValue:i.value,"onUpdate:modelValue":f[0]||(f[0]=C=>i.value=C),placeholder:"Filter indicators"},null,8,["modelValue"]),T(g,null,{default:L(()=>[T(Ds,{class:"pointer align-self-center ms-1",size:18,onClick:f[1]||(f[1]=C=>i.value="")})]),_:1})]),_:1}),T(b,{id:"indicatorSelector",modelValue:s.value,"onUpdate:modelValue":f[2]||(f[2]=C=>s.value=C),options:D(u),"select-size":4},null,8,["modelValue","options"])]),_:1})])):Z("",!0),T(y,{label:"Type","label-for":"plotTypeSelector"},{default:L(()=>[T(b,{id:"plotTypeSelector",modelValue:o.value,"onUpdate:modelValue":f[3]||(f[3]=C=>o.value=C),size:"sm",options:r.value,onChange:f[4]||(f[4]=C=>h())},null,8,["modelValue","options"])]),_:1}),Ls,T(y,{label:"Color","label-for":"colsel",size:"sm"},{default:L(()=>[T(_,null,{default:L(()=>[T(w,null,{default:L(()=>[V("div",{style:An({"background-color":n.value}),class:"colorbox me-2"},null,4)]),_:1}),T(v,{id:"colsel",modelValue:n.value,"onUpdate:modelValue":f[5]||(f[5]=C=>n.value=C),size:"sm"},null,8,["modelValue"]),T(g,null,{default:L(()=>[T(x,{variant:"primary",size:"sm",onClick:d},{default:L(()=>[H("\u21BB")]),_:1})]),_:1})]),_:1})]),_:1}),V("div",ks,[e.addNew?(P(),J(x,{key:0,class:"flex-grow-1",variant:"primary",title:"Add ",size:"sm",onClick:h},{default:L(()=>[H(" Save indicator ")]),_:1})):Z("",!0),e.addNew?(P(),J(x,{key:1,class:"ms-1 flex-grow-1",variant:"secondary",title:"Add ",size:"sm",onClick:p},{default:L(()=>[H(" Cancel ")]),_:1})):Z("",!0)])])}}});var Bs=Re(Ms,[["__scopeId","data-v-0ff81b08"]]);const Sn=Tn("plotConfig",{state:()=>({customPlotConfig:{},plotConfigName:bs(),availablePlotConfigNames:Pa(),plotConfig:{...Ue}}),getters:{},actions:{saveCustomPlotConfig(e){this.customPlotConfig=e,xs(e),this.availablePlotConfigNames=Pa()},setPlotConfigName(e){this.plotConfigName=e,xn(e)},plotConfigChanged(e=""){console.log("plotConfigChanged"),this.setPlotConfigName(e||this.plotConfigName),this.plotConfig=Cn(this.plotConfigName)},setPlotConfig(e){console.log("emit..."),this.plotConfig={...e}}}});const Nt=e=>(Ba("data-v-042ee6f0"),e=e(),za(),e),zs={key:0},Vs={class:"col-mb-3"},Ns=Nt(()=>V("hr",null,null,-1)),Rs=Nt(()=>V("hr",null,null,-1)),$s=Nt(()=>V("hr",null,null,-1)),Es={key:1,class:"col-mb-5 ms-1 mt-2"},Fs=Ge({__name:"PlotConfigurator",props:{columns:{required:!0,type:Array},asModal:{required:!1,default:!0,type:Boolean}},setup(e){const a=Sn(),t=Va(),n=R(Ue),o=R("default"),r=R(""),i=R(""),s=R(!1),l=R(!1),u=R("main_plot"),d=R(),c=R(!0),h=E(()=>u.value==="main_plot"),p=E(()=>h.value?n.value.main_plot:n.value.subplots[u.value]),m=E(()=>["main_plot",...Object.keys(n.value.subplots)]),f=E(()=>h.value?Object.keys(n.value.main_plot):u.value in n.value.subplots?Object.keys(n.value.subplots[u.value]):[]);function v(M){console.log(n.value);const O=Object.keys(M)[0],F=M[O];h.value?(console.log(`Adding ${O} to MainPlot`),n.value.main_plot[O]={...F}):(console.log(`Adding ${O} to ${u.value}`),n.value.subplots[u.value][O]={...F}),n.value={...n.value},s.value=!1,a.setPlotConfig(n.value)}const g=E({get(){return s.value?{}:i.value?{[i.value]:p.value[i.value]}:{}},set(M){Object.keys(M)[0]&&M?v(M):s.value=!1}}),_=E({get(){return JSON.stringify(n.value,null,2)},set(M){try{d.value=JSON.parse(M),c.value=!0}catch{c.value=!1}}});function b(){console.log(n.value),h.value?(console.log(`Removing ${i.value} from MainPlot`),delete n.value.main_plot[i.value]):(console.log(`Removing ${i.value} from ${u.value}`),delete n.value.subplots[u.value][i.value]),n.value={...n.value},console.log(n.value),i.value="",a.setPlotConfig(n.value)}function y(){n.value.subplots={...n.value.subplots,[r.value]:{}},u.value=r.value,r.value="",a.setPlotConfig(n.value)}function w(){delete n.value.subplots[u.value],n.value.subplots={...n.value.subplots},u.value="",a.setPlotConfig(n.value)}function x(){n.value=Cn(o.value),console.log(n.value),console.log("loading config"),a.setPlotConfig(n.value)}function C(){d.value!==void 0&&c.value&&(n.value=d.value,a.setPlotConfig(n.value))}function B(){n.value={...Ue}}async function k(){if(t.activeBot.isWebserverMode&&!t.activeBot.strategy.strategy){Ft("No strategy selected, can't load plot config.");return}try{await t.activeBot.getStrategyPlotConfig(),t.activeBot.strategyPlotConfig&&(n.value=t.activeBot.strategyPlotConfig,a.setPlotConfig(n.value))}catch{Ft("Failed to load Plot configuration from Strategy.")}}function I(){a.saveCustomPlotConfig({[o.value]:n.value})}return xt(()=>{n.value=a.plotConfig,o.value=a.plotConfigName}),(M,O)=>{const F=W("b-form-input"),X=W("b-form-group"),pe=W("b-form-select"),q=W("b-button"),ee=W("b-input-group-append"),fe=W("b-input-group"),_e=W("b-form-textarea");return e.columns?(P(),z("div",zs,[T(X,{label:"Plot config name","label-for":"idPlotConfigName"},{default:L(()=>[T(F,{id:"idPlotConfigName",modelValue:o.value,"onUpdate:modelValue":O[0]||(O[0]=$=>o.value=$),size:"sm"},null,8,["modelValue"])]),_:1}),V("div",Vs,[Ns,T(X,{label:"Target","label-for":"FieldSel"},{default:L(()=>[T(pe,{id:"FieldSel",modelValue:u.value,"onUpdate:modelValue":O[1]||(O[1]=$=>u.value=$),options:D(m),"select-size":3},null,8,["modelValue","options"])]),_:1})]),T(X,{label:"Add new plot","label-for":"newSubPlot"},{default:L(()=>[T(fe,{size:"sm"},{default:L(()=>[T(F,{id:"newSubPlot",modelValue:r.value,"onUpdate:modelValue":O[2]||(O[2]=$=>r.value=$),class:"addPlot"},null,8,["modelValue"]),T(ee,null,{default:L(()=>[T(q,{disabled:!r.value,onClick:y},{default:L(()=>[H("+")]),_:1},8,["disabled"]),u.value&&u.value!="main_plot"?(P(),J(q,{key:0,onClick:w},{default:L(()=>[H("-")]),_:1})):Z("",!0)]),_:1})]),_:1})]),_:1}),Rs,V("div",null,[T(X,{label:"Used indicators","label-for":"selectedIndicators"},{default:L(()=>[T(pe,{id:"selectedIndicators",modelValue:i.value,"onUpdate:modelValue":O[3]||(O[3]=$=>i.value=$),options:D(f),"select-size":4},null,8,["modelValue","options"])]),_:1})]),V("div",null,[T(q,{variant:"primary",title:"Add indicator to plot",size:"sm",disabled:s.value,onClick:O[4]||(O[4]=$=>s.value=!s.value)},{default:L(()=>[H(" Add new indicator ")]),_:1},8,["disabled"]),T(q,{variant:"secondary",title:"Remove indicator to plot",size:"sm",disabled:!i.value,class:"ms-1",onClick:b},{default:L(()=>[H(" Remove indicator ")]),_:1},8,["disabled"])]),i.value||s.value?(P(),J(Bs,{key:0,modelValue:D(g),"onUpdate:modelValue":O[5]||(O[5]=$=>Et(g)?g.value=$:null),class:"mt-1",columns:e.columns,"add-new":s.value},null,8,["modelValue","columns","add-new"])):Z("",!0),$s,V("div",null,[T(q,{class:"ms-1",variant:"secondary",size:"sm",onClick:x},{default:L(()=>[H("Load")]),_:1}),T(q,{disabled:D(t).activeBot.isWebserverMode&&D(t).activeBot.botApiVersion<2.23||!D(t).activeBot.isBotOnline,class:"ms-1",variant:"secondary",size:"sm",onClick:k},{default:L(()=>[H(" From strategy ")]),_:1},8,["disabled"]),T(q,{class:"ms-1",variant:"secondary",size:"sm",title:"Load configuration from text box below",onClick:B},{default:L(()=>[H("Reset")]),_:1}),T(q,{id:"showButton",class:"ms-1",variant:"secondary",size:"sm",title:"Show configuration for easy transfer to a strategy",onClick:O[6]||(O[6]=$=>l.value=!l.value)},{default:L(()=>[H("Show")]),_:1}),l.value?(P(),J(q,{key:0,class:"ms-1",variant:"secondary",size:"sm",title:"Load configuration from text box below",onClick:C},{default:L(()=>[H("Load from String")]),_:1})):Z("",!0),T(q,{class:"ms-1",variant:"primary",size:"sm","data-toggle":"tooltip",title:"Save configuration",onClick:I},{default:L(()=>[H("Save")]),_:1})]),l.value?(P(),z("div",Es,[T(_e,{id:"TextArea",modelValue:D(_),"onUpdate:modelValue":O[7]||(O[7]=$=>Et(_)?_.value=$:null),class:"textArea",size:"sm",state:c.value},null,8,["modelValue","state"])])):Z("",!0)])):Z("",!0)}}});var Da=Re(Fs,[["__scopeId","data-v-042ee6f0"]]),Ws=Object.defineProperty,Zs=Object.defineProperties,Us=Object.getOwnPropertyDescriptors,Oa=Object.getOwnPropertySymbols,Hs=Object.prototype.hasOwnProperty,Gs=Object.prototype.propertyIsEnumerable,Ia=(e,a,t)=>a in e?Ws(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,xe=(e,a)=>{for(var t in a||(a={}))Hs.call(a,t)&&Ia(e,t,a[t]);if(Oa)for(var t of Oa(a))Gs.call(a,t)&&Ia(e,t,a[t]);return e},La=(e,a)=>Zs(e,Us(a));const js={props:{autoscroll:{type:Boolean,default:!0}},watch:{typeAheadPointer(){this.autoscroll&&this.maybeAdjustScroll()},open(e){this.autoscroll&&e&&this.$nextTick(()=>this.maybeAdjustScroll())}},methods:{maybeAdjustScroll(){var e;const a=((e=this.$refs.dropdownMenu)==null?void 0:e.children[this.typeAheadPointer])||!1;if(a){const t=this.getDropdownViewport(),{top:n,bottom:o,height:r}=a.getBoundingClientRect();if(n<t.top)return this.$refs.dropdownMenu.scrollTop=a.offsetTop;if(o>t.bottom)return this.$refs.dropdownMenu.scrollTop=a.offsetTop-(t.height-r)}},getDropdownViewport(){return this.$refs.dropdownMenu?this.$refs.dropdownMenu.getBoundingClientRect():{height:0,top:0,bottom:0}}}},Ys={data(){return{typeAheadPointer:-1}},watch:{filteredOptions(){for(let e=0;e<this.filteredOptions.length;e++)if(this.selectable(this.filteredOptions[e])){this.typeAheadPointer=e;break}},open(e){e&&this.typeAheadToLastSelected()},selectedValue(){this.open&&this.typeAheadToLastSelected()}},methods:{typeAheadUp(){for(let e=this.typeAheadPointer-1;e>=0;e--)if(this.selectable(this.filteredOptions[e])){this.typeAheadPointer=e;break}},typeAheadDown(){for(let e=this.typeAheadPointer+1;e<this.filteredOptions.length;e++)if(this.selectable(this.filteredOptions[e])){this.typeAheadPointer=e;break}},typeAheadSelect(){const e=this.filteredOptions[this.typeAheadPointer];e&&this.selectable(e)&&this.select(e)},typeAheadToLastSelected(){this.typeAheadPointer=this.selectedValue.length!==0?this.filteredOptions.indexOf(this.selectedValue[this.selectedValue.length-1]):-1}}},qs={props:{loading:{type:Boolean,default:!1}},data(){return{mutableLoading:!1}},watch:{search(){this.$emit("search",this.search,this.toggleLoading)},loading(e){this.mutableLoading=e}},methods:{toggleLoading(e=null){return e==null?this.mutableLoading=!this.mutableLoading:this.mutableLoading=e}}},Rt=(e,a)=>{const t=e.__vccOpts||e;for(const[n,o]of a)t[n]=o;return t},Ks={},Xs={xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10"},Js=V("path",{d:"M6.895455 5l2.842897-2.842898c.348864-.348863.348864-.914488 0-1.263636L9.106534.261648c-.348864-.348864-.914489-.348864-1.263636 0L5 3.104545 2.157102.261648c-.348863-.348864-.914488-.348864-1.263636 0L.261648.893466c-.348864.348864-.348864.914489 0 1.263636L3.104545 5 .261648 7.842898c-.348864.348863-.348864.914488 0 1.263636l.631818.631818c.348864.348864.914773.348864 1.263636 0L5 6.895455l2.842898 2.842897c.348863.348864.914772.348864 1.263636 0l.631818-.631818c.348864-.348864.348864-.914489 0-1.263636L6.895455 5z"},null,-1),Qs=[Js];function el(e,a){return P(),z("svg",Xs,Qs)}const tl=Rt(Ks,[["render",el]]),al={},nl={xmlns:"http://www.w3.org/2000/svg",width:"14",height:"10"},ol=V("path",{d:"M9.211364 7.59931l4.48338-4.867229c.407008-.441854.407008-1.158247 0-1.60046l-.73712-.80023c-.407008-.441854-1.066904-.441854-1.474243 0L7 5.198617 2.51662.33139c-.407008-.441853-1.066904-.441853-1.474243 0l-.737121.80023c-.407008.441854-.407008 1.158248 0 1.600461l4.48338 4.867228L7 10l2.211364-2.40069z"},null,-1),rl=[ol];function il(e,a){return P(),z("svg",nl,rl)}const sl=Rt(al,[["render",il]]),ka={Deselect:tl,OpenIndicator:sl},ll={mounted(e,{instance:a}){if(a.appendToBody){const{height:t,top:n,left:o,width:r}=a.$refs.toggle.getBoundingClientRect();let i=window.scrollX||window.pageXOffset,s=window.scrollY||window.pageYOffset;e.unbindPosition=a.calculatePosition(e,a,{width:r+"px",left:i+o+"px",top:s+n+t+"px"}),document.body.appendChild(e)}},unmounted(e,{instance:a}){a.appendToBody&&(e.unbindPosition&&typeof e.unbindPosition=="function"&&e.unbindPosition(),e.parentNode&&e.parentNode.removeChild(e))}};function ul(e){const a={};return Object.keys(e).sort().forEach(t=>{a[t]=e[t]}),JSON.stringify(a)}let cl=0;function dl(){return++cl}const hl={components:xe({},ka),directives:{appendToBody:ll},mixins:[js,Ys,qs],compatConfig:{MODE:3},emits:["open","close","update:modelValue","search","search:compositionstart","search:compositionend","search:keydown","search:blur","search:focus","search:input","option:created","option:selecting","option:selected","option:deselecting","option:deselected"],props:{modelValue:{},components:{type:Object,default:()=>({})},options:{type:Array,default(){return[]}},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},deselectFromDropdown:{type:Boolean,default:!1},searchable:{type:Boolean,default:!0},multiple:{type:Boolean,default:!1},placeholder:{type:String,default:""},transition:{type:String,default:"vs__fade"},clearSearchOnSelect:{type:Boolean,default:!0},closeOnSelect:{type:Boolean,default:!0},label:{type:String,default:"label"},autocomplete:{type:String,default:"off"},reduce:{type:Function,default:e=>e},selectable:{type:Function,default:e=>!0},getOptionLabel:{type:Function,default(e){return typeof e=="object"?e.hasOwnProperty(this.label)?e[this.label]:console.warn(`[vue-select warn]: Label key "option.${this.label}" does not exist in options object ${JSON.stringify(e)}.
https://vue-select.org/api/props.html#getoptionlabel`):e}},getOptionKey:{type:Function,default(e){if(typeof e!="object")return e;try{return e.hasOwnProperty("id")?e.id:ul(e)}catch(a){return console.warn(`[vue-select warn]: Could not stringify this option to generate unique key. Please provide'getOptionKey' prop to return a unique key for each option.
https://vue-select.org/api/props.html#getoptionkey`,e,a)}}},onTab:{type:Function,default:function(){this.selectOnTab&&!this.isComposing&&this.typeAheadSelect()}},taggable:{type:Boolean,default:!1},tabindex:{type:Number,default:null},pushTags:{type:Boolean,default:!1},filterable:{type:Boolean,default:!0},filterBy:{type:Function,default(e,a,t){return(a||"").toLocaleLowerCase().indexOf(t.toLocaleLowerCase())>-1}},filter:{type:Function,default(e,a){return e.filter(t=>{let n=this.getOptionLabel(t);return typeof n=="number"&&(n=n.toString()),this.filterBy(t,n,a)})}},createOption:{type:Function,default(e){return typeof this.optionList[0]=="object"?{[this.label]:e}:e}},resetOnOptionsChange:{default:!1,validator:e=>["function","boolean"].includes(typeof e)},clearSearchOnBlur:{type:Function,default:function({clearSearchOnSelect:e,multiple:a}){return e&&!a}},noDrop:{type:Boolean,default:!1},inputId:{type:String},dir:{type:String,default:"auto"},selectOnTab:{type:Boolean,default:!1},selectOnKeyCodes:{type:Array,default:()=>[13]},searchInputQuerySelector:{type:String,default:"[type=search]"},mapKeydown:{type:Function,default:(e,a)=>e},appendToBody:{type:Boolean,default:!1},calculatePosition:{type:Function,default(e,a,{width:t,top:n,left:o}){e.style.top=n,e.style.left=o,e.style.width=t}},dropdownShouldOpen:{type:Function,default({noDrop:e,open:a,mutableLoading:t}){return e?!1:a&&!t}},uid:{type:[String,Number],default:()=>dl()}},data(){return{search:"",open:!1,isComposing:!1,pushedTags:[],_value:[],deselectButtons:[]}},computed:{isReducingValues(){return this.$props.reduce!==this.$options.props.reduce.default},isTrackingValues(){return typeof this.modelValue=="undefined"||this.isReducingValues},selectedValue(){let e=this.modelValue;return this.isTrackingValues&&(e=this.$data._value),e!=null&&e!==""?[].concat(e):[]},optionList(){return this.options.concat(this.pushTags?this.pushedTags:[])},searchEl(){return this.$slots.search?this.$refs.selectedOptions.querySelector(this.searchInputQuerySelector):this.$refs.search},scope(){const e={search:this.search,loading:this.loading,searching:this.searching,filteredOptions:this.filteredOptions};return{search:{attributes:xe({disabled:this.disabled,placeholder:this.searchPlaceholder,tabindex:this.tabindex,readonly:!this.searchable,id:this.inputId,"aria-autocomplete":"list","aria-labelledby":`vs${this.uid}__combobox`,"aria-controls":`vs${this.uid}__listbox`,ref:"search",type:"search",autocomplete:this.autocomplete,value:this.search},this.dropdownOpen&&this.filteredOptions[this.typeAheadPointer]?{"aria-activedescendant":`vs${this.uid}__option-${this.typeAheadPointer}`}:{}),events:{compositionstart:()=>this.isComposing=!0,compositionend:()=>this.isComposing=!1,keydown:this.onSearchKeyDown,blur:this.onSearchBlur,focus:this.onSearchFocus,input:a=>this.search=a.target.value}},spinner:{loading:this.mutableLoading},noOptions:{search:this.search,loading:this.mutableLoading,searching:this.searching},openIndicator:{attributes:{ref:"openIndicator",role:"presentation",class:"vs__open-indicator"}},listHeader:e,listFooter:e,header:La(xe({},e),{deselect:this.deselect}),footer:La(xe({},e),{deselect:this.deselect})}},childComponents(){return xe(xe({},ka),this.components)},stateClasses(){return{"vs--open":this.dropdownOpen,"vs--single":!this.multiple,"vs--multiple":this.multiple,"vs--searching":this.searching&&!this.noDrop,"vs--searchable":this.searchable&&!this.noDrop,"vs--unsearchable":!this.searchable,"vs--loading":this.mutableLoading,"vs--disabled":this.disabled}},searching(){return!!this.search},dropdownOpen(){return this.dropdownShouldOpen(this)},searchPlaceholder(){return this.isValueEmpty&&this.placeholder?this.placeholder:void 0},filteredOptions(){const e=[].concat(this.optionList);if(!this.filterable&&!this.taggable)return e;const a=this.search.length?this.filter(e,this.search,this):e;if(this.taggable&&this.search.length){const t=this.createOption(this.search);this.optionExists(t)||a.unshift(t)}return a},isValueEmpty(){return this.selectedValue.length===0},showClearButton(){return!this.multiple&&this.clearable&&!this.open&&!this.isValueEmpty}},watch:{options(e,a){const t=()=>typeof this.resetOnOptionsChange=="function"?this.resetOnOptionsChange(e,a,this.selectedValue):this.resetOnOptionsChange;!this.taggable&&t()&&this.clearSelection(),this.modelValue&&this.isTrackingValues&&this.setInternalValueFromOptions(this.modelValue)},modelValue:{immediate:!0,handler(e){this.isTrackingValues&&this.setInternalValueFromOptions(e)}},multiple(){this.clearSelection()},open(e){this.$emit(e?"open":"close")}},created(){this.mutableLoading=this.loading},methods:{setInternalValueFromOptions(e){Array.isArray(e)?this.$data._value=e.map(a=>this.findOptionFromReducedValue(a)):this.$data._value=this.findOptionFromReducedValue(e)},select(e){this.$emit("option:selecting",e),this.isOptionSelected(e)?this.deselectFromDropdown&&(this.clearable||this.multiple&&this.selectedValue.length>1)&&this.deselect(e):(this.taggable&&!this.optionExists(e)&&(this.$emit("option:created",e),this.pushTag(e)),this.multiple&&(e=this.selectedValue.concat(e)),this.updateValue(e),this.$emit("option:selected",e)),this.onAfterSelect(e)},deselect(e){this.$emit("option:deselecting",e),this.updateValue(this.selectedValue.filter(a=>!this.optionComparator(a,e))),this.$emit("option:deselected",e)},clearSelection(){this.updateValue(this.multiple?[]:null)},onAfterSelect(e){this.closeOnSelect&&(this.open=!this.open,this.searchEl.blur()),this.clearSearchOnSelect&&(this.search="")},updateValue(e){typeof this.modelValue=="undefined"&&(this.$data._value=e),e!==null&&(Array.isArray(e)?e=e.map(a=>this.reduce(a)):e=this.reduce(e)),this.$emit("update:modelValue",e)},toggleDropdown(e){const a=e.target!==this.searchEl;a&&e.preventDefault();const t=[...this.deselectButtons||[],this.$refs.clearButton];if(this.searchEl===void 0||t.filter(Boolean).some(n=>n.contains(e.target)||n===e.target)){e.preventDefault();return}this.open&&a?this.searchEl.blur():this.disabled||(this.open=!0,this.searchEl.focus())},isOptionSelected(e){return this.selectedValue.some(a=>this.optionComparator(a,e))},isOptionDeselectable(e){return this.isOptionSelected(e)&&this.deselectFromDropdown},optionComparator(e,a){return this.getOptionKey(e)===this.getOptionKey(a)},findOptionFromReducedValue(e){const a=n=>JSON.stringify(this.reduce(n))===JSON.stringify(e),t=[...this.options,...this.pushedTags].filter(a);return t.length===1?t[0]:t.find(n=>this.optionComparator(n,this.$data._value))||e},closeSearchOptions(){this.open=!1,this.$emit("search:blur")},maybeDeleteValue(){if(!this.searchEl.value.length&&this.selectedValue&&this.selectedValue.length&&this.clearable){let e=null;this.multiple&&(e=[...this.selectedValue.slice(0,this.selectedValue.length-1)]),this.updateValue(e)}},optionExists(e){return this.optionList.some(a=>this.optionComparator(a,e))},normalizeOptionForSlot(e){return typeof e=="object"?e:{[this.label]:e}},pushTag(e){this.pushedTags.push(e)},onEscape(){this.search.length?this.search="":this.searchEl.blur()},onSearchBlur(){if(this.mousedown&&!this.searching)this.mousedown=!1;else{const{clearSearchOnSelect:e,multiple:a}=this;this.clearSearchOnBlur({clearSearchOnSelect:e,multiple:a})&&(this.search=""),this.closeSearchOptions();return}if(this.search.length===0&&this.options.length===0){this.closeSearchOptions();return}},onSearchFocus(){this.open=!0,this.$emit("search:focus")},onMousedown(){this.mousedown=!0},onMouseUp(){this.mousedown=!1},onSearchKeyDown(e){const a=o=>(o.preventDefault(),!this.isComposing&&this.typeAheadSelect()),t={8:o=>this.maybeDeleteValue(),9:o=>this.onTab(),27:o=>this.onEscape(),38:o=>(o.preventDefault(),this.typeAheadUp()),40:o=>(o.preventDefault(),this.typeAheadDown())};this.selectOnKeyCodes.forEach(o=>t[o]=a);const n=this.mapKeydown(t,this);if(typeof n[e.keyCode]=="function")return n[e.keyCode](e)}}},pl=["dir"],fl=["id","aria-expanded","aria-owns"],vl={ref:"selectedOptions",class:"vs__selected-options"},gl=["disabled","title","aria-label","onClick"],ml={ref:"actions",class:"vs__actions"},yl=["disabled"],_l={class:"vs__spinner"},bl=["id"],xl=["id","aria-selected","onMouseover","onClick"],Cl={key:0,class:"vs__no-options"},Sl=H(" Sorry, no matching options. "),wl=["id"];function Al(e,a,t,n,o,r){const i=Pn("append-to-body");return P(),z("div",{dir:t.dir,class:Ht(["v-select",r.stateClasses])},[te(e.$slots,"header",ae(re(r.scope.header))),V("div",{id:`vs${t.uid}__combobox`,ref:"toggle",class:"vs__dropdown-toggle",role:"combobox","aria-expanded":r.dropdownOpen.toString(),"aria-owns":`vs${t.uid}__listbox`,"aria-label":"Search for option",onMousedown:a[1]||(a[1]=s=>r.toggleDropdown(s))},[V("div",vl,[(P(!0),z(Wt,null,Zt(r.selectedValue,(s,l)=>te(e.$slots,"selected-option-container",{option:r.normalizeOptionForSlot(s),deselect:r.deselect,multiple:t.multiple,disabled:t.disabled},()=>[(P(),z("span",{key:t.getOptionKey(s),class:"vs__selected"},[te(e.$slots,"selected-option",ae(re(r.normalizeOptionForSlot(s))),()=>[H(ie(t.getOptionLabel(s)),1)]),t.multiple?(P(),z("button",{key:0,ref_for:!0,ref:u=>o.deselectButtons[l]=u,disabled:t.disabled,type:"button",class:"vs__deselect",title:`Deselect ${t.getOptionLabel(s)}`,"aria-label":`Deselect ${t.getOptionLabel(s)}`,onClick:u=>r.deselect(s)},[(P(),J(qe(r.childComponents.Deselect)))],8,gl)):Z("",!0)]))])),256)),te(e.$slots,"search",ae(re(r.scope.search)),()=>[V("input",ut({class:"vs__search"},r.scope.search.attributes,Dn(r.scope.search.events)),null,16)])],512),V("div",ml,[Ee(V("button",{ref:"clearButton",disabled:t.disabled,type:"button",class:"vs__clear",title:"Clear Selected","aria-label":"Clear Selected",onClick:a[0]||(a[0]=(...s)=>r.clearSelection&&r.clearSelection(...s))},[(P(),J(qe(r.childComponents.Deselect)))],8,yl),[[ct,r.showClearButton]]),te(e.$slots,"open-indicator",ae(re(r.scope.openIndicator)),()=>[t.noDrop?Z("",!0):(P(),J(qe(r.childComponents.OpenIndicator),ae(ut({key:0},r.scope.openIndicator.attributes)),null,16))]),te(e.$slots,"spinner",ae(re(r.scope.spinner)),()=>[Ee(V("div",_l,"Loading...",512),[[ct,e.mutableLoading]])])],512)],40,fl),T(Na,{name:t.transition},{default:L(()=>[r.dropdownOpen?Ee((P(),z("ul",{id:`vs${t.uid}__listbox`,ref:"dropdownMenu",key:`vs${t.uid}__listbox`,class:"vs__dropdown-menu",role:"listbox",tabindex:"-1",onMousedown:a[2]||(a[2]=Ut((...s)=>r.onMousedown&&r.onMousedown(...s),["prevent"])),onMouseup:a[3]||(a[3]=(...s)=>r.onMouseUp&&r.onMouseUp(...s))},[te(e.$slots,"list-header",ae(re(r.scope.listHeader))),(P(!0),z(Wt,null,Zt(r.filteredOptions,(s,l)=>(P(),z("li",{id:`vs${t.uid}__option-${l}`,key:t.getOptionKey(s),role:"option",class:Ht(["vs__dropdown-option",{"vs__dropdown-option--deselect":r.isOptionDeselectable(s)&&l===e.typeAheadPointer,"vs__dropdown-option--selected":r.isOptionSelected(s),"vs__dropdown-option--highlight":l===e.typeAheadPointer,"vs__dropdown-option--disabled":!t.selectable(s)}]),"aria-selected":l===e.typeAheadPointer?!0:null,onMouseover:u=>t.selectable(s)?e.typeAheadPointer=l:null,onClick:Ut(u=>t.selectable(s)?r.select(s):null,["prevent","stop"])},[te(e.$slots,"option",ae(re(r.normalizeOptionForSlot(s))),()=>[H(ie(t.getOptionLabel(s)),1)])],42,xl))),128)),r.filteredOptions.length===0?(P(),z("li",Cl,[te(e.$slots,"no-options",ae(re(r.scope.noOptions)),()=>[Sl])])):Z("",!0),te(e.$slots,"list-footer",ae(re(r.scope.listFooter)))],40,bl)),[[i]]):(P(),z("ul",{key:1,id:`vs${t.uid}__listbox`,role:"listbox",style:{display:"none",visibility:"hidden"}},null,8,wl))]),_:3},8,["name"]),te(e.$slots,"footer",ae(re(r.scope.footer)))],10,pl)}const Tl=Rt(hl,[["render",Al]]);const Pl={class:"d-flex h-100"},Dl={class:"flex-fill w-100 flex-column align-items-stretch d-flex h-100"},Ol={class:"d-flex me-0"},Il={class:"ms-2 d-flex flex-wrap flex-md-nowrap align-items-center w-auto"},Ll={class:"ms-2 text-nowrap"},kl={key:0,class:"ms-2 text-nowrap",title:"Long entry signals"},Ml={key:1,class:"ms-2 text-nowrap",title:"Long exit signals"},Bl={key:2,class:"ms-2 text-nowrap"},zl={key:3,class:"ms-2 text-nowrap"},Vl={class:"ms-auto d-flex align-items-center w-auto"},Nl={class:"ms-2"},Rl={class:"ms-2 me-0 me-md-1"},$l={class:"me-1 ms-1 h-100"},El={key:1,class:"m-auto"},Fl={key:1,style:{"font-size":"1.5rem"}},Wl={key:0,class:"w-25 config-sidebar"},Zl=Ge({__name:"CandleChartContainer",props:{trades:{required:!1,default:()=>[],type:Array},availablePairs:{required:!0,type:Array},timeframe:{required:!0,type:String},historicView:{required:!1,default:!1,type:Boolean},plotConfigModal:{required:!1,default:!0,type:Boolean},timerange:{required:!1,default:"",type:String},strategy:{required:!1,default:"",type:String},sliderPosition:{required:!1,type:Object,default:()=>{}}},setup(e){const a=e,t=On(),n=Va(),o=Sn(),r=R(""),i=R(a.plotConfigModal),s=E(()=>{var v,g;return a.historicView?(v=n.activeBot.history[`${r.value}__${a.timeframe}`])==null?void 0:v.data:(g=n.activeBot.candleData[`${r.value}__${a.timeframe}`])==null?void 0:g.data}),l=E(()=>{var v;return a.strategy||((v=s.value)==null?void 0:v.strategy)||""}),u=E(()=>s.value?s.value.columns:[]),d=E(()=>s.value&&s.value.data.length>0),c=E(()=>a.historicView?n.activeBot.historyStatus===Le.loading:n.activeBot.candleDataStatus===Le.loading),h=E(()=>{switch(a.historicView?n.activeBot.historyStatus:n.activeBot.candleDataStatus){case Le.loading:return"Loading...";case Le.success:return"No data available";case Le.error:return"Failed to load data";default:return"Unknown"}}),p=R(!1),m=()=>{a.plotConfigModal?p.value=!p.value:i.value=!i.value},f=()=>{console.log("refresh",r.value,a.timeframe),r.value&&a.timeframe&&(a.historicView?n.activeBot.getPairHistory({pair:r.value,timeframe:a.timeframe,timerange:a.timerange,strategy:a.strategy}):n.activeBot.getPairCandles({pair:r.value,timeframe:a.timeframe,limit:500}))};return ue(()=>a.availablePairs,()=>{a.availablePairs.find(v=>v===r.value)||([r.value]=a.availablePairs,f())}),ue(()=>n.activeBot.selectedPair,()=>{r.value=n.activeBot.selectedPair,f()}),xt(()=>{n.activeBot.selectedPair?r.value=n.activeBot.selectedPair:a.availablePairs.length>0&&([r.value]=a.availablePairs),o.plotConfigChanged(),d.value||f()}),(v,g)=>{const _=W("b-button"),b=W("b-form-checkbox"),y=W("b-form-select"),w=W("b-spinner"),x=W("b-modal");return P(),z("div",Pl,[V("div",Dl,[V("div",Ol,[V("div",Il,[V("span",Ll,ie(D(l))+" | "+ie(e.timeframe||""),1),T(D(Tl),{modelValue:r.value,"onUpdate:modelValue":g[0]||(g[0]=C=>r.value=C),class:"ms-2",options:e.availablePairs,style:{"min-width":"7em"},size:"sm",clearable:!1,onInput:f},null,8,["modelValue","options"]),T(_,{class:"ms-2",disabled:!r.value,size:"sm",onClick:f},{default:L(()=>[H("\u21BB")]),_:1},8,["disabled"]),D(s)?(P(),z("small",kl,"Long signals: "+ie(D(s).enter_long_signals||D(s).buy_signals),1)):Z("",!0),D(s)?(P(),z("small",Ml,"Long exit: "+ie(D(s).exit_long_signals||D(s).sell_signals),1)):Z("",!0),D(s)&&D(s).enter_short_signals?(P(),z("small",Bl,"Short entries: "+ie(D(s).enter_short_signals),1)):Z("",!0),D(s)&&D(s).exit_short_signals?(P(),z("small",zl,"Short exits: "+ie(D(s).exit_short_signals),1)):Z("",!0)]),V("div",Vl,[T(b,{modelValue:D(t).useHeikinAshiCandles,"onUpdate:modelValue":g[1]||(g[1]=C=>D(t).useHeikinAshiCandles=C)},{default:L(()=>[H("Heikin Ashi")]),_:1},8,["modelValue"]),V("div",Nl,[T(y,{modelValue:D(o).plotConfigName,"onUpdate:modelValue":g[2]||(g[2]=C=>D(o).plotConfigName=C),options:D(o).availablePlotConfigNames,size:"sm",onChange:D(o).plotConfigChanged},null,8,["modelValue","options","onChange"])]),V("div",Rl,[T(_,{size:"sm",title:"Plot configurator",onClick:m},{default:L(()=>[H(" \u2699 ")]),_:1})])])]),V("div",$l,[D(d)?(P(),J(_s,{key:0,dataset:D(s),trades:e.trades,"plot-config":D(o).plotConfig,"heikin-ashi":D(t).useHeikinAshiCandles,"use-u-t-c":D(t).timezone==="UTC",theme:D(t).chartTheme,"slider-position":e.sliderPosition},null,8,["dataset","trades","plot-config","heikin-ashi","use-u-t-c","theme","slider-position"])):(P(),z("div",El,[D(c)?(P(),J(w,{key:0,label:"Spinning"})):(P(),z("div",Fl,ie(D(h)),1))]))])]),T(Na,{name:"fade",mode:"in-out"},{default:L(()=>[e.plotConfigModal?Z("",!0):Ee((P(),z("div",Wl,[T(Da,{columns:D(u),"as-modal":!1},null,8,["columns"])],512)),[[ct,i.value]])]),_:1}),e.plotConfigModal?(P(),J(x,{key:0,id:"plotConfiguratorModal",modelValue:p.value,"onUpdate:modelValue":g[3]||(g[3]=C=>p.value=C),title:"Plot Configurator","ok-only":"","hide-backdrop":""},{default:L(()=>[p.value?(P(),J(Da,{key:0,columns:D(u)},null,8,["columns"])):Z("",!0)]),_:1},8,["modelValue"])):Z("",!0)])}}});var Yl=Re(Zl,[["__scopeId","data-v-8c86b8e8"]]);export{Yl as C};
//# sourceMappingURL=CandleChartContainer.e8452553.js.map
