import{g as D,u as j,r as x,m as K,o as v,c as L,b as l,w as u,C as me,x as C,a as V,h as i,z as E,D as N,V as G,G as W,a4 as fe,H as Y,y as w,e as T,A as B,j as Z,b4 as J,k as pe,b5 as _e,b6 as ve,aM as be,v as xe,n as q,q as ye,U as ge,l as $e,b7 as ke,_ as Te}from"./index-UoLg79PO.js";import{a as Ve,_ as he}from"./InfoBox.vue_vue_type_script_setup_true_lang-gGmBMyPN.js";const Ce=V("br",null,null,-1),we=D({__name:"ForceExitForm",props:{trade:{type:Object,required:!0},modelValue:{required:!0,default:!1,type:Boolean}},emits:["update:modelValue"],setup(t,{emit:n}){const a=t,p=n,b=j(),g=x(),m=x(void 0),f=x("limit"),r=()=>{var d;return(d=g.value)==null?void 0:d.checkValidity()},s=K({get(){return a.modelValue},set(_){p("update:modelValue",_)}}),O=()=>{if(!r())return;const _={tradeid:String(a.trade.trade_id)};f.value&&(_.ordertype=f.value),m.value&&(_.amount=m.value),b.activeBot.forceexit(_),s.value=!1},h=()=>{var _,d,S,F;m.value=a.trade.amount,f.value=((d=(_=b.activeBot.botState)==null?void 0:_.order_types)==null?void 0:d.force_exit)||((F=(S=b.activeBot.botState)==null?void 0:S.order_types)==null?void 0:F.exit)||"limit"},y=()=>{O()};return(_,d)=>{const S=G,F=W,P=fe,H=Y;return v(),L("div",null,[l(H,{id:"forceexit-modal",modelValue:i(s),"onUpdate:modelValue":d[3]||(d[3]=$=>E(s)?s.value=$:null),title:"Force exiting a trade",onShow:h,onHidden:h,onOk:y},{default:u(()=>[V("form",{ref_key:"form",ref:g,onSubmit:me(O,["stop","prevent"])},[V("p",null,[V("span",null,"Exiting Trade #"+C(t.trade.trade_id)+" "+C(t.trade.pair)+".",1),Ce,V("span",null,"Currently owning "+C(t.trade.amount)+" "+C(t.trade.base_currency),1)]),l(F,{label:`*Amount in ${t.trade.base_currency} [optional]`,"label-for":"stake-input","invalid-feedback":"Amount must be empty or a positive number",state:i(m)!==void 0&&i(m)>0},{default:u(()=>[l(S,{id:"stake-input",modelValue:i(m),"onUpdate:modelValue":d[0]||(d[0]=$=>E(m)?m.value=$:null),type:"number",step:"0.000001",onKeydown:N(y,["enter"])},null,8,["modelValue"]),l(S,{id:"stake-input",modelValue:i(m),"onUpdate:modelValue":d[1]||(d[1]=$=>E(m)?m.value=$:null),type:"range",step:"0.000001",min:"0",max:t.trade.amount,onKeydown:N(y,["enter"])},null,8,["modelValue","max"])]),_:1},8,["label","state"]),l(F,{label:"*OrderType","label-for":"ordertype-input","invalid-feedback":"OrderType",state:i(f)!==void 0},{default:u(()=>[l(P,{modelValue:i(f),"onUpdate:modelValue":d[2]||(d[2]=$=>E(f)?f.value=$:null),class:"ms-2",options:["market","limit"],style:{"min-width":"7em"},size:"sm"},null,8,["modelValue"])]),_:1},8,["state"])],544)]),_:1},8,["modelValue"])])}}}),Be={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Oe=V("path",{fill:"currentColor",d:"M10 9a1 1 0 0 1 1-1a1 1 0 0 1 1 1v4.47l1.21.13l4.94 2.19c.53.24.85.77.85 1.35v4.36c-.03.82-.68 1.47-1.5 1.5H11c-.38 0-.74-.15-1-.43l-4.9-4.2l.74-.77c.19-.21.46-.32.74-.32h.22L10 19zm1-4a4 4 0 0 1 4 4c0 1.5-.8 2.77-2 3.46v-1.22c.61-.55 1-1.35 1-2.24a3 3 0 0 0-3-3a3 3 0 0 0-3 3c0 .89.39 1.69 1 2.24v1.22C7.8 11.77 7 10.5 7 9a4 4 0 0 1 4-4"},null,-1),Ee=[Oe];function Le(t,n){return v(),L("svg",Be,[...Ee])}const Se={name:"mdi-gesture-tap",render:Le},Fe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ie=V("path",{fill:"currentColor",d:"M2 12c0 5 4 9 9 9c2.4 0 4.7-.9 6.4-2.6l-1.5-1.5c-1.3 1.4-3 2.1-4.9 2.1c-6.2 0-9.4-7.5-4.9-11.9S18 5.8 18 12h-3l4 4h.1l3.9-4h-3c0-5-4-9-9-9s-9 4-9 9m8 3h2v2h-2zm0-8h2v6h-2z"},null,-1),Ae=[Ie];function Pe(t,n){return v(),L("svg",Fe,[...Ae])}const ze={name:"mdi-reload-alert",render:Pe},De={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},He=V("path",{fill:"currentColor",d:"M4 20h14v2H4a2 2 0 0 1-2-2V6h2zM20.22 2H7.78C6.8 2 6 2.8 6 3.78v12.44C6 17.2 6.8 18 7.78 18h12.44c.98 0 1.78-.8 1.78-1.78V3.78C22 2.8 21.2 2 20.22 2M19 13.6L17.6 15L14 11.4L10.4 15L9 13.6l3.6-3.6L9 6.4L10.4 5L14 8.6L17.6 5L19 6.4L15.4 10z"},null,-1),Me=[He];function Re(t,n){return v(),L("svg",De,[...Me])}const qe={name:"mdi-close-box-multiple",render:Re},Ue={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ne=V("path",{fill:"currentColor",d:"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m-3.4 14L12 13.4L8.4 17L7 15.6l3.6-3.6L7 8.4L8.4 7l3.6 3.6L15.6 7L17 8.4L13.4 12l3.6 3.6z"},null,-1),je=[Ne];function Ke(t,n){return v(),L("svg",Ue,[...je])}const Ge={name:"mdi-close-box",render:Ke},We={class:"d-flex flex-column"},Ye=D({__name:"TradeActions",props:{botApiVersion:{type:Number,default:1},trade:{type:Object,required:!0}},emits:["forceExit","forceExitPartial","cancelOpenOrder","reloadTrade","deleteTrade"],setup(t){return(n,a)=>{const p=Ge,b=Z,g=qe,m=J,f=ze,r=pe;return v(),L("div",We,[t.botApiVersion<=1.1?(v(),w(b,{key:0,class:"btn-xs text-start",size:"sm",title:"Forceexit",onClick:a[0]||(a[0]=s=>n.$emit("forceExit",t.trade))},{default:u(()=>[l(p,{class:"me-1"}),T("Forceexit ")]),_:1})):B("",!0),t.botApiVersion>1.1?(v(),w(b,{key:1,class:"btn-xs text-start",size:"sm",title:"Forceexit limit",onClick:a[1]||(a[1]=s=>n.$emit("forceExit",t.trade,"limit"))},{default:u(()=>[l(p,{class:"me-1"}),T("Forceexit limit ")]),_:1})):B("",!0),t.botApiVersion>1.1?(v(),w(b,{key:2,class:"btn-xs text-start mt-1",size:"sm",title:"Forceexit market",onClick:a[2]||(a[2]=s=>n.$emit("forceExit",t.trade,"market"))},{default:u(()=>[l(p,{class:"me-1"}),T("Forceexit market ")]),_:1})):B("",!0),t.botApiVersion>2.16?(v(),w(b,{key:3,class:"btn-xs text-start mt-1",size:"sm",title:"Forceexit partial",onClick:a[3]||(a[3]=s=>n.$emit("forceExitPartial",t.trade))},{default:u(()=>[l(g,{class:"me-1"}),T("Forceexit partial ")]),_:1})):B("",!0),t.botApiVersion>=2.24&&(t.trade.open_order_id||t.trade.has_open_orders)?(v(),w(b,{key:4,class:"btn-xs text-start mt-1",size:"sm",title:"Cancel open orders",onClick:a[4]||(a[4]=s=>n.$emit("cancelOpenOrder",t.trade))},{default:u(()=>[l(m,{class:"me-1"}),T("Cancel open order ")]),_:1})):B("",!0),t.botApiVersion>=2.28?(v(),w(b,{key:5,class:"btn-xs text-start mt-1",size:"sm",title:"Reload",onClick:a[5]||(a[5]=s=>n.$emit("reloadTrade",t.trade))},{default:u(()=>[l(f,{class:"me-1"}),T("Reload Trade ")]),_:1})):B("",!0),l(b,{class:"btn-xs text-start mt-1",size:"sm",title:"Delete trade",onClick:a[6]||(a[6]=s=>n.$emit("deleteTrade",t.trade))},{default:u(()=>[l(r,{class:"me-1"}),T(" Delete ")]),_:1})])}}}),Ze=D({__name:"TradeActionsPopover",props:{trade:{type:Object,required:!0},id:{type:Number,required:!0},botApiVersion:{type:Number,required:!0}},emits:["forceExit","forceExitPartial","cancelOpenOrder","reloadTrade","deleteTrade"],setup(t,{emit:n}){const a=n,p=x(!1);function b(r,s=void 0){p.value=!1,a("forceExit",r,s)}function g(r){p.value=!1,a("forceExitPartial",r)}function m(r){p.value=!1,a("cancelOpenOrder",r)}function f(r){p.value=!1,a("reloadTrade",r)}return(r,s)=>{const O=Se,h=Z,y=J,_=_e;return v(),L("div",null,[l(h,{id:`btn-actions-${t.id}`,class:"btn-xs",size:"sm",title:"Actions",onClick:s[0]||(s[0]=d=>p.value=!i(p))},{default:u(()=>[l(O)]),_:1},8,["id"]),l(_,{container:"body",target:`btn-actions-${t.id}`,title:`Actions for ${t.trade.pair}`,triggers:"manual",show:i(p),placement:"left"},{default:u(()=>[l(Ye,{trade:t.trade,"bot-api-version":t.botApiVersion,onForceExit:b,onForceExitPartial:g,onDeleteTrade:s[1]||(s[1]=d=>{p.value=!1,r.$emit("deleteTrade",t.trade)}),onCancelOpenOrder:m,onReloadTrade:f},null,8,["trade","bot-api-version"]),l(h,{class:"mt-1 w-100 text-start",size:"sm",onClick:s[2]||(s[2]=d=>p.value=!1)},{default:u(()=>[l(y,{class:"me-1"}),T("Close Actions menu ")]),_:1})]),_:1},8,["target","title","show"])])}}}),Je={class:"h-100 overflow-auto w-100"},Qe={class:"w-100 d-flex justify-content-between"},Xe=D({__name:"TradeList",props:{trades:{required:!0,type:Array},title:{default:"Trades",type:String},stakeCurrency:{required:!1,default:"",type:String},activeTrades:{default:!1,type:Boolean},showFilter:{default:!1,type:Boolean},multiBotView:{default:!1,type:Boolean},emptyText:{default:"No Trades to show.",type:String}},setup(t){const n=t,a=j(),p=ve(),b=be(),g=x(1),m=x(),f=x(""),r=x({}),s=n.activeTrades?200:15,O=x(),h=x(!1),y=x(!1),_=x(""),d=x(null),S=[{key:"actions"}],F=[{key:"close_timestamp",label:"Close date"},{key:"exit_reason",label:"Close Reason"}];function P(e){return q(e,a.activeBot.stakeCurrencyDecimals)}const H=K(()=>n.trades.length),$=x([]);xe(()=>{$.value=[{key:"trade_id",label:"ID"},{key:"pair",label:"Pair"},{key:"amount",label:"Amount"},{key:"stake_amount",label:"Stake amount"},{key:"open_rate",label:"Open rate",formatter:e=>q(e)},{key:n.activeTrades?"current_rate":"close_rate",label:n.activeTrades?"Current rate":"Close rate",formatter:e=>q(e)},{key:"profit",label:n.activeTrades?"Current profit %":"Profit %",formatter:(e,c,k)=>{if(!k)return"";const I=k;return`${ye(I.profit_ratio,2)} ${`(${P(I.profit_abs)})`}`}},{key:"open_timestamp",label:"Open date"},...n.activeTrades?S:F],n.multiBotView&&$.value.unshift({key:"botName",label:"Bot"})});const z=x(void 0);function Q(e,c=void 0){r.value=e,d.value=1,_.value=`Really exit trade ${e.trade_id} (Pair ${e.pair}) using ${c} Order?`,z.value=c,b.confirmDialog===!0?y.value=!0:U()}function U(){if(d.value===0){const e={tradeid:String(r.value.trade_id),botId:r.value.botId};a.deleteTradeMulti(e).catch(c=>console.log(c.response))}if(d.value===1){const e={tradeid:String(r.value.trade_id),botId:r.value.botId};z.value&&(e.ordertype=z.value),a.forceSellMulti(e).then(c=>console.log(c)).catch(c=>console.log(c.response))}if(d.value===3){const e={tradeid:String(r.value.trade_id),botId:r.value.botId};a.cancelOpenOrderMulti(e)}z.value=void 0,y.value=!1}function X(e){_.value=`Really delete trade ${e.trade_id} (Pair ${e.pair})?`,d.value=0,r.value=e,y.value=!0}function ee(e){r.value=e,h.value=!0}function te(e){_.value=`Cancel open order for trade ${e.trade_id} (Pair ${e.pair})?`,r.value=e,d.value=3,y.value=!0}function ae(e){a.reloadTradeMulti({tradeid:String(e.trade_id),botId:e.botId})}function oe(e,c,k){n.activeTrades&&(k.preventDefault(),console.log(e))}const ne=e=>{n.multiBotView&&a.selectedBot!==e.botId&&a.selectBot(e.botId),e&&e.trade_id!==a.activeBot.detailTradeId?(a.activeBot.setDetailTrade(e),n.multiBotView&&p.push({name:"Freqtrade Trading"})):a.activeBot.setDetailTrade(null)},le=()=>{var e;if(a.activeBot.detailTradeId){const c=n.trades.findIndex(k=>k.trade_id===a.activeBot.detailTradeId);c>=0?(e=O.value)==null||e.selectRow(c):(console.log(`Unsetting item for tradeid ${m.value}`),m.value=void 0)}};return ge(()=>a.activeBot.detailTradeId,e=>{var k;n.trades.findIndex(I=>I.trade_id===e)<0&&((k=O.value)==null||k.clearSelected())}),(e,c)=>{const k=Ze,I=Ve,M=he,re=$e,ie=ke,de=G,se=W,ce=we,ue=Y;return v(),L("div",Je,[l(re,{ref_key:"tradesTable",ref:O,small:"",hover:"",stacked:"md",items:t.trades.filter(o=>{var A,R;return o.pair.toLowerCase().includes(i(f).toLowerCase())||((A=o.exit_reason)==null?void 0:A.toLowerCase().includes(i(f).toLowerCase()))||((R=o.enter_tag)==null?void 0:R.toLowerCase().includes(i(f).toLowerCase()))}),fields:i($),"show-empty":"","empty-text":t.emptyText,"per-page":i(s),"current-page":i(g),"primary-key":"botTradeId",selectable:"","select-head":!1,"select-mode":"single",onRowContextmenu:oe,onRowClicked:ne,onRowSelected:le},{"cell(actions)":u(({index:o,item:A})=>[l(k,{id:o,trade:A,"bot-api-version":i(a).activeBot.botApiVersion,onDeleteTrade:R=>X(A),onForceExit:Q,onForceExitPartial:ee,onCancelOpenOrder:te,onReloadTrade:ae},null,8,["id","trade","bot-api-version","onDeleteTrade"])]),"cell(pair)":u(o=>[V("span",null,C(`${o.item.pair}${o.item.open_order_id||o.item.has_open_orders?"*":""}`),1)]),"cell(trade_id)":u(o=>[T(C(o.item.trade_id)+" "+C(i(a).activeBot.botApiVersion>2&&o.item.trading_mode!=="spot"?"| "+(o.item.is_short?"Short":"Long"):""),1)]),"cell(stake_amount)":u(o=>[T(C(P(o.item.stake_amount))+" "+C(o.item.trading_mode!=="spot"?`(${o.item.leverage}x)`:""),1)]),"cell(profit)":u(o=>[l(I,{trade:o.item},null,8,["trade"])]),"cell(open_timestamp)":u(o=>[l(M,{date:o.item.open_timestamp},null,8,["date"])]),"cell(close_timestamp)":u(o=>[l(M,{date:o.item.close_timestamp??0},null,8,["date"])]),_:1},8,["items","fields","empty-text","per-page","current-page"]),V("div",Qe,[t.activeTrades?B("",!0):(v(),w(ie,{key:0,modelValue:i(g),"onUpdate:modelValue":c[0]||(c[0]=o=>E(g)?g.value=o:null),"total-rows":i(H),"per-page":i(s),"aria-controls":"my-table"},null,8,["modelValue","total-rows","per-page"])),t.showFilter?(v(),w(se,{key:1,"label-for":"trade-filter"},{default:u(()=>[l(de,{id:"trade-filter",modelValue:i(f),"onUpdate:modelValue":c[1]||(c[1]=o=>E(f)?f.value=o:null),type:"text",placeholder:"Filter"},null,8,["modelValue"])]),_:1})):B("",!0)]),t.activeTrades?(v(),w(ce,{key:0,modelValue:i(h),"onUpdate:modelValue":c[2]||(c[2]=o=>E(h)?h.value=o:null),trade:i(r)},null,8,["modelValue","trade"])):B("",!0),l(ue,{modelValue:i(y),"onUpdate:modelValue":c[3]||(c[3]=o=>E(y)?y.value=o:null),title:"Exit trade",onOk:U},{default:u(()=>[T(C(i(_)),1)]),_:1},8,["modelValue"])])}}}),at=Te(Xe,[["__scopeId","data-v-b71a7941"]]);export{qe as _,at as a};
//# sourceMappingURL=TradeList-uvoEglTB.js.map
