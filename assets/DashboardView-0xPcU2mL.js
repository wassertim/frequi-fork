import{a as W,b as H,_ as K}from"./TradesLogChart-p4zgRPfe.js";import{a as Q}from"./TradeList-QgtNnBom.js";import{b as X,c as Y}from"./InfoBox.vue_vue_type_script_setup_true_lang-vHk0tZVh.js";import{g as j,u as A,l as p,o as m,x as B,w as s,h as e,v as x,e as D,z as C,y as Z,c as P,a as L,n as ee,m as te,a5 as oe,k as ae,I as se,r as re,J as S,aT as v,q as le,L as z,b as r,M as k}from"./index-dzevJiyr.js";import{_ as ne,a as ie}from"./TimePeriodChart-MV_NkwuY.js";import"./installCanvasRenderer-epB0g-7F.js";import"./install-7fFfEIUu.js";const de={class:"d-flex flex-row"},ce={key:2},ue={key:0},pe=["title"],_e={class:"text-small"},fe={key:0},me={class:"text-profit"},ye={class:"text-loss"},he=j({__name:"BotComparisonList",setup(E){const c=(d,a)=>!d.profitClosed||!a.profitClosed?-1:d.profitClosed-a.profitClosed,o=A(),T=p({get:()=>Object.values(o.botStores).every(d=>d.isSelected),set:d=>{for(const a in o.botStores)o.botStores[a].isSelected=d}}),$=[{key:"botName",label:"Bot"},{key:"trades",label:"Trades"},{key:"profitOpen",label:"Open Profit"},{key:"profitClosed",label:"Closed Profit"},{key:"balance",label:"Balance"},{key:"winVsLoss",label:"W/L"}],O=p(()=>{const d=[],a={botId:void 0,botName:"Summary",profitClosed:0,profitClosedRatio:void 0,profitOpen:0,profitOpenRatio:void 0,stakeCurrency:"USDT",wins:0,losses:0};return Object.entries(o.allProfit).forEach(([l,n])=>{var f,h,b,V,g,N,R;const y=o.allOpenTrades[l].reduce((u,i)=>u+i.stake_amount,0),t=o.allOpenTrades[l].reduce((u,i)=>u+(i.total_profit_ratio??i.profit_ratio)*i.stake_amount,0)/y,_=o.allOpenTrades[l].reduce((u,i)=>u+(i.total_profit_abs??i.profit_abs??0),0);d.push({botId:l,botName:o.availableBots[l].botName||o.availableBots[l].botId,trades:`${o.allOpenTradeCount[l]} / ${((f=o.allBotState[l])==null?void 0:f.max_open_trades)||"N/A"}`,profitClosed:n.profit_closed_coin,profitClosedRatio:n.profit_closed_ratio||0,stakeCurrency:((h=o.allBotState[l])==null?void 0:h.stake_currency)||"",profitOpenRatio:t,profitOpen:_,wins:n.winning_trades,losses:n.losing_trades,balance:((b=o.allBalance[l])==null?void 0:b.total_bot)??((V=o.allBalance[l])==null?void 0:V.total),stakeCurrencyDecimals:((g=o.allBotState[l])==null?void 0:g.stake_currency_decimals)||3,isDryRun:(N=o.allBotState[l])==null?void 0:N.dry_run}),n.profit_closed_coin!==void 0&&o.botStores[l].isSelected&&(a.profitClosed+=n.profit_closed_coin,a.profitOpen+=_,a.wins+=n.winning_trades,a.losses+=n.losing_trades,a.stakeCurrency=((R=o.allBotState[l])==null?void 0:R.stake_currency)||a.stakeCurrency)}),d.sort(c),d.push(a),d});return(d,a)=>{const l=oe,n=X,y=ae;return m(),B(y,{ref:"tradesTable",small:"",hover:"","show-empty":"","primary-key":"botId",items:e(O),fields:$},{"cell(botName)":s(({item:t,value:_})=>[L("div",de,[t.botId&&e(o).botCount>1?(m(),B(l,{key:0,modelValue:e(o).botStores[t.botId??""].isSelected,"onUpdate:modelValue":f=>e(o).botStores[t.botId??""].isSelected=f,title:"Show this bot in Dashboard"},{default:s(()=>[D(x(_),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])):C("",!0),!t.botId&&e(o).botCount>1?(m(),B(l,{key:1,modelValue:e(T),"onUpdate:modelValue":a[0]||(a[0]=f=>Z(T)?T.value=f:null),title:"Toggle all bots"},{default:s(()=>[D(x(_),1)]),_:2},1032,["modelValue"])):C("",!0),e(o).botCount<=1?(m(),P("span",ce,x(_),1)):C("",!0)])]),"cell(profitOpen)":s(({item:t})=>[t.profitOpen&&t.botId!="Summary"?(m(),B(n,{key:0,"profit-ratio":t.profitOpenRatio,"profit-abs":t.profitOpen,"profit-desc":`Total Profit (Open and realized) ${e(ee)(t.profitOpenRatio??0)}`,"stake-currency":t.stakeCurrency},null,8,["profit-ratio","profit-abs","profit-desc","stake-currency"])):C("",!0)]),"cell(profitClosed)":s(({item:t})=>[t.profitClosed&&t.botId!="Summary"?(m(),B(n,{key:0,"profit-ratio":t.profitClosedRatio,"profit-abs":t.profitClosed,"stake-currency":t.stakeCurrency},null,8,["profit-ratio","profit-abs","stake-currency"])):C("",!0)]),"cell(balance)":s(({item:t})=>[t.balance?(m(),P("div",ue,[L("span",{title:t.stakeCurrency},x(e(te)(t.balance??0,t.stakeCurrencyDecimals)),9,pe),L("span",_e,x(` ${t.stakeCurrency}${t.isDryRun?" (dry)":""}`),1)])):C("",!0)]),"cell(winVsLoss)":s(({item:t})=>[t.losses!==void 0?(m(),P("div",fe,[L("span",me,x(t.wins),1),D(" / "),L("span",ye,x(t.losses),1)])):C("",!0)]),_:1},8,["items"])}}}),be={class:"d-flex justify-content-center"},ge={class:"d-flex justify-content-center"},Le=j({__name:"DashboardView",setup(E){const c=A(),o=se(),T=re(""),$=g=>{T.value=g},O=p(()=>["","sm","md","lg","xl"].includes(T.value)),d=p(()=>o.layoutLocked||!O.value),a=p(()=>O.value?o.dashboardLayout:[...o.getDashboardLayoutSm]),l=g=>{O.value&&(console.log("newlayout",g),console.log("saving dashboard"),o.dashboardLayout=g)},n=p(()=>S(a.value,v.dailyChart)),y=p(()=>S(a.value,v.botComparison)),t=p(()=>S(a.value,v.allOpenTrades)),_=p(()=>S(a.value,v.allClosedTrades)),f=p(()=>S(a.value,v.cumChartChart)),h=p(()=>S(a.value,v.profitDistributionChart)),b=p(()=>S(a.value,v.tradesLogChart)),V=p(()=>({sm:o.getDashboardLayoutSm}));return le(async()=>{c.allGetDaily({timescale:30}),c.activeBot.getOpenTrades(),c.activeBot.getProfit()}),(g,N)=>{const R=ne,u=ie,i=z("grid-item"),G=he,I=Y,U=Q,F=W,M=H,q=K,J=z("grid-layout");return m(),B(J,{class:"h-100 w-100","row-height":50,layout:e(a),"vertical-compact":!1,margin:[5,5],"responsive-layouts":e(V),"is-resizable":!e(d),"is-draggable":!e(d),responsive:!0,"prevent-collision":!0,cols:{lg:12,md:12,sm:12,xs:4,xxs:2},"col-num":12,onLayoutUpdated:l,"onUpdate:breakpoint":$},{default:s(({gridItemProps:w})=>[r(i,k(w,{i:e(n).i,x:e(n).x,y:e(n).y,w:e(n).w,h:e(n).h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:s(()=>[r(u,{header:`Daily Profit ${e(c).botCount>1?"combined":""}`},{default:s(()=>[e(c).allDailyStatsSelectedBots?(m(),B(R,{key:0,"daily-stats":e(c).allDailyStatsSelectedBots,"show-title":!1},null,8,["daily-stats"])):C("",!0)]),_:1},8,["header"])]),_:2},1040,["i","x","y","w","h"]),r(i,k(w,{i:e(y).i,x:e(y).x,y:e(y).y,w:e(y).w,h:e(y).h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:s(()=>[r(u,{header:"Bot comparison"},{default:s(()=>[r(G)]),_:1})]),_:2},1040,["i","x","y","w","h"]),r(i,k(w,{i:e(t).i,x:e(t).x,y:e(t).y,w:e(t).w,h:e(t).h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:s(()=>[r(u,null,{header:s(()=>[L("div",be,[D(" Open Trades "),r(I,{class:"ms-2",hint:"Open trades of all selected bots. Click on a trade to go to the trade page for that trade/bot."})])]),default:s(()=>[r(U,{"active-trades":"",trades:e(c).allOpenTradesSelectedBots,"multi-bot-view":""},null,8,["trades"])]),_:1})]),_:2},1040,["i","x","y","w","h"]),r(i,k(w,{i:e(f).i,x:e(f).x,y:e(f).y,w:e(f).w,h:e(f).h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:s(()=>[r(u,{header:"Cumulative Profit"},{default:s(()=>[r(F,{trades:e(c).allTradesSelectedBots,"open-trades":e(c).allOpenTradesSelectedBots,"show-title":!1},null,8,["trades","open-trades"])]),_:1})]),_:2},1040,["i","x","y","w","h"]),r(i,k(w,{i:e(_).i,x:e(_).x,y:e(_).y,w:e(_).w,h:e(_).h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:s(()=>[r(u,null,{header:s(()=>[L("div",ge,[D(" Closed Trades "),r(I,{class:"ms-2",hint:"Closed trades for all selected bots. Click on a trade to go to the trade page for that trade/bot."})])]),default:s(()=>[r(U,{"active-trades":!1,"show-filter":"",trades:e(c).allClosedTradesSelectedBots,"multi-bot-view":""},null,8,["trades"])]),_:1})]),_:2},1040,["i","x","y","w","h"]),r(i,k(w,{i:e(h).i,x:e(h).x,y:e(h).y,w:e(h).w,h:e(h).h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:s(()=>[r(u,{header:"Profit Distribution"},{default:s(()=>[r(M,{trades:e(c).allTradesSelectedBots,"show-title":!1},null,8,["trades"])]),_:1})]),_:2},1040,["i","x","y","w","h"]),r(i,k(w,{i:e(b).i,x:e(b).x,y:e(b).y,w:e(b).w,h:e(b).h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:s(()=>[r(u,{header:"Trades Log"},{default:s(()=>[r(q,{trades:e(c).allTradesSelectedBots,"show-title":!1},null,8,["trades"])]),_:1})]),_:2},1040,["i","x","y","w","h"])]),_:1},8,["layout","responsive-layouts","is-resizable","is-draggable"])}}});export{Le as default};
//# sourceMappingURL=DashboardView-0xPcU2mL.js.map
